<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video#" >

<head profile="http://www.w3.org/1999/xhtml/vocab">
	  <!--[if IE]><![endif]-->
<meta charset="utf-8" />
<meta name="revision" title="565dabd5-e336-4e7a-a7b6-edc6bb9eb44b" product="7eff92b4-effc-4326-8604-6f852e3e9747" revision="c2973328ba7082bc1ee91cdd08745139619ae7de:en-us" page="8ea4c0c4-b1b5-4af7-9450-676a1baa40b6" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/index" />
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/index" />
<meta property="og:site_name" content="Red Hat Customer Portal" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/index" />
<meta property="og:title" content="Framework for Upgrades (13 to 16.1) Red Hat OpenStack Platform 16.1 | Red Hat Customer Portal" />
<meta property="og:description" content="This guide contains information on the framework for the in-place upgrades across long-life versions. This framework includes tools to upgrade your OpenStack Platform environment from one long life version to the next long life version. In this case, the guide focuses on upgrading from Red Hat OpenStack Platform 13 (Queens) to 16.1 (Train)." />
<meta property="og:image" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:url" content="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/index" />
<meta name="twitter:title" content="Framework for Upgrades (13 to 16.1) Red Hat OpenStack Platform 16.1 | Red Hat Customer Portal" />
<meta name="twitter:description" content="This guide contains information on the framework for the in-place upgrades across long-life versions. This framework includes tools to upgrade your OpenStack Platform environment from one long life version to the next long life version. In this case, the guide focuses on upgrading from Red Hat OpenStack Platform 13 (Queens) to 16.1 (Train)." />
<meta name="twitter:image:src" content="https://access.redhat.com/webassets/avalon/g/shadowman-200.png" />
  <title>Framework for Upgrades (13 to 16.1) Red Hat OpenStack Platform 16.1 | Red Hat Customer Portal</title>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs06.web.prod.ext.phx2.redhat.com" />
<meta name="avalon-version" content="fc526cb5" />
<meta name="cp-chrome-build-date" content="2020-10-15T21:45:53.836Z" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">
<!-- Open Search - Tap to search -->
<link rel="search" type="application/opensearchdescription+xml" title="Red Hat Customer Portal" href="https://access.redhat.com/webassets/avalon/j/opensearch.xml" />

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "fc526cb5",
        builddate : "2020-10-15T21:45:53.836Z",
        fetchdate : "2020-10-19T10:37:35-0400",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="favicon.ico" />

<link media="all" rel="stylesheet" type="text/css" href="bootstrap.css%3Fv=fc526cb5.css" />
<link media="all" rel="stylesheet" type="text/css" href="bootstrap-grid.css%3Fv=fc526cb5.css" />
<link media="all" rel="stylesheet" type="text/css" href="main.css%3Fv=fc526cb5.css" />
<link media="all" rel="stylesheet" type="text/css" href="components.css%3Fv=fc526cb5.css" />
<link media="all" rel="stylesheet" type="text/css" href="pages.css%3Fv=fc526cb5.css" />

<link href="chosen.css%3Fv=fc526cb5.css" rel="stylesheet" type="text/css" />

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="require.js%3Fv=fc526cb5" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->

  <!-- TrustArc -->
  <script src="https://static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>

  <link type="text/css" rel="stylesheet" href="css__c2Nkkx_5vYh8rvZbfBAGB4EMzMtH5ouFJDBlDsnhSR8__-ax0_8bam15ZDJT9j7LilCfJrDyEhGGAgc0KC8HYvJg__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__Jy3BSr8TrxptaufAzQDT1skBUlX2CnL_wm6BizzYuGw__-YZvqB8yuA4kK_iKklbk5HdZCoG2qAgz1l-8Qi2NFH4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="messages.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__m76iIFREtc70Nmw5xe1ZwHbNBlwOP2Zjc3DcacNWnFQ__STEh8aY3w8E_bKzhB4Xke2WOQ9XMDQquHIP5B8SeDIY__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="all" />
<link type="text/css" rel="stylesheet" href="css__4sM4s6XOQ2Nm0pdkrWRLvrgtwpTmHAFzR_LcdesKYj8__vJ0jjVEhoPh3KBeLZfkqg51T3AFxhQCuXg1reipa__k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.css" media="print" />
  <link rel="stylesheet" type="text/css" media="all" href="list.css" />
  <script src="js__ZyeOaiFuDejQQbhUV7yg7atYZnj4WLfH77o0scv4068__MZdWWgUEYpsEWLcU0RqkaXMsEyksbpCgnf4XwXRkqz0__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__5ysXPc5KIyMmizxqRY68ILfrEGrj0P29WBIifnPTJvQ__Cap0DACEVMsefumg1gS1APLLd8stDkdGfp6c1uswMo4__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       '565dabd5-e336-4e7a-a7b6-edc6bb9eb44b');
attributes.set('ResourceTitle',    'Framework for Upgrades (13 to 16.1)');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       'c2973328ba7082bc1ee91cdd08745139619ae7de:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat OpenStack Platform');
attributes.set('ProductVersion',   '16.1');
attributes.set('ProductId',        'Red Hat OpenStack Platform 16.1');
});</script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation/"], ["Red Hat OpenStack Platform", "/documentation/en-us/red_hat_openstack_platform/"], ["16.1", "/documentation/en-us/red_hat_openstack_platform/16.1/"], ["Framework for Upgrades (13 to 16.1)", "/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/"] ];</script>
<script>window.siteMapState = "products";</script>
<script src="js__i6ieGBO-OPmIKm_f0srsb6gM7QELIWrBpKh6ub_yj8A__wjRg_duSK4rEZCRV2uwrCIPMl80Z_LJ9ew61H5hE-ZI__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script src="js__vGeEtorfXGI3aPAp71YA74N5p8wfpYVhnoIqwaJrOiQ__8abcou7ybLtGOLy-V9E-NQlDejOMZmdStjlYfyX9W-k__7oVp6UW_380R7g-dHXPK35SfMqy4yUfhIx8G4wh5Zdk.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"eqUovIJiX7xr-7mgMijJTUfTk6vr3Xvd-VD9Qq5sPSU","js":{"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery-html-prefilter-3.5.0-backport.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/user_prune\/css\/user_prune.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und, #edit-field-accelerator-products-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs06-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

</head>

<body class="portal-page  kcs_external" >
  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <script>
    chrometwo_require(["wc"], function(wc){    
        wc.include("@cpelements/cp-search-autocomplete/dist/cp-search-autocomplete.umd");
    }); 
</script>

<!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="index.html#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-codeready-workspaces/">Red Hat CodeReady Workspaces</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-codeready-studio/">Red Hat CodeReady Studio</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Process Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/product-life-cycles/">Product Life Cycles</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            
            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://catalog.redhat.com/">Ecosystem Catalog</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="accessibility-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop">
          <!-- logo -->
          <span class="sr-only">Red Hat Customer Portal</span>
          <svg aria-hidden="true" class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 200">
            <defs>
            <style>
              .rh-logo-type {
                fill:#fff;
              }
              .rh-logo-hat {
                fill:#e00;
              }
            </style>
            </defs>
            <g id="Two_lines" data-name="Two lines"><g id="Two_line_logo" data-name="Two line logo"><path class="rh-logo-type" d="M318.62,9.25h25.44c11.13,0,18.64,6.72,18.64,16.56,0,7.36-4.47,13-11.51,15.36l12.48,24.08h-9.29l-11.6-23H327v23h-8.4Zm8.4,7.36V35.33h16.33c6.55,0,10.87-3.76,10.87-9.36s-4.32-9.36-10.87-9.36Z"/><path class="rh-logo-type" d="M387.5,66a21,21,0,0,1-21.36-21.12c0-11.76,9-21,20.4-21,11.2,0,19.68,9.28,19.68,21.28v2.32H374.06a13.74,13.74,0,0,0,13.76,11.68,15.84,15.84,0,0,0,10.32-3.6l5.13,5A24.33,24.33,0,0,1,387.5,66ZM374.14,41.49H398.3c-1.19-6.24-6-10.88-11.92-10.88C380.22,30.61,375.34,35,374.14,41.49Z"/><path class="rh-logo-type" d="M445.18,61.41a19.23,19.23,0,0,1-12.48,4.48c-11.52,0-20.56-9.2-20.56-21a20.72,20.72,0,0,1,33-17V9.25l8-1.76V65.25h-7.92Zm-11.36-2.48a14.67,14.67,0,0,0,11.28-4.88V35.57a14.89,14.89,0,0,0-11.28-4.8,13.63,13.63,0,0,0-13.84,14A13.77,13.77,0,0,0,433.82,58.93Z"/><path class="rh-logo-type" d="M480.22,9.25h8.4v24h29.76v-24h8.4v56h-8.4V40.85H488.62v24.4h-8.4Z"/><path class="rh-logo-type" d="M534.38,53.57c0-7.68,6.24-12.4,16.48-12.4A28.75,28.75,0,0,1,562,43.41V39.09c0-5.76-3.44-8.64-9.92-8.64-3.76,0-7.6,1-12.64,3.44l-3-6c6.08-2.88,11.36-4.16,16.72-4.16,10.56,0,16.64,5.2,16.64,14.56v27H562V61.73A19.32,19.32,0,0,1,549.34,66C540.46,66,534.38,60.93,534.38,53.57Zm16.8,6.48A15.66,15.66,0,0,0,562,56.21v-7a21.15,21.15,0,0,0-10.48-2.48c-5.84,0-9.44,2.64-9.44,6.72C542.06,57.33,545.74,60.05,551.18,60.05Z"/><path class="rh-logo-type" d="M582.7,31.25h-8.64V24.53h8.64V14.13l7.92-1.92V24.53h12v6.72h-12V53.33c0,4.16,1.68,5.68,6,5.68a15.72,15.72,0,0,0,5.84-1v6.72a26.5,26.5,0,0,1-7.6,1.2c-7.92,0-12.16-3.76-12.16-10.8Z"/><path class="rh-logo-type" d="M361,132.21l7.59,7.52a30.76,30.76,0,0,1-23,10.32c-16.88,0-29.84-12.56-29.84-28.8s13-28.88,29.84-28.88c9,0,18.09,4.08,23.28,10.48l-7.83,7.76a19.52,19.52,0,0,0-15.45-7.6c-10.16,0-17.92,7.84-17.92,18.24A17.8,17.8,0,0,0,346,139.33,19.24,19.24,0,0,0,361,132.21Z"/><path class="rh-logo-type" d="M383.74,131.81c0,5.36,3.44,8.8,8.64,8.8a10.05,10.05,0,0,0,8.65-4.16V107.57h11v41.68H401v-3.36a17.79,17.79,0,0,1-11.77,4.16c-9.68,0-16.48-6.88-16.48-16.64V107.57h11Z"/><path class="rh-logo-type" d="M422.46,137c4.88,3.2,9.12,4.72,13.52,4.72,4.88,0,8.08-1.76,8.08-4.4,0-2.16-1.6-3.36-5.2-3.92l-8-1.2c-8.24-1.28-12.64-5.36-12.64-12.08,0-8.08,6.72-13.2,17.36-13.2a30.75,30.75,0,0,1,17.12,5.2l-5.28,7c-4.56-2.72-8.64-4-12.88-4-4,0-6.56,1.6-6.56,4.08,0,2.24,1.6,3.36,5.68,3.92l8,1.2c8.16,1.2,12.72,5.44,12.72,11.92,0,7.84-7.76,13.76-18.24,13.76-7.6,0-14.4-2-19.12-5.76Z"/><path class="rh-logo-type" d="M464.7,116.77h-8.56v-9.2h8.56V96.93l11-2.48v13.12H487.5v9.2H475.66v18.48c0,3.92,1.52,5.36,5.76,5.36a16.86,16.86,0,0,0,5.84-1v9a34,34,0,0,1-8.48,1.28c-9.28,0-14.08-4.24-14.08-12.4Z"/><path class="rh-logo-type" d="M512.86,106.77c12.48,0,22.24,9.52,22.24,21.68s-9.76,21.6-22.24,21.6-22.24-9.44-22.24-21.6S500.38,106.77,512.86,106.77Zm11.52,21.68c0-6.88-5-12.16-11.52-12.16s-11.52,5.28-11.52,12.16c0,6.72,5,12.08,11.52,12.08S524.38,135.17,524.38,128.45Z"/><path class="rh-logo-type" d="M541.82,107.57h11v3.12a16.21,16.21,0,0,1,10.88-3.92A15,15,0,0,1,576.22,113,17.16,17.16,0,0,1,590,106.77c9.36,0,15.91,6.8,15.91,16.56v25.92h-11V124.93c0-5.28-3-8.72-7.83-8.72a9.37,9.37,0,0,0-8,4.16,18.89,18.89,0,0,1,.23,3v25.92h-11V124.93c0-5.28-3-8.72-7.84-8.72a9.3,9.3,0,0,0-7.76,3.76v29.28h-11Z"/><path class="rh-logo-type" d="M634.78,150.05c-12.64,0-22.4-9.44-22.4-21.6a21.28,21.28,0,0,1,21.44-21.6c11.84,0,20.64,9.6,20.64,22.4v2.88h-31a12,12,0,0,0,11.84,8.72,13.12,13.12,0,0,0,9.2-3.36l7.2,6.56A25,25,0,0,1,634.78,150.05Zm-11.44-25.76h20.4c-1.36-5-5.36-8.4-10.16-8.4C628.54,115.89,624.7,119.17,623.34,124.29Z"/><path class="rh-logo-type" d="M661.18,107.57h11v4.56a13.26,13.26,0,0,1,11.12-5.52,9.44,9.44,0,0,1,4.56,1v9.6a14,14,0,0,0-5.6-1.12,11,11,0,0,0-10.08,6.24v27h-11Z"/><path class="rh-logo-type" d="M710.54,93.25h28.08c11,0,18.8,7.28,18.8,17.6,0,10-7.92,17.28-18.8,17.28H722.14v21.12h-11.6Zm11.6,10v15.28h15.2c5,0,8.32-3,8.32-7.6s-3.28-7.68-8.32-7.68Z"/><path class="rh-logo-type" d="M782.14,106.77c12.48,0,22.24,9.52,22.24,21.68s-9.76,21.6-22.24,21.6-22.24-9.44-22.24-21.6S769.66,106.77,782.14,106.77Zm11.52,21.68c0-6.88-5-12.16-11.52-12.16s-11.52,5.28-11.52,12.16c0,6.72,5,12.08,11.52,12.08S793.66,135.17,793.66,128.45Z"/><path class="rh-logo-type" d="M811.1,107.57h11v4.56a13.26,13.26,0,0,1,11.12-5.52,9.44,9.44,0,0,1,4.56,1v9.6a14,14,0,0,0-5.6-1.12,11,11,0,0,0-10.08,6.24v27h-11Z"/><path class="rh-logo-type" d="M850,116.77h-8.56v-9.2H850V96.93l11-2.48v13.12h11.84v9.2H860.94v18.48c0,3.92,1.52,5.36,5.76,5.36a16.86,16.86,0,0,0,5.84-1v9a34,34,0,0,1-8.48,1.28c-9.28,0-14.08-4.24-14.08-12.4Z"/><path class="rh-logo-type" d="M876.22,137.17c0-7.92,6.4-12.64,17.12-12.64a33.71,33.71,0,0,1,10.16,1.6v-3c0-4.8-3-7.28-8.8-7.28-3.52,0-7.44,1.12-12.72,3.44l-4-8.08a43.46,43.46,0,0,1,18.56-4.48c11.28,0,17.76,5.6,17.76,15.44v27H903.5v-2.88a19.81,19.81,0,0,1-12.08,3.6C882.46,150,876.22,144.77,876.22,137.17Zm18.08,5a15.78,15.78,0,0,0,9.2-2.64v-6.24a24.22,24.22,0,0,0-8.8-1.52c-5,0-8,2-8,5.2S889.66,142.13,894.3,142.13Z"/><path class="rh-logo-type" d="M933.58,149.25h-11v-56l11-2.4Z"/><g id="Hat_icon" data-name="Hat icon"><path id="Red_hat" data-name="Red hat" class="rh-logo-hat" d="M129,92.24c12.5,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42L151.82,39c-1.72-7.12-3.23-10.35-15.74-16.6-9.7-5-30.82-13.15-37.07-13.15-5.83,0-7.55,7.54-14.45,7.54-6.68,0-11.64-5.6-17.89-5.6-6,0-9.92,4.1-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,44,52.79C44,62,80.32,92.24,129,92.24Zm32.55-11.42c1.72,8.19,1.72,9.05,1.72,10.13,0,14-15.73,21.77-36.43,21.77-46.77,0-87.73-27.37-87.73-45.48a18.32,18.32,0,0,1,1.51-7.33C23.77,60.77,2,63.79,2,83c0,31.48,74.59,70.28,133.65,70.28,45.27,0,56.7-20.48,56.7-36.65C192.35,103.88,181.35,89.44,161.52,80.82Z"/><path class="rh-logo-band" id="Black_band" data-name="Black band" d="M161.52,80.82c1.72,8.19,1.72,9.05,1.72,10.13,0,14-15.73,21.77-36.43,21.77-46.77,0-87.73-27.37-87.73-45.48a18.32,18.32,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,44,52.79C44,62,80.32,92.24,129,92.24c12.5,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/></g><path id="Dividing_line" data-name="Dividing line" class="rh-logo-type" d="M255.47,160.75a2.25,2.25,0,0,1-2.25-2.25V4.25a2.25,2.25,0,0,1,4.5,0V158.5A2.25,2.25,0,0,1,255.47,160.75Z"/></g></g>
          </svg>
        </span>
            </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="index.html#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-codeready-workspaces/">Red Hat CodeReady Workspaces</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Runtimes</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true">
                      <a href="index.html#" class="back">Back</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-codeready-studio/">Red Hat CodeReady Studio</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href="index.html#" class="has-subnav"><span>Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                    </li>
                    <li>
                      <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Process Automation</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                    </li>
                    <li>
                        <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                    </li>
                </ul>
            </li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/product-life-cycles/">Product Life Cycles</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>

            
            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://catalog.redhat.com/">Ecosystem Catalog</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
            <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
          </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&">Red Hat Insights</a></li>
            <li class="heading">Tools</li>
            <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
            <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
            <li><a href="https://access.redhat.com/errata/">Errata</a></li>
            <li class="heading">Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://access.redhat.com/login" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="index.html#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="index.html#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en" id="mobile-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" id="mobile-zh_CN">中文 (中国)</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://catalog.redhat.com/software/containers/explore/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li id="searchABTestHide">
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <!-- AB Test -->
                    <li id="searchABTestShow">
                        <form id="topSearchFormABTest" name="topSearchFormABTest">
                            <label for="topSearchInputABTest" class="sr-only">Search</label>
                            <input id="topSearchInputABTest" name="keyword" placeholder="Search" value="" type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="form-control">
                            <button type="submit" class="btn btn-app btn-sm btn-link"><span class="web-icon-search" aria-label="search"></span></button>
                        </form>
                    </li>
                    <!-- End of AB Test -->
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="https://access.redhat.com/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <cp-search-autocomplete class="push-bottom" path="/webassets/avalon/j/data.json"></cp-search-autocomplete>
                            <div class="input-group push-bottom">
                                <input class="form-control searchField" id="topSearchInput" name="keyword" value="" placeholder="Enter your search term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Or <a href="https://access.redhat.com/support/cases/#/troubleshoot">troubleshoot an issue</a>.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                                <li><a href="https://access.redhat.com/account-team">Account Team</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en" data-lang="en" id="en">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-2">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja"    data-lang="ja"    id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                      <span class="sr-only">Red Hat Customer Portal</span>
                      <span class="logo-crop">
                        <svg aria-hidden="true" class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 200">
                          <defs>
                          <style>
                            .rh-logo-type {
                              fill:#fff;
                            }
                            .rh-logo-hat {
                              fill:#e00;
                            }
                          </style>
                          </defs>
                          <title>Red Hat Customer Portal</title><g id="Two_lines" data-name="Two lines"><g id="Two_line_logo" data-name="Two line logo"><path class="rh-logo-type" d="M318.62,9.25h25.44c11.13,0,18.64,6.72,18.64,16.56,0,7.36-4.47,13-11.51,15.36l12.48,24.08h-9.29l-11.6-23H327v23h-8.4Zm8.4,7.36V35.33h16.33c6.55,0,10.87-3.76,10.87-9.36s-4.32-9.36-10.87-9.36Z"/><path class="rh-logo-type" d="M387.5,66a21,21,0,0,1-21.36-21.12c0-11.76,9-21,20.4-21,11.2,0,19.68,9.28,19.68,21.28v2.32H374.06a13.74,13.74,0,0,0,13.76,11.68,15.84,15.84,0,0,0,10.32-3.6l5.13,5A24.33,24.33,0,0,1,387.5,66ZM374.14,41.49H398.3c-1.19-6.24-6-10.88-11.92-10.88C380.22,30.61,375.34,35,374.14,41.49Z"/><path class="rh-logo-type" d="M445.18,61.41a19.23,19.23,0,0,1-12.48,4.48c-11.52,0-20.56-9.2-20.56-21a20.72,20.72,0,0,1,33-17V9.25l8-1.76V65.25h-7.92Zm-11.36-2.48a14.67,14.67,0,0,0,11.28-4.88V35.57a14.89,14.89,0,0,0-11.28-4.8,13.63,13.63,0,0,0-13.84,14A13.77,13.77,0,0,0,433.82,58.93Z"/><path class="rh-logo-type" d="M480.22,9.25h8.4v24h29.76v-24h8.4v56h-8.4V40.85H488.62v24.4h-8.4Z"/><path class="rh-logo-type" d="M534.38,53.57c0-7.68,6.24-12.4,16.48-12.4A28.75,28.75,0,0,1,562,43.41V39.09c0-5.76-3.44-8.64-9.92-8.64-3.76,0-7.6,1-12.64,3.44l-3-6c6.08-2.88,11.36-4.16,16.72-4.16,10.56,0,16.64,5.2,16.64,14.56v27H562V61.73A19.32,19.32,0,0,1,549.34,66C540.46,66,534.38,60.93,534.38,53.57Zm16.8,6.48A15.66,15.66,0,0,0,562,56.21v-7a21.15,21.15,0,0,0-10.48-2.48c-5.84,0-9.44,2.64-9.44,6.72C542.06,57.33,545.74,60.05,551.18,60.05Z"/><path class="rh-logo-type" d="M582.7,31.25h-8.64V24.53h8.64V14.13l7.92-1.92V24.53h12v6.72h-12V53.33c0,4.16,1.68,5.68,6,5.68a15.72,15.72,0,0,0,5.84-1v6.72a26.5,26.5,0,0,1-7.6,1.2c-7.92,0-12.16-3.76-12.16-10.8Z"/><path class="rh-logo-type" d="M361,132.21l7.59,7.52a30.76,30.76,0,0,1-23,10.32c-16.88,0-29.84-12.56-29.84-28.8s13-28.88,29.84-28.88c9,0,18.09,4.08,23.28,10.48l-7.83,7.76a19.52,19.52,0,0,0-15.45-7.6c-10.16,0-17.92,7.84-17.92,18.24A17.8,17.8,0,0,0,346,139.33,19.24,19.24,0,0,0,361,132.21Z"/><path class="rh-logo-type" d="M383.74,131.81c0,5.36,3.44,8.8,8.64,8.8a10.05,10.05,0,0,0,8.65-4.16V107.57h11v41.68H401v-3.36a17.79,17.79,0,0,1-11.77,4.16c-9.68,0-16.48-6.88-16.48-16.64V107.57h11Z"/><path class="rh-logo-type" d="M422.46,137c4.88,3.2,9.12,4.72,13.52,4.72,4.88,0,8.08-1.76,8.08-4.4,0-2.16-1.6-3.36-5.2-3.92l-8-1.2c-8.24-1.28-12.64-5.36-12.64-12.08,0-8.08,6.72-13.2,17.36-13.2a30.75,30.75,0,0,1,17.12,5.2l-5.28,7c-4.56-2.72-8.64-4-12.88-4-4,0-6.56,1.6-6.56,4.08,0,2.24,1.6,3.36,5.68,3.92l8,1.2c8.16,1.2,12.72,5.44,12.72,11.92,0,7.84-7.76,13.76-18.24,13.76-7.6,0-14.4-2-19.12-5.76Z"/><path class="rh-logo-type" d="M464.7,116.77h-8.56v-9.2h8.56V96.93l11-2.48v13.12H487.5v9.2H475.66v18.48c0,3.92,1.52,5.36,5.76,5.36a16.86,16.86,0,0,0,5.84-1v9a34,34,0,0,1-8.48,1.28c-9.28,0-14.08-4.24-14.08-12.4Z"/><path class="rh-logo-type" d="M512.86,106.77c12.48,0,22.24,9.52,22.24,21.68s-9.76,21.6-22.24,21.6-22.24-9.44-22.24-21.6S500.38,106.77,512.86,106.77Zm11.52,21.68c0-6.88-5-12.16-11.52-12.16s-11.52,5.28-11.52,12.16c0,6.72,5,12.08,11.52,12.08S524.38,135.17,524.38,128.45Z"/><path class="rh-logo-type" d="M541.82,107.57h11v3.12a16.21,16.21,0,0,1,10.88-3.92A15,15,0,0,1,576.22,113,17.16,17.16,0,0,1,590,106.77c9.36,0,15.91,6.8,15.91,16.56v25.92h-11V124.93c0-5.28-3-8.72-7.83-8.72a9.37,9.37,0,0,0-8,4.16,18.89,18.89,0,0,1,.23,3v25.92h-11V124.93c0-5.28-3-8.72-7.84-8.72a9.3,9.3,0,0,0-7.76,3.76v29.28h-11Z"/><path class="rh-logo-type" d="M634.78,150.05c-12.64,0-22.4-9.44-22.4-21.6a21.28,21.28,0,0,1,21.44-21.6c11.84,0,20.64,9.6,20.64,22.4v2.88h-31a12,12,0,0,0,11.84,8.72,13.12,13.12,0,0,0,9.2-3.36l7.2,6.56A25,25,0,0,1,634.78,150.05Zm-11.44-25.76h20.4c-1.36-5-5.36-8.4-10.16-8.4C628.54,115.89,624.7,119.17,623.34,124.29Z"/><path class="rh-logo-type" d="M661.18,107.57h11v4.56a13.26,13.26,0,0,1,11.12-5.52,9.44,9.44,0,0,1,4.56,1v9.6a14,14,0,0,0-5.6-1.12,11,11,0,0,0-10.08,6.24v27h-11Z"/><path class="rh-logo-type" d="M710.54,93.25h28.08c11,0,18.8,7.28,18.8,17.6,0,10-7.92,17.28-18.8,17.28H722.14v21.12h-11.6Zm11.6,10v15.28h15.2c5,0,8.32-3,8.32-7.6s-3.28-7.68-8.32-7.68Z"/><path class="rh-logo-type" d="M782.14,106.77c12.48,0,22.24,9.52,22.24,21.68s-9.76,21.6-22.24,21.6-22.24-9.44-22.24-21.6S769.66,106.77,782.14,106.77Zm11.52,21.68c0-6.88-5-12.16-11.52-12.16s-11.52,5.28-11.52,12.16c0,6.72,5,12.08,11.52,12.08S793.66,135.17,793.66,128.45Z"/><path class="rh-logo-type" d="M811.1,107.57h11v4.56a13.26,13.26,0,0,1,11.12-5.52,9.44,9.44,0,0,1,4.56,1v9.6a14,14,0,0,0-5.6-1.12,11,11,0,0,0-10.08,6.24v27h-11Z"/><path class="rh-logo-type" d="M850,116.77h-8.56v-9.2H850V96.93l11-2.48v13.12h11.84v9.2H860.94v18.48c0,3.92,1.52,5.36,5.76,5.36a16.86,16.86,0,0,0,5.84-1v9a34,34,0,0,1-8.48,1.28c-9.28,0-14.08-4.24-14.08-12.4Z"/><path class="rh-logo-type" d="M876.22,137.17c0-7.92,6.4-12.64,17.12-12.64a33.71,33.71,0,0,1,10.16,1.6v-3c0-4.8-3-7.28-8.8-7.28-3.52,0-7.44,1.12-12.72,3.44l-4-8.08a43.46,43.46,0,0,1,18.56-4.48c11.28,0,17.76,5.6,17.76,15.44v27H903.5v-2.88a19.81,19.81,0,0,1-12.08,3.6C882.46,150,876.22,144.77,876.22,137.17Zm18.08,5a15.78,15.78,0,0,0,9.2-2.64v-6.24a24.22,24.22,0,0,0-8.8-1.52c-5,0-8,2-8,5.2S889.66,142.13,894.3,142.13Z"/><path class="rh-logo-type" d="M933.58,149.25h-11v-56l11-2.4Z"/><g id="Hat_icon" data-name="Hat icon"><path id="Red_hat" data-name="Red hat" class="rh-logo-hat" d="M129,92.24c12.5,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42L151.82,39c-1.72-7.12-3.23-10.35-15.74-16.6-9.7-5-30.82-13.15-37.07-13.15-5.83,0-7.55,7.54-14.45,7.54-6.68,0-11.64-5.6-17.89-5.6-6,0-9.92,4.1-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,44,52.79C44,62,80.32,92.24,129,92.24Zm32.55-11.42c1.72,8.19,1.72,9.05,1.72,10.13,0,14-15.73,21.77-36.43,21.77-46.77,0-87.73-27.37-87.73-45.48a18.32,18.32,0,0,1,1.51-7.33C23.77,60.77,2,63.79,2,83c0,31.48,74.59,70.28,133.65,70.28,45.27,0,56.7-20.48,56.7-36.65C192.35,103.88,181.35,89.44,161.52,80.82Z"/><path class="rh-logo-band" id="Black_band" data-name="Black band" d="M161.52,80.82c1.72,8.19,1.72,9.05,1.72,10.13,0,14-15.73,21.77-36.43,21.77-46.77,0-87.73-27.37-87.73-45.48a18.32,18.32,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,44,52.79C44,62,80.32,92.24,129,92.24c12.5,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/></g><path id="Dividing_line" data-name="Dividing line" class="rh-logo-type" d="M255.47,160.75a2.25,2.25,0,0,1-2.25-2.25V4.25a2.25,2.25,0,0,1,4.5,0V158.5A2.25,2.25,0,0,1,255.47,160.75Z"/></g></g>
                        </svg>
                      </span>
                                            </a>

                    <nav class="primary-nav hidden-sm">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>Runtimes</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>Integration and Automation</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/">Red Hat Advanced Cluster Management for Kubernetes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-quay/">Red Hat Quay</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-codeready-workspaces/">Red Hat CodeReady Workspaces</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-openshift-container-storage">Red Hat Openshift Container Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-runtimes/">Red Hat Runtimes</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-data-grid/">Red Hat Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-single-sign-on/">Red Hat Single Sign On</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/spring-boot/">Red Hat support for Spring Boot</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/nodejs/">Red Hat build of Node.js</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/thorntail/">Red Hat build of Thorntail</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/eclipse-vertx/">Red Hat build of Eclipse Vert.x</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openjdk/">Red Hat build of OpenJDK</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/open-liberty/">Open Liberty</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/quarkus/">Red Hat build of Quarkus</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-codeready-studio/">Red Hat CodeReady Studio</a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu">
                                    <ul class="border-bottom" id="portal-menu-border-bottom">
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-integration/">Red Hat Integration</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-fuse/">Red Hat Fuse</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-amq/">Red Hat AMQ</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                      </li>
                                    </ul>
                                    <ul>
                                      <li>
                                        <a href="https://access.redhat.com/products/red-hat-process-automation/">Red Hat Process Automation</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-process-automation-manager/">Red Hat Process Automation Manager</a>
                                      </li>
                                      <li>
                                          <a href="https://access.redhat.com/products/red-hat-decision-manager/">Red Hat Decision Manager</a>
                                      </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/product-life-cycles/">Product Life Cycles</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://www.redhat.com/en/services/consulting">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://www.redhat.com/en/services/training-and-certification">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        
                                        <li><a href="https://catalog.redhat.com/" class="cta-link cta-link-darkbg">Ecosystem Catalog</a></li>
                                        <li><a href="https://access.redhat.com/public-cloud">Red Hat in the Public Cloud</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/solution-engine">Solution Engine</a></li>
                                        <li><a href="https://access.redhat.com/downloads/content/package-browser">Packages</a></li>
                                        <li><a href="https://access.redhat.com/errata/">Errata</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <ul class="list-flat">
                                        <li><a href="https://access.redhat.com/labs/" class="cta-link cta-link-darkbg">Customer Portal Labs</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                        <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h4 class="card-heading">Red Hat Insights</h4>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat rh-l-grid rh-m-gutters rh-m-all-6-col-on-md">
                                          <li><a href="https://www.redhat.com/en/technologies/management/insights" class="cta-link cta-link-md cta-link-darkbg">Learn more</a></li>
                                          <li><a href="https://cloud.redhat.com/insights" class="cta-link cta-link-md cta-link-darkbg">Go to Insights</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with our Red Hat Product Security team, access security updates, and ensure your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat&#039;s specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://www.redhat.com/en/blog/channel/security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&name=&product=All&category=All&tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="site-section"></div>
        </header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="index.html">English</a></li>
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/">日本語</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/framework_for_upgrades_13_to_16.1/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/pdf/framework_for_upgrades_13_to_16.1/Red_Hat_OpenStack_Platform-16.1-Framework_for_Upgrades_13_to_16.1-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/epub/framework_for_upgrades_13_to_16.1/Red_Hat_OpenStack_Platform-16.1-Framework_for_Upgrades_13_to_16.1-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
    <ol class="menu"><li class=" leaf"><a href="index.html">Framework for Upgrades (13 to 16.1)</a></li><li class=" leaf"><a href="index.html#about-the-red-hat-openstack-platform-framework-for-upgrades">1. About the Red Hat OpenStack Platform framework for upgrades</a><ol class="menu"><li class=" leaf"><a href="index.html#upgrade-framework-for-long-life-versions">1.1. Upgrade framework for long life versions</a></li><li class=" leaf"><a href="index.html#lifecycle-support-for-long-life-versions">1.2. Lifecycle support for long life versions</a></li><li class=" leaf"><a href="index.html#upgrade-paths-for-long-life-releases">1.3. Upgrade paths for long life release</a></li></ol></li><li class=" leaf"><a href="index.html#planning-and-preparation-for-an-in-place-openstack-platform-upgrade">2. Planning and preparation for an in-place upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#familiarize-yourself-with-red-hat-openstack-platform-16.1">2.1. Familiarize yourself with Red Hat OpenStack Platform 16.1</a></li><li class=" leaf"><a href="index.html#high-level-changes-in-red-hat-openstack-platform-vernum">2.2. High level changes in Red Hat OpenStack Platform 16.1</a></li><li class=" leaf"><a href="index.html#changes-in-red-hat-enterprise-linux-8">2.3. Changes in Red Hat Enterprise Linux 8</a></li><li class=" leaf"><a href="index.html#leapp-upgrade-usage-in-red-hat-openstack-platform">2.4. Leapp upgrade usage in Red Hat OpenStack Platform</a></li><li class=" leaf"><a href="index.html#supported-upgrade-scenarios-planning">2.5. Supported upgrade scenarios</a></li><li class=" leaf"><a href="index.html#known-issues-that-might-block-an-upgrade">2.6. Known issues that might block an upgrade</a></li><li class=" leaf"><a href="index.html#backup-and-restore">2.7. Backup and restore</a></li><li class=" leaf"><a href="index.html#minor-version-update">2.8. Minor version update</a></li><li class=" leaf"><a href="index.html#proxy-configuration-planning">2.9. Proxy configuration</a></li><li class=" leaf"><a href="index.html#validating-red-hat-openstack-platform-oldvernum-before-the-upgrade">2.10. Validating Red Hat OpenStack Platform 13 before the upgrade</a></li></ol></li><li class=" leaf"><a href="index.html#repositories">3. Repositories</a><ol class="menu"><li class=" leaf"><a href="index.html#undercloud-repositories">3.1. Undercloud repositories</a></li><li class=" leaf"><a href="index.html#overcloud-repositories">3.2. Overcloud repositories</a></li><li class=" leaf"><a href="index.html#red-hat-satellite-6-considerations-repositories">3.3. Red Hat Satellite 6 considerations</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading_the_undercloud">I. Upgrading the undercloud</a><ol class="menu"><li class=" leaf"><a href="index.html#preparing-for-the-undercloud-upgrade">4. Preparing for the undercloud upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#new-memory-requirements">4.1. New memory requirements</a></li><li class=" leaf"><a href="index.html#using-predictable-nic-names-preparing-undercloud">4.2. Using predictable NIC names for the undercloud node</a></li><li class=" leaf"><a href="index.html#setting-the-ssh-root-permission-parameter-on-the-undercloud-preparing-undercloud">4.3. Setting the SSH root permission parameter on the undercloud</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading-the-undercloud-operating-system">5. Upgrading the undercloud operating system</a><ol class="menu"><li class=" leaf"><a href="index.html#removing-red-hat-openstack-platform-director-packages">5.1. Removing Red Hat OpenStack Platform director packages</a></li><li class=" leaf"><a href="index.html#performing-a-leapp-upgrade-on-the-undercloud">5.2. Performing a Leapp upgrade on the undercloud</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading-director">6. Upgrading director</a><ol class="menu"><li class=" leaf"><a href="index.html#locking-the-environment-to-a-red-hat-enterprise-linux-release">6.1. Locking the environment to a Red Hat Enterprise Linux release</a></li><li class=" leaf"><a href="index.html#enabling-repositories-for-the-undercloud">6.2. Enabling repositories for the undercloud</a></li><li class=" leaf"><a href="index.html#installing_director_packages">6.3. Installing director packages</a></li><li class=" leaf"><a href="index.html#preparing-container-images">6.4. Preparing container images</a></li><li class=" leaf"><a href="index.html#container-image-preparation-parameters">6.5. Container image preparation parameters</a></li><li class=" leaf"><a href="index.html#obtaining-container-images-from-private-registries">6.6. Obtaining container images from private registries</a></li><li class=" leaf"><a href="index.html#obtaining-transitional-containers-for-upgrades-undercloud">6.7. Obtaining transitional containers for upgrades</a></li><li class=" leaf"><a href="index.html#updating-the-undercloud-conf-file-undercloud">6.8. Updating the undercloud.conf file</a></li><li class=" leaf"><a href="index.html#director-configuration-parameters">6.9. Director configuration parameters</a></li><li class=" leaf"><a href="index.html#running-the-director-upgrade">6.10. Running the director upgrade</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#preparing_for_overcloud_upgrade">II. Preparing for overcloud upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#initial-steps-for-overcloud-preparation">7. Initial steps for overcloud preparation</a><ol class="menu"><li class=" leaf"><a href="index.html#preparing_for_overcloud_service_downtime">7.1. Preparing for overcloud service downtime</a></li><li class=" leaf"><a href="index.html#selecting_compute_nodes_for_upgrade_testing">7.2. Selecting Compute nodes for upgrade testing</a></li><li class=" leaf"><a href="index.html#validating-the-pre-upgrade-requirements">7.3. Validating the pre-upgrade requirements</a></li><li class=" leaf"><a href="index.html#disabling-fencing-in-the-overcloud-initial-steps">7.4. Disabling fencing in the overcloud</a></li><li class=" leaf"><a href="index.html#creating-an-overcloud-inventory-file-initial-steps">7.5. Creating an overcloud inventory file</a></li></ol></li><li class=" leaf"><a href="index.html#configuring-the-overcloud-for-a-leapp-upgrade">8. Configuring the overcloud for a Leapp upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#creating-an-upgrades-environment-file-overcloud-leapp">8.1. Creating an upgrades environment file</a></li><li class=" leaf"><a href="index.html#upgrade-parameters">8.2. Upgrade parameters</a></li><li class=" leaf"><a href="index.html#copying-the-leapp-data-to-the-overcloud-nodes">8.3. Copying the Leapp data to the overcloud nodes</a></li><li class=" leaf"><a href="index.html#using-predictable-nic-names-overcloud-leapp">8.4. Using predictable NIC names for overcloud nodes</a></li><li class=" leaf"><a href="index.html#setting-the-ssh-root-permission-parameter-on-the-overcloud-overcloud-leapp">8.5. Setting the SSH root permission parameter on the overcloud</a></li></ol></li><li class=" leaf"><a href="index.html#updating-composable-services-and-parameters">9. Updating composable services and parameters</a><ol class="menu"><li class=" leaf"><a href="index.html#updating-composable-services-in-custom-roles_data-files-composable-services">9.1. Updating composable services in custom roles_data files</a></li><li class=" leaf"><a href="index.html#updating-composable-services-in-custom-environment-files-composable-services">9.2. Updating composable services in custom environment files</a></li><li class=" leaf"><a href="index.html#configuring-access-to-the-undercloud-registry-composable-services">9.3. Configuring access to the undercloud registry</a></li><li class=" leaf"><a href="index.html#deprecated-and-removed-filters-for-the-novaschedulerdefaultfilters-parameter-composable-services">9.4. Deprecated and removed filters for the NovaSchedulerDefaultFilters parameter</a></li><li class=" leaf"><a href="index.html#setting-the-compute-name-format-composable-services">9.5. Setting the Compute name format</a></li><li class=" leaf"><a href="index.html#updating-your-tls-ssl-configuration">9.6. Updating your SSL/TLS configuration</a></li><li class=" leaf"><a href="index.html#updating-post-configuration-templates-composable-services">9.7. Updating post configuration templates</a></li></ol></li><li class=" leaf"><a href="index.html#updating-overcloud-registration-to-the-red-hat-customer-portal-composable-services">10. Updating overcloud registration to the Red Hat Customer Portal</a><ol class="menu"><li class=" leaf"><a href="index.html#rhsm-composable-service-portal">10.1. Red Hat Subscription Manager (RHSM) composable service</a></li><li class=" leaf"><a href="index.html#rhsmvars-parameters-portal">10.2. RhsmVars sub-parameters</a></li><li class=" leaf"><a href="index.html#switching-to-the-rhsm-composable-service-portal">10.3. Switching to the rhsm composable service</a></li><li class=" leaf"><a href="index.html#rhel-registration-to-rhsm-mappings-portal">10.4. rhel-registration to rhsm mappings</a></li><li class=" leaf"><a href="index.html#registering-the-overcloud-with-the-rhsm-composable-service-portal">10.5. Registering the overcloud with the rhsm composable service</a></li><li class=" leaf"><a href="index.html#applying-the-rhsm-composable-service-to-different-roles-portal">10.6. Applying the rhsm composable service to different roles</a></li></ol></li><li class=" leaf"><a href="index.html#updating-overcloud-registration-to-red-hat-satellite-portal">11. Updating overcloud registration to Red Hat Satellite</a><ol class="menu"><li class=" leaf"><a href="index.html#rhsm-composable-service-satellite">11.1. Red Hat Subscription Manager (RHSM) composable service</a></li><li class=" leaf"><a href="index.html#rhsmvars-parameters-satellite">11.2. RhsmVars sub-parameters</a></li><li class=" leaf"><a href="index.html#switching-to-the-rhsm-composable-service-satellite">11.3. Switching to the rhsm composable service</a></li><li class=" leaf"><a href="index.html#rhel-registration-to-rhsm-mappings-satellite">11.4. rhel-registration to rhsm mappings</a></li><li class=" leaf"><a href="index.html#registering-the-overcloud-to-red-hat-satellite-satellite">11.5. Registering the overcloud to Red Hat Satellite</a></li><li class=" leaf"><a href="index.html#proc_preparing-leapp-to-use-satellite-server-satellite">11.6. Preparing Leapp to use Satellite server</a></li></ol></li><li class=" leaf"><a href="index.html#preparing-for-a-ceph-storage-upgrade">12. Preparing for a Ceph Storage upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#understanding-the-ceph-storage-node-upgrade-process-at-a-high-level-preparing-overcloud">12.1. Understanding the Ceph Storage node upgrade process at a high level</a></li><li class=" leaf"><a href="index.html#checking-your-ceph-ansible-version">12.2. Checking your ceph-ansible version</a></li><li class=" leaf"><a href="index.html#setting-the-ceph-ansible-repository-preparing-overcloud">12.3. Setting the ceph-ansible repository</a></li><li class=" leaf"><a href="index.html#proc_checking-ceph-cluster-status-before-an-upgrade-preparing-overcloud">12.4. Checking Ceph cluster status before an upgrade</a></li></ol></li><li class=" leaf"><a href="index.html#updating-network-configuration">13. Updating network configuration</a><ol class="menu"><li class=" leaf"><a href="index.html#updating-network-interface-templates">13.1. Updating network interface templates</a></li><li class=" leaf"><a href="index.html#maintaining-openvswitch-compatibility-during-the-upgrade">13.2. Maintaining Open vSwitch compatibility during the upgrade</a></li><li class=" leaf"><a href="index.html#maintaining-composable-network-compatibility-during-the-upgrade-preparing-overcloud">13.3. Maintaining composable network compatibility during the upgrade</a></li></ol></li><li class=" leaf"><a href="index.html#preparing-network-functions-virtualization-nfv">14. Preparing network functions virtualization (NFV)</a><ol class="menu"><li class=" leaf"><a href="index.html#network_functions_virtualization_nfv_environment_files">14.1. Network functions virtualization (NFV) environment files</a></li></ol></li><li class=" leaf"><a href="index.html#final-review-before-upgrade">15. Final review before upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#new-environment-files-to-include-with-your-deployment">15.1. New environment files to include with your deployment</a></li><li class=" leaf"><a href="index.html#environment-files-to-remove-from-your-deployment">15.2. Environment files to remove from your deployment</a></li><li class=" leaf"><a href="index.html#upgrade-checklist">15.3. Upgrade checklist</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#upgrading_the_overcloud">III. Upgrading the overcloud</a><ol class="menu"><li class=" leaf"><a href="index.html#upgrade-command-overview">16. Upgrade command overview</a><ol class="menu"><li class=" leaf"><a href="index.html#openstack-overcloud-upgrade-prepare">16.1. openstack overcloud upgrade prepare</a></li><li class=" leaf"><a href="index.html#openstack-overcloud-upgrade-run">16.2. openstack overcloud upgrade run</a></li><li class=" leaf"><a href="index.html#openstack-overcloud-external-upgrade-run">16.3. openstack overcloud external-upgrade run</a></li><li class=" leaf"><a href="index.html#openstack-overcloud-upgrade-converge">16.4. openstack overcloud upgrade converge</a></li><li class=" leaf"><a href="index.html#overcloud-node-upgrade-workflow-upgrading-overcloud">16.5. Overcloud node upgrade workflow</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading-a-standard-overcloud">17. Upgrading a standard overcloud</a><ol class="menu"><li class=" leaf"><a href="index.html#running-the-overcloud-upgrade-preparation-upgrading-overcloud-standard">17.1. Running the overcloud upgrade preparation</a></li><li class=" leaf"><a href="index.html#upgrading-controller-nodes-upgrading-overcloud-standard">17.2. Upgrading Controller nodes</a></li><li class=" leaf"><a href="index.html#upgrading-the-operating-system-for-ceph-storage-nodes-upgrading-overcloud-standard">17.3. Upgrading the operating system for Ceph Storage nodes</a></li><li class=" leaf"><a href="index.html#upgrading-compute-nodes-upgrading-overcloud-standard">17.4. Upgrading Compute nodes</a></li><li class=" leaf"><a href="index.html#performing_the_upgrade-upgrading-overcloud-standard">17.5. Synchronizing the overcloud stack</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading-a-split-controller-overcloud">18. Upgrading a split Controller overcloud</a><ol class="menu"><li class=" leaf"><a href="index.html#running-the-overcloud-upgrade-preparation-upgrading-overcloud-split">18.1. Running the overcloud upgrade preparation</a></li><li class=" leaf"><a href="index.html#upgrading-pacemaker-based-nodes-upgrading-overcloud-split">18.2. Upgrading Pacemaker-based nodes</a></li><li class=" leaf"><a href="index.html#upgrading-standalone-service-nodes-upgrading-overcloud-split">18.3. Upgrading non-Pacemaker Controller nodes</a></li><li class=" leaf"><a href="index.html#upgrading-the-operating-system-for-ceph-mon-nodes-upgrading-overcloud-split">18.4. Upgrading the operating system for Ceph MON nodes</a></li><li class=" leaf"><a href="index.html#upgrading-the-operating-system-for-ceph-storage-nodes-upgrading-overcloud-split">18.5. Upgrading the operating system for Ceph Storage nodes</a></li><li class=" leaf"><a href="index.html#upgrading-compute-nodes-upgrading-overcloud-split">18.6. Upgrading Compute nodes</a></li><li class=" leaf"><a href="index.html#performing_the_upgrade-upgrading-overcloud-split">18.7. Synchronizing the overcloud stack</a></li></ol></li><li class=" leaf"><a href="index.html#upgrading-an-overcloud-with-hyper-converged-infrastructure">19. Upgrading an overcloud with hyper-converged infrastructure</a><ol class="menu"><li class=" leaf"><a href="index.html#running-the-overcloud-upgrade-preparation-upgrading-overcloud-hci">19.1. Running the overcloud upgrade preparation</a></li><li class=" leaf"><a href="index.html#upgrading-controller-nodes-upgrading-overcloud-hci">19.2. Upgrading Controller nodes</a></li><li class=" leaf"><a href="index.html#upgrading-compute-nodes-with-hyper-converged-infrastructure-upgrading-overcloud-hci">19.3. Upgrading Compute nodes with hyper-converged infrastructure (HCI)</a></li><li class=" leaf"><a href="index.html#performing_the_upgrade-upgrading-overcloud-hci">19.4. Synchronizing the overcloud stack</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#concluding_the_overcloud_upgrade">IV. Concluding the overcloud upgrade</a><ol class="menu"><li class=" leaf"><a href="index.html#upgrading-to-red-hat-ceph-storage-4">20. Upgrading to Red Hat Ceph Storage 4</a><ol class="menu"><li class=" leaf"><a href="index.html#installing-ceph-ansible">20.1. Installing ceph-ansible</a></li><li class=" leaf"><a href="index.html#upgrading-to-ceph-storage-4-ceph-4">20.2. Upgrading to Ceph Storage 4</a></li></ol></li><li class=" leaf"><a href="index.html#performing-post-upgrade-actions">21. Performing post-upgrade actions</a><ol class="menu"><li class=" leaf"><a href="index.html#removing-unnecessary-packages-from-the-undercloud-ceph-4">21.1. Removing unnecessary packages from the undercloud</a></li><li class=" leaf"><a href="index.html#validating-the-post-upgrade-functionality">21.2. Validating the post-upgrade functionality</a></li><li class=" leaf"><a href="index.html#upgrading_the_overcloud_images">21.3. Upgrading the overcloud images</a></li><li class=" leaf"><a href="index.html#migrating-to-open-virtual-network-ovn">21.4. Migrating to Open Virtual Network (OVN)</a></li></ol></li></ol></li><li class=" leaf"><a href="index.html#troubleshooting">V. Troubleshooting</a><ol class="menu"><li class=" leaf"><a href="index.html#troubleshooting-upgrade-issues">22. Troubleshooting upgrade issues</a><ol class="menu"><li class=" leaf"><a href="index.html#correcting-environment-files-ceph-4">22.1. Correcting environment files</a></li></ol></li></ol></li></ol>  </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-page-title"  >
  
      
  
  <h1 class="title" itemprop="name">Framework for Upgrades (13 to 16.1)</h1>
  
  </div>
<div class="panel-pane pane-page-body"  >
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm139983843004528"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat OpenStack Platform</span> <span class="productnumber">16.1</span></div><div><h2 class="subtitle">In-place upgrades from Red Hat OpenStack Platform 13 to 16.1</h2></div><div><div xml:lang="en-US" class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">OpenStack</span> <span class="othername">Documentation</span> <span class="surname">Team</span></h3><code class="email"><a class="email" href="mailto:rhos-docs@redhat.com">rhos-docs@redhat.com</a></code></div></div></div><div><div class="abstract" id="Abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				This guide contains information on the framework for the in-place upgrades across long-life versions. This framework includes tools to upgrade your OpenStack Platform environment from one long life version to the next long life version. In this case, the guide focuses on upgrading from Red Hat OpenStack Platform 13 (Queens) to 16.1 (Train).
			</div></div></div></div><hr/></div><section class="chapter" id="about-the-red-hat-openstack-platform-framework-for-upgrades"><div class="titlepage"><div><div><h1 class="title">Chapter 1. About the Red Hat OpenStack Platform framework for upgrades</h1></div></div></div><p>
			The Red Hat OpenStack Platform framework for upgrades is a workflow to upgrade your Red Hat OpenStack Platform environment from one long life version to the next long life version. This workflow is an in-place solution and the upgrade occurs within your existing environment.
		</p><section class="section" id="upgrade-framework-for-long-life-versions"><div class="titlepage"><div><div><h2 class="title">1.1. Upgrade framework for long life versions</h2></div></div></div><p>
				You can use the Red Hat OpenStack Platform <span class="strong strong"><strong>upgrade framework</strong></span> to perform an in-place upgrade path through multiple versions of the overcloud. The goal is to provide you with an opportunity to remain on certain OpenStack versions that are considered <span class="strong strong"><strong>long life versions</strong></span> and upgrade when the next long life version is available.
			</p><p>
				This guide provides an upgrade framework through the following versions:
			</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983857874752" scope="col">Current Version</th><th align="left" valign="top" id="idm139983842853008" scope="col">Target Version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983857874752"> <p>
								Red Hat OpenStack Platform 13
							</p>
							 </td><td align="left" valign="top" headers="idm139983842853008"> <p>
								Red Hat OpenStack Platform 16.1
							</p>
							 </td></tr></tbody></table></div></section><section class="section" id="lifecycle-support-for-long-life-versions"><div class="titlepage"><div><div><h2 class="title">1.2. Lifecycle support for long life versions</h2></div></div></div><p>
				For detailed support dates and information on the lifecycle support for Red Hat OpenStack Platform, see <a class="link" href="https://access.redhat.com/support/policy/updates/openstack/platform">"Red Hat OpenStack Platform Life Cycle"</a>.
			</p></section><section class="section" id="upgrade-paths-for-long-life-releases"><div class="titlepage"><div><div><h2 class="title">1.3. Upgrade paths for long life release</h2></div></div></div><p>
				Red Hat provides two options for upgrading your environment to the next long life release:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">In-place upgrade</span></dt><dd>
							Perform an upgrade of the services in your existing environment. This guide primarily focuses on this option.
						</dd><dt><span class="term">Parallel migration</span></dt><dd>
							Create a new Red Hat OpenStack Platform 16.1 environment and migrate your workloads from your current environment to the new environment. For more information about Red Hat OpenStack Platform parallel migration, contact Red Hat Global Professional Services.
						</dd></dl></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					The durations in this table are minimal estimates based on internal testing and might not apply to all productions environments. For example, if your hardware has low specifications or an extended boot period, allow for more time with these durations. To accurately gauge the upgrade duration for each task, perform these procedures in a test environment with hardware similar to your production environment.
				</p></div></div><div class="table" id="idm139983838671280"><p class="title"><strong>Table 1.1. Impact and duration of upgrade paths</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983843890864" scope="col"> </th><th align="left" valign="top" id="idm139983843889936" scope="col">In-place upgrade</th><th align="left" valign="top" id="idm139983843888848" scope="col">Parallel migration</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Upgrade duration for undercloud</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								Estimated duration for each major action includes the following:
							</p>
							 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										30 minutes for Leapp upgrade command
									</li><li class="listitem">
										30 minutes for Leapp reboot
									</li><li class="listitem">
										40 minutes for director upgrade
									</li></ul></div>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								None. You are creating a new undercloud in addition to your existing undercloud.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Upgrade duration for overcloud control plane</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								Estimates for each Controller node:
							</p>
							 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										60 minutes for Leapp upgrade and reboot
									</li><li class="listitem">
										60 minutes for service upgrade
									</li></ul></div>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								None. You are creating a new control plane in addition to your existing control plane.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Outage duration for control plane</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								The duration of the service upgrade of the bootstrap Controller node, which is approximately 60 minutes.
							</p>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								None. Both overclouds are operational during the workload migration.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Consequences of control plane outage</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								You cannot perform OpenStack operations during the outage.
							</p>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								No outage.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Upgrade duration for overcloud data plane</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								Estimates for each Compute node and Ceph Storage node:
							</p>
							 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										60 minutes for Leapp upgrade and reboot
									</li><li class="listitem">
										30 minutes for service upgrade
									</li></ul></div>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								None. You are creating a new data plane in addition to your existing data plane.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Outage duration for data plane</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								The outage is minimal due to workload migration from node to node.
							</p>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								The outage is minimal due to workload migration from overcloud to overcloud.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983843890864"> <p>
								<span class="strong strong"><strong>Additional hardware requirements</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843889936"> <p>
								No additional hardware is required.
							</p>
							 </td><td align="left" valign="top" headers="idm139983843888848"> <p>
								Additional hardware is required to create a new undercloud and overcloud.
							</p>
							 </td></tr></tbody></table></div></div></section></section><section class="chapter" id="planning-and-preparation-for-an-in-place-openstack-platform-upgrade"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Planning and preparation for an in-place upgrade</h1></div></div></div><p>
			Before you conduct an in-place upgrade of your OpenStack Platform environment, create a plan for the upgrade and accommodate any potential obstacles that might block a successful upgrade.
		</p><section class="section" id="familiarize-yourself-with-red-hat-openstack-platform-16.1"><div class="titlepage"><div><div><h2 class="title">2.1. Familiarize yourself with Red Hat OpenStack Platform 16.1</h2></div></div></div><p>
				Before you perform an upgrade, familiarize yourself with Red Hat OpenStack Platform 16.1 to help you understand the resulting environment and any potential version-to-version changes what might affect your upgrade. To familiarize yourself with Red Hat OpenStack Platform 16.1, follow these suggestions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Read the release notes for all versions across the upgrade path and identify any potential aspects that require planning:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Components that contain new features
							</li><li class="listitem">
								Known issues
							</li></ul></div><p class="simpara">
						Open the release notes for each version using these links:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/release_notes/index">Red Hat OpenStack Platform 13</a>, which is your current version
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/14/html/release_notes/index">Red Hat OpenStack Platform 14</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/15/html/release_notes/index">Red Hat OpenStack Platform 15</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.0/html/release_notes/index">Red Hat OpenStack Platform 16.0</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/release_notes/index">Red Hat OpenStack Platform 16.1</a>, which is your target version
							</li></ul></div></li><li class="listitem">
						Read the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/director_installation_and_usage/index">Director Installation and Usage</a> guide for version 16.1 and familiarize yourself with any new requirements and processes in this guide.
					</li><li class="listitem">
						Install a proof-of-concept Red Hat OpenStack Platform 16.1 undercloud and overcloud. Develop hands-on experience of the target OpenStack Platform version and investigate potential differences between the target version and your current version.
					</li></ul></div></section><section class="section" id="high-level-changes-in-red-hat-openstack-platform-vernum"><div class="titlepage"><div><div><h2 class="title">2.2. High level changes in Red Hat OpenStack Platform 16.1</h2></div></div></div><p>
				The following high-level changes occur during the upgrade to Red Hat OpenStack Platform 16.1:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						OpenStack Platform director 16.1 configures the overcloud using an Ansible-driven method called <code class="literal">config-download</code>. This replaces the standard heat-based configuration method. Director still uses heat to orchestrate provisioning operations.
					</li><li class="listitem">
						The director installation uses the same method as the overcloud deployment. Therefore, the undercloud also uses <code class="literal">openstack-tripleo-heat-templates</code> as a blueprint for installing and configuring each service.
					</li><li class="listitem">
						The undercloud runs OpenStack services in containers.
					</li><li class="listitem">
						The undercloud pulls and stores container images through a new method. Instead of pulling container images before deploying the overcloud, the undercloud pulls all relevant container images during the deployment process.
					</li><li class="listitem">
						The overcloud deployment process includes an Advanced Subscription Management method to register nodes. This method incorporates an Ansible role to register OpenStack Platform nodes. The new method also applies different subscriptions to different node roles if necessary.
					</li><li class="listitem">
						The overcloud now uses Open Virtual Network (OVN) as the default ML2 mechanism driver. It is possible to migrate your Open vSwitch (OVS) service to OVN, which you perform after the completion of a successful upgrade.
					</li><li class="listitem">
						The undercloud and overcloud both run on Red Hat Enterprise Linux 8.
					</li><li class="listitem">
						<code class="literal">openstack-tripleo-heat-templates</code> includes a unified composable service template collection in the <code class="literal">deployment</code> directory. This directory now includes templates with merged content from both the containerized service and Puppet-based composable service templates.
					</li><li class="listitem"><p class="simpara">
						The OpenStack Data Processing service (sahara) is no longer supported.
					</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
							If you have sahara enabled in your Red Hat OpenStack Platform 13 environment, do not continue with this upgrade and contact Red Hat Global Support Services.
						</p></div></div></li><li class="listitem">
						The OpenStack Telemetry components are deprecated in favor of the Service Telemetry Framework (STF).
					</li></ul></div></section><section class="section" id="changes-in-red-hat-enterprise-linux-8"><div class="titlepage"><div><div><h2 class="title">2.3. Changes in Red Hat Enterprise Linux 8</h2></div></div></div><p>
				The undercloud and overcloud both run on Red Hat Enterprise Linux 8. This includes new tools and functions relevant to the undercloud and overcloud:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The undercloud and overcloud use the Red Hat Container Toolkit. Instead of <code class="literal">docker</code> to build and control the container lifecycle, Red Hat Enterprise Linux 8 includes <code class="literal">buildah</code> to build new container images and <code class="literal">podman</code> for container management.
					</li><li class="listitem">
						Red Hat Enterprise Linux 8 does not include the <code class="literal">docker-distribution</code> package. The undercloud now includes a private HTTP registry to provide container images to overcloud nodes.
					</li><li class="listitem">
						The upgrade process from Red Hat Enterprise Linux 7 to 8 uses the <code class="literal">leapp</code> tool.
					</li><li class="listitem">
						Red Hat Enterprise Linux 8 does not use the <code class="literal">ntp</code> service. Instead, Red Hat Enterprise Linux 8 uses <code class="literal">chronyd</code>.
					</li><li class="listitem">
						Red Hat Enterprise Linux 8 includes new versions of high availability tools.
					</li></ul></div><p>
				The Red Hat OpenStack Platform 16.1 uses Red Hat Enterprise Linux 8.2 as the base operating system. As a part of the upgrade process, you will upgrade the base operating system of nodes to Red Hat Enterprise Linux 8.2.
			</p><p>
				For more information about the key differences between Red Hat Enterprise Linux 7 and 8, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/considerations_in_adopting_rhel_8/index">"Considerations in adopting RHEL 8"</a>. For general information about Red Hat Enterprise linux 8, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/">Product Documentation for Red Hat Enterprise Linux 8</a>.
			</p></section><section class="section" id="leapp-upgrade-usage-in-red-hat-openstack-platform"><div class="titlepage"><div><div><h2 class="title">2.4. Leapp upgrade usage in Red Hat OpenStack Platform</h2></div></div></div><p>
				The long-life Red Hat OpenStack Platform upgrade also requires an upgrade from Red Hat Enterprise Linux 7 to Red Hat Enterprise Linux 8. Red Hat Enterprise Linux 7 includes a tool named <code class="literal">leapp</code>, which performs the upgrade to Red Hat Enterprise Linux 8. Both the undercloud and overcloud use a separate process for performing the operating system upgrade.
			</p><div class="formalpara"><p class="title"><strong>Undercloud process</strong></p><p>
					Run the <code class="literal">leapp</code> upgrade manually before you run the <code class="literal">openstack undercloud upgrade</code> command. The undercloud upgrade includes instructions for performing the <code class="literal">leapp</code> upgrade.
				</p></div><div class="formalpara"><p class="title"><strong>Overcloud process</strong></p><p>
					The overcloud upgrade framework automatically runs the <code class="literal">leapp</code> upgrade.
				</p></div><div class="formalpara"><p class="title"><strong>Limitations</strong></p><p>
					For information of potential limitations that might affect your upgrade, see the following sections from the <span class="emphasis"><em>Upgrading from RHEL 7 to RHEL 8</em></span> guide:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/upgrading_from_rhel_7_to_rhel_8/planning-an-upgrade_upgrading-from-rhel-7-to-rhel-8">"Planning an upgrade"</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/upgrading_from_rhel_7_to_rhel_8/troubleshooting_upgrading-from-rhel-7-to-rhel-8#known-issues-upgrading-from-rhel-7-to-rhel-8">"Known issues"</a>
					</li></ul></div><p>
				In particular, you cannot perform a Leapp upgrade on nodes that use encryption of the whole disk or a partition, such as LUKS encryption, or file-system encryption. This limitation affects Ceph OSD nodes that you have configured with the <code class="literal">dmcrypt: true</code> parameter.
			</p><p>
				If any known limitations affect your environment, seek advice from the <a class="link" href="https://access.redhat.com/support/cases/">Red Hat Technical Support Team</a>.
			</p></section><section class="section" id="supported-upgrade-scenarios-planning"><div class="titlepage"><div><div><h2 class="title">2.5. Supported upgrade scenarios</h2></div></div></div><p>
				Before proceeding with the upgrade, check that your overcloud is supported.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you are uncertain whether a particular scenario not mentioned in these lists is supported, seek advice from the <a class="link" href="https://access.redhat.com/support/cases/">Red Hat Technical Support Team</a>.
				</p></div></div><div class="formalpara"><p class="title"><strong>Supported scenarios</strong></p><p>
					The following in-place upgrade scenarios are tested and supported.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Standard environments with default role types: Controller, Compute, and Ceph Storage OSD
					</li><li class="listitem">
						Split-Controller composable roles
					</li><li class="listitem">
						Ceph Storage composable roles
					</li><li class="listitem">
						Hyper-Converged Infrastructure: Compute and Ceph Storage OSD services on the same node
					</li><li class="listitem">
						Environments with Network Functions Virtualization (NFV) technologies: Single-root input/output virtualization (SR-IOV) and Data Plane Development Kit (DPDK)
					</li></ul></div><div class="formalpara"><p class="title"><strong>Technology preview scenarios</strong></p><p>
					The framework for upgrades is considered a Technology Preview when you use it in conjunction with these features, and therefore is not fully supported by Red Hat. You should only test this scenario in a proof-of-concept environment and not upgrade in a production environment. For more information about Technology Preview features, see <a class="link" href="https://access.redhat.com/support/offerings/production/scope_moredetail">Scope of Coverage Details</a>.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Edge and Distributed Compute Node (DCN) scenarios
					</li></ul></div><div class="formalpara"><p class="title"><strong>Untested and unsupported</strong></p><p>
					The following in-place upgrade scenarios are either untested or unsupported. If your overcloud configuration matches any of the scenarios on this list, postpone your upgrade and seek advice from the <a class="link" href="https://access.redhat.com/support/cases/">Red Hat Technical Support Team</a>.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Environments with Instance HA enabled
					</li></ul></div></section><section class="section" id="known-issues-that-might-block-an-upgrade"><div class="titlepage"><div><div><h2 class="title">2.6. Known issues that might block an upgrade</h2></div></div></div><p>
				Review the following known issues that might affect a successful upgrade.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1852360">BZ#1852360 - swift_rsync and swift_rsync_healthcheck moved in failed state after undercloud upgrade</a></span></dt><dd>
							The containerized <code class="literal">tripleo_swift_rsync</code> service on the Red Hat OpenStack Platform 16.1 undercloud reports a failed state. This is due to a conflict with the Red Hat OpenStack Platform 16.1 version running the OpenStack Object Storage (swift) <code class="literal">rsync</code> daemon through <code class="literal">xinetd</code>. This guide includes <code class="literal">xinetd</code> in the list of packages that you must remove before to the undercloud upgrade. Red Hat aims to resolve this issue in the next 16.1 minor release update.
						</dd><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1866479">BZ#1866479 - container-tools module stream not enabled correctly</a></span></dt><dd>
							The Red Hat Enterprise Linux 8 AppStream repository uses <code class="literal">container-tools:rhel8</code> as a default <code class="literal">dnf</code> module. The overcloud and undercloud require a change to the <code class="literal">container-tools:2.0</code> module to use the correct version of Podman for Red Hat OpenStack Platform 16.1 support. You change this module manually on the undercloud but director must change this module on the overcloud automatically during the upgrade process. This guide includes a workaround that uses the <code class="literal">UpgradeInitCommand</code> parameter to perform this module change on the overcloud.
						</dd><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1871834">BZ#1871834 - ovn controllers cannot connect ovn dbs during 13-16.1 FFU upgrade</a></span></dt><dd><p class="simpara">
							Due to an VIP address change for Open Virtual Network (OVN), OVN controllers can no longer connect to the OVN database during an upgrade. To work around this issue:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									After upgrading Controller nodes, obtain the new OVN VIP:
								</p><pre class="screen">[root@controller-0 ~]# ovs-vsctl get open . external_ids:ovn-remote | sed -e 's/\"//g'</pre><p class="simpara">
									This produces output in the following format.
								</p><pre class="screen">tcp:&lt;NewOvnVIP&gt;:6642</pre></li><li class="listitem"><p class="simpara">
									Before you start the Compute upgrade process, log in to each Compute node and set the OVN VIP:
								</p><pre class="screen">[root@compute-0 ~]# sudo docker exec -uroot ovn_controller ovs-vsctl set Open_Vswitch . external_ids:ovn-remote="tcp:&lt;NewOvnVIP&gt;:6642"</pre></li></ol></div><p class="simpara">
							Red Hat aims to resolve this issue in the next 16.1 minor release update.
						</p></dd></dl></div><div class="variablelist"><p class="title"><strong>Red Hat Ceph Storage Issues</strong></p><dl class="variablelist"><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1855813">BZ#1855813 - Ceph tools repository should be switched from RHCS3 to RHCS4 only after converge, before running external-upgrade</a></span></dt><dd>
							The <code class="literal">ceph-ansible</code> playbook collection on the undercloud deploys Red Hat Ceph Storage containers on the overcloud. To upgrade your environment, you must have Red Hat Ceph Storage 3 version of <code class="literal">ceph-ansible</code> to maintain Ceph Storage 3 containers through the upgrade. This guide includes instructions on how to retain <code class="literal">ceph-ansible</code> version 3 over the course of the upgrade until you are ready to upgrade to Ceph Storage 4. Before performing the 13 to 16.1 upgrade, you must perform a minor version update of your Red Hat OpenStack Platform 13 environment and ensure you have <code class="literal">ceph-ansible</code> version 3.2.46 or later.
						</dd><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1870617">BZ#1870617 - noout ceph flag not unset during the FFU workflow</a></span></dt><dd>
							This guide includes commands to set <code class="literal">noout</code> and <code class="literal">norebalance</code> flags before the Ceph Storage OSD cluster upgrade and unset them after you complete the Ceph Storage OSD cluster upgrade. Red Hat aims to automate this procedure in the next 16.1 minor release update.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Red Hat Enterprise Linux Issues</strong></p><dl class="variablelist"><dt><span class="term"><a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1861977">BZ#1861977 - RHSA-2020:3216 grub2 security update renders system unbootable</a></span></dt><dd>
							Applying the RHSA-2020:3216 security update stops the grub menu from loading. This issue occurs when using the <code class="literal">shim-x64-15-14.el8_2</code> package. The <code class="literal">shim-x64-15-15.el8_2</code> package and later versions of this package corrects this issue. If the grub menu does not appear when rebooting nodes, see the <a class="link" href="https://access.redhat.com/solutions/5272311">"System hangs after POST and the grub menu never loads after applying the RHSA-2020:3216 or RHSA-2020:3217"</a> solution.
						</dd></dl></div></section><section class="section" id="backup-and-restore"><div class="titlepage"><div><div><h2 class="title">2.7. Backup and restore</h2></div></div></div><p>
				Before you upgrade your Red Hat OpenStack Platform 13 environment, back up the undercloud and overcloud control plane. For more information about backing up nodes with the Relax-and-recover (ReaR) utility, see the <span class="emphasis"><em>Undercloud and Control Plane Back Up and Restore</em></span> guide.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Back up your nodes before you perform an upgrade. For more information on backing up nodes prior to upgrade, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/undercloud_and_control_plane_back_up_and_restore/index">"Red Hat OpenStack Platform 13 Undercloud and Control Plane Back Up and Restore"</a>.
					</li><li class="listitem">
						You can back up each up node after it has been upgraded. For more information on backing up upgraded nodes, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/undercloud_and_control_plane_back_up_and_restore/index">"Red Hat OpenStack Platform 16.1 Undercloud and Control Plane Back Up and Restore"</a>.
					</li></ul></div></section><section class="section" id="minor-version-update"><div class="titlepage"><div><div><h2 class="title">2.8. Minor version update</h2></div></div></div><p>
				Before you upgrade your Red Hat OpenStack Platform environment, update the environment to the latest minor version of your current release. For example, perform an update of your Red Hat OpenStack Platform 13 environment to the latest 13 before running the upgrade to Red Hat OpenStack Platform 16.1
			</p><p>
				For instructions on performing a minor version update for Red Hat OpenStack Platform 13, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/keeping_red_hat_openstack_platform_updated/index">"Keeping Red Hat OpenStack Platform Updated"</a>.
			</p></section><section class="section" id="proxy-configuration-planning"><div class="titlepage"><div><div><h2 class="title">2.9. Proxy configuration</h2></div></div></div><p>
				If you use a proxy with your Red Hat OpenStack Platform 13 environment, the proxy configuration in the <code class="literal">/etc/environment</code> file will persist past the operating system upgrade and the Red Hat OpenStack Platform 16.1 upgrade.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information about proxy configuration for Red Hat OpenStack Platform 13, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/director_installation_and_usage/installing-the-undercloud#configuring-an-undercloud-proxy">Configuring an undercloud proxy</a>.
					</li><li class="listitem">
						For more information about proxy configuration for Red Hat OpenStack Platform 16.1, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/director_installation_and_usage/preparing-for-director-installation#configuring-an-undercloud-proxy">Configuring an undercloud proxy</a>.
					</li></ul></div></section><section class="section" id="validating-red-hat-openstack-platform-oldvernum-before-the-upgrade"><div class="titlepage"><div><div><h2 class="title">2.10. Validating Red Hat OpenStack Platform 13 before the upgrade</h2></div></div></div><p>
				Before you upgrade to Red Hat OpenStack Platform 16.1, validate your undercloud and overcloud with the <code class="literal">tripleo-validations</code> playbooks. In Red Hat OpenStack Platform 13, you run these playbooks through the OpenStack Workflow Service (mistral).
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the undercloud as the <code class="literal">stack</code> user.
					</li><li class="listitem"><p class="simpara">
						Source the <code class="literal">stackrc</code> file:
					</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
						Create a bash script called <code class="literal">pre-upgrade-validations.sh</code> and include the following content in the script:
					</p><pre class="screen">#!/bin/bash
for VALIDATION in $(openstack action execution run tripleo.validations.list_validations '{"groups": ["pre-upgrade"]}' | jq ".result[] | .id")
do
  echo "=== Running validation: $VALIDATION ==="
  STACK_NAME=$(openstack stack list -f value -c 'Stack Name')
  ID=$(openstack workflow execution create -f value -c ID tripleo.validations.v1.run_validation "{\"validation_name\": $VALIDATION, \"plan\": \"$STACK_NAME\"}")
  while [ $(openstack workflow execution show $ID -f value -c State) == "RUNNING" ]
  do
    sleep 1
  done
  echo ""
  openstack workflow execution output show $ID | jq -r ".stdout"
  echo ""
done</pre></li><li class="listitem"><p class="simpara">
						Add permission to run the script:
					</p><pre class="screen">$ chmod +x pre-upgrade-validations.sh</pre></li><li class="listitem"><p class="simpara">
						Run the script:
					</p><pre class="screen">$ ./pre-upgrade-validations.sh</pre><p class="simpara">
						Review the script output to determine which validations succeed and fail:
					</p><pre class="screen">=== Running validation: "check-ftype" ===

Success! The validation passed for all hosts:
* undercloud</pre></li></ol></div></section></section><section class="chapter" id="repositories"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Repositories</h1></div></div></div><p>
			This section contains the repositories for the undercloud and overcloud. Refer to this section when you need to enable repositories is certain situations:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Enabling repositories when registering to the Red Hat Customer Portal.
				</li><li class="listitem">
					Enabling and synchronizing repositories to your Red Hat Satellite server.
				</li><li class="listitem">
					Enabling repositories when registering to your Red hat Satellite server.
				</li></ul></div><section class="section" id="undercloud-repositories"><div class="titlepage"><div><div><h2 class="title">3.1. Undercloud repositories</h2></div></div></div><p>
				Red Hat OpenStack Platform 16.1 runs on Red Hat Enterprise Linux 8.2. As a result, you must lock the content from these repositories to the respective Red Hat Enterprise Linux version.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you synchronize repositories with Red Hat Satellite, you can enable specific versions of the Red Hat Enterprise Linux repositories. However, the repository remains the same despite the version you choose. For example, you can enable the 8.2 version of the BaseOS repository, but the repository name is still <code class="literal">rhel-8-for-x86_64-baseos-eus-rpms</code> despite the specific version you choose.
				</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Any repositories outside the ones specified here are not supported. Unless recommended, do not enable any other products or repositories outside the ones listed in the following tables or else you might encounter package dependency issues. Do not enable Extra Packages for Enterprise Linux (EPEL).
				</p></div></div><div class="formalpara"><p class="title"><strong>Core repositories</strong></p><p>
					The following table lists core repositories for installing the undercloud.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983837782160" scope="col">Name</th><th align="left" valign="top" id="idm139983837781072" scope="col">Repository</th><th align="left" valign="top" id="idm139983837779984" scope="col">Description of requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - BaseOS (RPMs) Extended Update Support (EUS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">rhel-8-for-x86_64-baseos-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Base operating system repository for x86_64 systems.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">rhel-8-for-x86_64-appstream-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Contains Red Hat OpenStack Platform dependencies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - High Availability (RPMs) Extended Update Support (EUS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">rhel-8-for-x86_64-highavailability-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								High availability tools for Red Hat Enterprise Linux. Used for Controller node high availability.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Ansible Engine 2.9 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">ansible-2.9-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Ansible Engine for Red Hat Enterprise Linux. Used to provide the latest version of Ansible.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Advanced Virtualization for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">advanced-virt-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Provides virtualization packages for OpenStack Platform.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Satellite Tools for RHEL 8 Server RPMs x86_64
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">satellite-tools-6.5-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Tools for managing hosts with Red Hat Satellite 6.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat OpenStack Platform 16.1 for RHEL 8 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">openstack-16.1-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Core Red Hat OpenStack Platform repository, which contains packages for Red Hat OpenStack Platform director.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837782160"> <p>
								Red Hat Fast Datapath for RHEL 8 (RPMS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837781072"> <p>
								<code class="literal">fast-datapath-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837779984"> <p>
								Provides Open vSwitch (OVS) packages for OpenStack Platform.
							</p>
							 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Ceph repositories</strong></p><p>
					The following table lists Ceph Storage related repositories for the undercloud.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983838414352" scope="col">Name</th><th align="left" valign="top" id="idm139983838413264" scope="col">Repository</th><th align="left" valign="top" id="idm139983838412176" scope="col">Description of Requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983838414352"> <p>
								Red Hat Ceph Storage Tools 4 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838413264"> <p>
								<code class="literal">rhceph-4-tools-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838412176"> <p>
								Provides tools for nodes to communicate with the Ceph Storage cluster. The undercloud requires the <code class="literal">ceph-ansible</code> package from this repository if you plan to use Ceph Storage in your overcloud.
							</p>
							 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>IBM POWER repositories</strong></p><p>
					The following table contains a list of repositories for Red Hat Openstack Platform on POWER PC architecture. Use these repositories in place of equivalents in the Core repositories.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983839831120" scope="col">Name</th><th align="left" valign="top" id="idm139983843617824" scope="col">Repository</th><th align="left" valign="top" id="idm139983843616736" scope="col">Description of requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983839831120"> <p>
								Red Hat Enterprise Linux for IBM Power, little endian - BaseOS (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983843617824"> <p>
								<code class="literal">rhel-8-for-ppc64le-baseos-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843616736"> <p>
								Base operating system repository for ppc64le systems.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983839831120"> <p>
								Red Hat Enterprise Linux 8 for IBM Power, little endian - AppStream (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983843617824"> <p>
								<code class="literal">rhel-8-for-ppc64le-appstream-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843616736"> <p>
								Contains Red Hat OpenStack Platform dependencies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983839831120"> <p>
								Red Hat Enterprise Linux 8 for IBM Power, little endian - High Availability (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983843617824"> <p>
								<code class="literal">rhel-8-for-ppc64le-highavailability-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843616736"> <p>
								High availability tools for Red Hat Enterprise Linux. Used for Controller node high availability.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983839831120"> <p>
								Red Hat Ansible Engine 2.8 for RHEL 8 IBM Power, little endian (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983843617824"> <p>
								<code class="literal">ansible-2.8-for-rhel-8-ppc64le-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843616736"> <p>
								Ansible Engine for Red Hat Enterprise Linux. Provides the latest version of Ansible.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983839831120"> <p>
								Red Hat OpenStack Platform 16.1 for RHEL 8 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983843617824"> <p>
								<code class="literal">openstack-16.1-for-rhel-8-ppc64le-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983843616736"> <p>
								Core Red Hat OpenStack Platform repository for ppc64le systems.
							</p>
							 </td></tr></tbody></table></div></section><section class="section" id="overcloud-repositories"><div class="titlepage"><div><div><h2 class="title">3.2. Overcloud repositories</h2></div></div></div><p>
				Red Hat OpenStack Platform 16.1 runs on Red Hat Enterprise Linux 8.2. As a result, you must lock the content from these repositories to the respective Red Hat Enterprise Linux version.
			</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
					If you synchronize repositories with Red Hat Satellite, you can enable specific versions of the Red Hat Enterprise Linux repositories. However, the repository remains the same despite the version you choose. For example, you can enable the 8.2 version of the BaseOS repository, but the repository name is still <code class="literal">rhel-8-for-x86_64-baseos-eus-rpms</code> despite the specific version you choose.
				</p></div></div><div class="admonition warning"><div class="admonition_header">Warning</div><div><p>
					Any repositories outside the ones specified here are not supported. Unless recommended, do not enable any other products or repositories outside the ones listed in the following tables or else you might encounter package dependency issues. Do not enable Extra Packages for Enterprise Linux (EPEL).
				</p></div></div><div class="formalpara"><p class="title"><strong>Core repositories</strong></p><p>
					The following table lists core repositories for installing the overcloud.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983837750432" scope="col">Name</th><th align="left" valign="top" id="idm139983837749344" scope="col">Repository</th><th align="left" valign="top" id="idm139983837748256" scope="col">Description of requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - BaseOS (RPMs) Extended Update Support (EUS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">rhel-8-for-x86_64-baseos-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Base operating system repository for x86_64 systems.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">rhel-8-for-x86_64-appstream-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Contains Red Hat OpenStack Platform dependencies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - High Availability (RPMs) Extended Update Support (EUS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">rhel-8-for-x86_64-highavailability-eus-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								High availability tools for Red Hat Enterprise Linux.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Ansible Engine 2.9 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">ansible-2.9-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Ansible Engine for Red Hat Enterprise Linux. Used to provide the latest version of Ansible.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Advanced Virtualization for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">advanced-virt-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Provides virtualization packages for OpenStack Platform.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Satellite Tools for RHEL 8 Server RPMs x86_64
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">satellite-tools-6.5-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Tools for managing hosts with Red Hat Satellite 6.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat OpenStack Platform 16.1 for RHEL 8 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">openstack-16.1-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Core Red Hat OpenStack Platform repository.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983837750432"> <p>
								Red Hat Fast Datapath for RHEL 8 (RPMS)
							</p>
							 </td><td align="left" valign="top" headers="idm139983837749344"> <p>
								<code class="literal">fast-datapath-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983837748256"> <p>
								Provides Open vSwitch (OVS) packages for OpenStack Platform.
							</p>
							 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Ceph repositories</strong></p><p>
					The following table lists Ceph Storage related repositories for the overcloud.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983838120016" scope="col">Name</th><th align="left" valign="top" id="idm139983838118928" scope="col">Repository</th><th align="left" valign="top" id="idm139983838117840" scope="col">Description of Requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - BaseOS (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhel-8-for-x86_64-baseos-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								Base operating system repository for x86_64 systems.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - AppStream (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhel-8-for-x86_64-appstream-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								Contains Red Hat OpenStack Platform dependencies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - High Availability (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhel-8-for-x86_64-highavailability-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								High availability tools for Red Hat Enterprise Linux.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Ansible Engine 2.9 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">ansible-2.9-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								Ansible Engine for Red Hat Enterprise Linux. Used to provide the latest version of Ansible.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat OpenStack Platform 16.1 Director Deployment Tools for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">openstack-16.1-deployment-tools-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								Packages to help director configure Ceph Storage nodes.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Ceph Storage OSD 4 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhceph-4-osd-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								(For Ceph Storage Nodes) Repository for Ceph Storage Object Storage daemon. Installed on Ceph Storage nodes.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Ceph Storage MON 4 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhceph-4-mon-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								(For Ceph Storage Nodes) Repository for Ceph Storage Monitor daemon. Installed on Controller nodes in OpenStack environments using Ceph Storage nodes.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838120016"> <p>
								Red Hat Ceph Storage Tools 4 for RHEL 8 x86_64 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838118928"> <p>
								<code class="literal">rhceph-4-tools-for-rhel-8-x86_64-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838117840"> <p>
								Provides tools for nodes to communicate with the Ceph Storage cluster. This repository should be enabled for all nodes when deploying an overcloud with a Ceph Storage cluster.
							</p>
							 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Real Time repositories</strong></p><p>
					The following table lists repositories for Real Time Compute (RTC) functionality.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983838484640" scope="col">Name</th><th align="left" valign="top" id="idm139983838483552" scope="col">Repository</th><th align="left" valign="top" id="idm139983838482464" scope="col">Description of requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983838484640"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - Real Time (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838483552"> <p>
								<code class="literal">rhel-8-for-x86_64-rt-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838482464"> <p>
								Repository for Real Time KVM (RT-KVM). Contains packages to enable the real time kernel. Enable this repository for all Compute nodes targeted for RT-KVM. NOTE: You need a separate subscription to a <code class="literal">Red Hat OpenStack Platform for Real Time</code> SKU to access this repository.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983838484640"> <p>
								Red Hat Enterprise Linux 8 for x86_64 - Real Time for NFV (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983838483552"> <p>
								<code class="literal">rhel-8-for-x86_64-nfv-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983838482464"> <p>
								Repository for Real Time KVM (RT-KVM) for NFV. Contains packages to enable the real time kernel. Enable this repository for all NFV Compute nodes targeted for RT-KVM. NOTE: You need a separate subscription to a <code class="literal">Red Hat OpenStack Platform for Real Time</code> SKU to access this repository.
							</p>
							 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>IBM POWER repositories</strong></p><p>
					The following table lists repositories for Openstack Platform on POWER PC architecture. Use these repositories in place of equivalents in the Core repositories.
				</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--></col><col style="width: 33%; " class="col_2"><!--Empty--></col><col style="width: 33%; " class="col_3"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983836111680" scope="col">Name</th><th align="left" valign="top" id="idm139983836110592" scope="col">Repository</th><th align="left" valign="top" id="idm139983836109504" scope="col">Description of requirement</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983836111680"> <p>
								Red Hat Enterprise Linux for IBM Power, little endian - BaseOS (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983836110592"> <p>
								<code class="literal">rhel-8-for-ppc64le-baseos-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983836109504"> <p>
								Base operating system repository for ppc64le systems.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983836111680"> <p>
								Red Hat Enterprise Linux 8 for IBM Power, little endian - AppStream (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983836110592"> <p>
								<code class="literal">rhel-8-for-ppc64le-appstream-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983836109504"> <p>
								Contains Red Hat OpenStack Platform dependencies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983836111680"> <p>
								Red Hat Enterprise Linux 8 for IBM Power, little endian - High Availability (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983836110592"> <p>
								<code class="literal">rhel-8-for-ppc64le-highavailability-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983836109504"> <p>
								High availability tools for Red Hat Enterprise Linux. Used for Controller node high availability.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983836111680"> <p>
								Red Hat Ansible Engine 2.8 for RHEL 8 IBM Power, little endian (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983836110592"> <p>
								<code class="literal">ansible-2.8-for-rhel-8-ppc64le-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983836109504"> <p>
								Ansible Engine for Red Hat Enterprise Linux. Used to provide the latest version of Ansible.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm139983836111680"> <p>
								Red Hat OpenStack Platform 16.1 for RHEL 8 (RPMs)
							</p>
							 </td><td align="left" valign="top" headers="idm139983836110592"> <p>
								<code class="literal">openstack-16.1-for-rhel-8-ppc64le-rpms</code>
							</p>
							 </td><td align="left" valign="top" headers="idm139983836109504"> <p>
								Core Red Hat OpenStack Platform repository for ppc64le systems.
							</p>
							 </td></tr></tbody></table></div></section><section class="section" id="red-hat-satellite-6-considerations-repositories"><div class="titlepage"><div><div><h2 class="title">3.3. Red Hat Satellite 6 considerations</h2></div></div></div><p>
				If you use Red Hat Satellite 6 to host RPMs and container images for your Red Hat OpenStack Platform environment, you must account for certain considerations when you use Satellite 6 to deliver content during the Red Hat OpenStack Platform 16.1 upgrade.
			</p><div class="itemizedlist"><p class="title"><strong>Assumptions about your current environment</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your Satellite server already hosts Red Hat OpenStack Platform 13 RPMs and container images.
					</li><li class="listitem">
						You have already registered all nodes in your Red Hat OpenStack Platform 13 environment to the Satellite server. For example, you previously used an activation key linked to an Red Hat OpenStack Platform 13 content view to register nodes to OpenStack Platform 13 content.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Recommendations for Red Hat OpenStack Platform upgrades</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Enable and synchronize the necessary RPM repositories for both the Red Hat OpenStack Platform 13 undercloud and overcloud. This includes the necessary Red Hat Enterprise Linux 8.2 repositories.
					</li><li class="listitem"><p class="simpara">
						Create custom products on the Satellite server to host container images for the following Red Hat OpenStak Platform versions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Red Hat OpenStack Platform 16.1
							</li><li class="listitem">
								Red Hat OpenStack Platform 15
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Create and promote a content view for Red Hat OpenStack Platform 16.1 upgrade and include the following content in the content view:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								All undercloud and overcloud RPM repositories, including Red Hat Enterprise Linux 8.2 repositories.
							</li><li class="listitem">
								Red Hat OpenStack Platform 16.1 container images.
							</li><li class="listitem">
								Red Hat OpenStack Platform 15 container images.
							</li></ul></div></li><li class="listitem">
						Create an activation key for the upgrade to Red Hat OpenStack Platform 16.1 and associate the activation key with the Red Hat OpenStack Platform 16.1 content view. Pin this activation key to Red Hat Enterprise Linux 8.2.
					</li><li class="listitem">
						Check that no node has the <code class="literal">katello-host-tools-fact-plugin</code> package installed. The Leapp upgrade does not upgrade this package and leaving this package on a Red Hat Enterprise Linux 8.2 system causes <code class="literal">subscription-manager</code> to report errors.
					</li></ul></div></section></section><div class="part" id="upgrading_the_undercloud"><div class="titlepage"><div><div><h1 class="title">Part I. Upgrading the undercloud</h1></div></div></div><section class="chapter" id="preparing-for-the-undercloud-upgrade"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Preparing for the undercloud upgrade</h2></div></div></div><p>
				Before you perform the undercloud upgrade, you must complete some preparation steps so that the undercloud upgrade runs successfully.
			</p><section class="section" id="new-memory-requirements"><div class="titlepage"><div><div><h2 class="title">4.1. New memory requirements</h2></div></div></div><p>
					In Red Hat OpenStack Platform 16.1, the undercloud has new memory requirements:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983839236096" scope="col">Red Hat OpenStack Platform 13</th><th align="left" valign="top" id="idm139983839235040" scope="col">Red Hat OpenStack Platform 16.1</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983839236096"> <p>
									16 GB RAM
								</p>
								 </td><td align="left" valign="top" headers="idm139983839235040"> <p>
									24 GB RAM
								</p>
								 </td></tr></tbody></table></div><p>
					Ensure that your undercloud meets these new requirements before you proceed with the upgrade.
				</p></section><section class="section" id="using-predictable-nic-names-preparing-undercloud"><div class="titlepage"><div><div><h2 class="title">4.2. Using predictable NIC names for the undercloud node</h2></div></div></div><p>
					Before you run the Leapp upgrade on the undercloud node, you must check for kernel-based NIC names, which usually contain a <code class="literal">eth</code> prefix. These NIC names are usually unpredictable in terms of NIC assignments. The Leapp upgrade fails if any NICs on the node use the <code class="literal">eth</code> prefix.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Create an Ansible playbook named <code class="literal">playbook-nics.yaml</code> and copy the following content into the playbook:
						</p><pre class="screen">---
- name: Rename eth devices
  hosts: all
  become: yes
  vars:
    prefix: "em"
  tasks:
    - set_fact:
        eth_interfaces: "{{ ansible_interfaces | select('match','eth.*') | list }}"
    - debug:
        msg: "{{ eth_interfaces }}"
    - name: Update udev rules
      lineinfile:
        line: "SUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"{{ ansible_facts[item]['perm_macaddress'] | default(ansible_facts[item]['macaddress']) }}\", NAME=\"{{ item|replace('eth',prefix) }}\""
        path: /etc/udev/rules.d/70-rhosp-persistent-net.rules
        create: True
      with_items: "{{ eth_interfaces }}"
    - name: Rename eth files
      block:
        - name: Check that eth files exists
          stat:
            path: /etc/sysconfig/network-scripts/ifcfg-{{ item }}
          register: nic_result
          with_items: "{{ eth_interfaces }}"
        - name: Copy nic files using the new prefix
          copy:
            remote_src: True
            src: "{{ item.stat.path }}"
            dest: "{{ item.stat.path|replace('eth',prefix) }}"
          with_items: "{{ nic_result.results }}"
          when: item.stat.exists
        - name: Edit NAME in new network-script files
          lineinfile:
            regexp: "^NAME=.*"
            line: "NAME={{ item.item|replace('eth',prefix) }}"
            path: "{{ item.stat.path|replace('eth',prefix) }}"
          with_items: "{{ nic_result.results }}"
          when: item.stat.exists
        - name: Edit DEVICE in new network-script files
          lineinfile:
            regexp: "^DEVICE=.*"
            line: "DEVICE={{ item.item|replace('eth',prefix) }}"
            path: "{{ item.stat.path|replace('eth',prefix) }}"
          with_items: "{{ nic_result.results }}"
          when: item.stat.exists
        - name: Backup old eth network-script files
          copy:
            remote_src: True
            src: "{{ item.stat.path }}"
            dest: "{{ item.stat.path }}.bak"
          with_items: "{{ nic_result.results }}"
          when: item.stat.exists
        - name: Remove old eth network-script files
          file:
            path: "{{ item.stat.path }}"
            state: absent
          with_items: "{{ nic_result.results }}"
          when: item.stat.exists
    - name: Rename route files
      block:
        - name: Check that route files exists
          stat:
            path: /etc/sysconfig/network-scripts/route-{{ item }}
          register: route_result
          with_items: "{{ eth_interfaces }}"
        - name: Copy route files using the new prefix
          copy:
            remote_src: True
            src: "{{ item.stat.path }}"
            dest: "{{ item.stat.path|replace('eth',prefix) }}"
          with_items: "{{ route_result.results }}"
          when: item.stat.exists
        - name: Update prefix in route files that use IP command arguments format
          replace:
            regexp: "eth"
            replace: "{{ prefix }}"
            path: "{{ item.stat.path|replace('eth',prefix) }}"
          with_items: "{{ route_result.results }}"
          when: item.stat.exists
        - name: Backup old route files
          copy:
            remote_src: True
            src: "{{ item.stat.path }}"
            dest: "{{ item.stat.path }}.bak"
          with_items: "{{ route_result.results }}"
          when: item.stat.exists
        - name: Remove old route files
          file:
            path: "{{ item.stat.path }}"
            state: absent
          with_items: "{{ route_result.results }}"
          when: item.stat.exists
    - name: Perform a final regex for any remaining eth prefixes in ifcfg files
      block:
        - name: Get a list of all ifcfg files
          find:
            paths: /etc/sysconfig/network-scripts/
            patterns: 'ifcfg-*'
          register: ifcfg_files
        - name: Perform final regex on ifcfg files
          replace:
            path: "{{ item[0].path }}"
            regexp: "{{ item[1] }}"
            replace: "{{ item[1]|replace('eth',prefix) }}"
          with_nested:
            - "{{ ifcfg_files.files }}"
            - "{{ eth_interfaces }}"</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								You will use this playbook to rename the overcloud NICs at a later stage in the upgrade process.
							</p></div></div></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">playbook-nics.yaml</code> playbook on the undercloud:
						</p><pre class="screen">$ ansible-playbook -c local -i localhost, playbook-nics.yaml</pre><p class="simpara">
							The playbook sets the new NIC prefix to <code class="literal">em</code>. To set a different NIC prefix, set the <code class="literal">prefix</code> variable when running the playbook:
						</p><pre class="screen">$ ansible-playbook -c local -i localhost, -e prefix="mynic" ~/playbook-nics.yaml</pre></li><li class="listitem">
							Reboot the undercloud node using the standard reboot procedures. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/director_installation_and_usage/sect-rebooting_the_overcloud">"Rebooting nodes"</a>.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/solutions/4067471">"How to perform an in-place upgrade to RHEL 8 when using kernel NIC names on RHEL 7"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/ch-consistent_network_device_naming#sec-Naming_Schemes_Hierarchy">"Consistent Network Device Naming"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_predictable_network_interface_device_names">"Understanding the Predictable Network Interface Device Names"</a>
						</li></ul></div></section><section class="section" id="setting-the-ssh-root-permission-parameter-on-the-undercloud-preparing-undercloud"><div class="titlepage"><div><div><h2 class="title">4.3. Setting the SSH root permission parameter on the undercloud</h2></div></div></div><p>
					The Leapp upgrade checks whether the <code class="literal">PermitRootLogin</code> parameter exists in the <code class="literal">/etc/ssh/sshd_config</code> file. You must explicitly set this parameter to either <code class="literal">yes</code> or <code class="literal">no</code>.
				</p><p>
					For security purposes, set this parameter to <code class="literal">no</code> to disable SSH access to the root user on the undercloud.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Check the <code class="literal">/etc/ssh/sshd_config</code> file for the <code class="literal">PermitRootLogin</code> parameter:
						</p><pre class="screen">$ sudo grep PermitRootLogin /etc/ssh/sshd_config</pre></li><li class="listitem"><p class="simpara">
							If the parameter is not in the <code class="literal">/etc/ssh/sshd_config</code> file, edit the file and set the <code class="literal">PermitRootLogin</code> parameter:
						</p><pre class="screen">PermitRootLogin no</pre></li><li class="listitem">
							Save the file.
						</li></ol></div></section></section><section class="chapter" id="upgrading-the-undercloud-operating-system"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Upgrading the undercloud operating system</h2></div></div></div><p>
				Before you upgrade director, you must upgrade the undercloud operating system from Red Hat Enterprise Linux 7 to Red Hat Enterprise Linux 8. As a part of this operating system upgrade, you must remove the Red Hat OpenStack Platform 13 packages and then run the Leapp utility to upgrade the system packages. This package removal and operating system upgrade does not affect the undercloud database. After you complete the operating system upgrade, reinstall the Red Hat OpenStack Platform 16.1 versions of the director packages.
			</p><section class="section" id="removing-red-hat-openstack-platform-director-packages"><div class="titlepage"><div><div><h2 class="title">5.1. Removing Red Hat OpenStack Platform director packages</h2></div></div></div><p>
					Before you run the Leapp utility, remove the Red Hat OpenStack Platform 13 packages tied to Red Hat Enterprise Linux 7. These package names use a release suffix of <code class="literal">el7ost</code>. Some <code class="literal">el7ost</code> remain on the system as dependencies for <code class="literal">subscription-manager</code> and the Leapp utility.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Disable the main OpenStack services on the undercloud:
						</p><pre class="screen">$ sudo systemctl stop openstack-* httpd haproxy mariadb rabbitmq* docker xinetd</pre></li><li class="listitem"><p class="simpara">
							Remove the main OpenStack services from the undercloud, except OpenvSwitch and certain Python 2 packages that are required for the upgrade:
						</p><pre class="screen">$ sudo yum -y remove *el7ost* galera* haproxy* \
    httpd mysql* pacemaker* xinetd python-jsonpointer \
    qemu-kvm-common-rhev qemu-img-rhev rabbit* \
    redis* \
    -- \
    -*openvswitch* -python-docker -python-PyMySQL \
    -python-pysocks -python2-asn1crypto -python2-babel \
    -python2-cffi -python2-cryptography -python2-dateutil \
    -python2-idna -python2-ipaddress -python2-jinja2 \
    -python2-jsonpatch -python2-markupsafe -python2-pyOpenSSL \
    -python2-requests -python2-six -python2-urllib3 \
    -python-httplib2 -python-passlib -python2-netaddr -ceph-ansible</pre></li><li class="listitem"><p class="simpara">
							Remove the content from the <code class="literal">/etc/httpd</code> and <code class="literal">/var/lib/docker</code> directories:
						</p><pre class="screen">$ sudo rm -rf /etc/httpd /var/lib/docker</pre></li></ol></div></section><section class="section" id="performing-a-leapp-upgrade-on-the-undercloud"><div class="titlepage"><div><div><h2 class="title">5.2. Performing a Leapp upgrade on the undercloud</h2></div></div></div><p>
					Install and run the Leapp utility to upgrade the operating system to Red Hat Enterprise Linux 8.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Install the Leapp utility:
						</p><pre class="screen">$ sudo yum install leapp</pre></li><li class="listitem">
							Download the additional required data files (RPM package changes and RPM repository mapping) attached to the Knowledge Base article <a class="link" href="https://access.redhat.com/articles/3664871">"Data required by the Leapp utility for an in-place upgrade from RHEL 7 to RHEL 8"</a> and place these files in the <code class="literal">/etc/leapp/files/</code> directory.
						</li><li class="listitem"><p class="simpara">
							Update your Red Hat subscription:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If your undercloud uses the Red Hat Customer Portal for registration, refresh your current subscription to obtain access to the Red Hat Enterprise Linux 8.2 content:
								</p><pre class="screen">$ sudo subscription-manager refresh</pre></li><li class="listitem"><p class="simpara">
									If your undercloud uses a Red Hat Satellite server for registration, re-register the undercloud to a content view associated with your Red Hat OpenStack Platform 16.1 activation key.
								</p><pre class="screen">$ sudo subscription-manager register --force --org <span class="emphasis"><em>ORG</em></span> --activationkey <span class="emphasis"><em>ACTIVATION_KEY</em></span> --release 8.2</pre><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										The content view that you create for Red Hat OpenStack Platform 16.1 should contain content for Red Hat Enterprise Linux 8.2.
									</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							Red Hat OpenStack Platform 16.1 uses a newer version of Open vSwitch`. Substitute the Open vSwitch version through the <code class="literal">to_remove</code> and <code class="literal">to_install</code> transaction files:
						</p><pre class="screen">$ echo 'openvswitch2.11' | sudo tee -a /etc/leapp/transaction/to_remove
$ echo 'openvswitch2.13' | sudo tee -a /etc/leapp/transaction/to_install</pre></li><li class="listitem"><p class="simpara">
							Retain the Red Hat Ceph Storage 3 version of <code class="literal">ceph-ansible</code> through the upgrade with the <code class="literal">to_keep</code> transaction file:
						</p><pre class="screen">$ echo 'ceph-ansible' | sudo tee -a /etc/leapp/transaction/to_keep</pre></li><li class="listitem"><p class="simpara">
							Start the Leapp upgrade process:
						</p><pre class="screen">$ sudo leapp upgrade --debug --enablerepo rhel-8-for-x86_64-baseos-eus-rpms --enablerepo rhel-8-for-x86_64-appstream-eus-rpms --enablerepo fast-datapath-for-rhel-8-x86_64-rpms --enablerepo ansible-2.9-for-rhel-8-x86_64-rpms</pre><p class="simpara">
							Use the <code class="literal">--enablerepo</code> option to set the repositories that you want to enable during the Leapp upgrade process. You must include these repositories to facilitate the Red Hat OpenStack Platform 16.1 transition, especially with the newer version of Open vSwitch.
						</p></li><li class="listitem">
							Wait for the <code class="literal">leapp upgrade</code> command to successfully complete.
						</li><li class="listitem"><p class="simpara">
							Create an empty <code class="literal">.autorelabel</code> file in your root directory:
						</p><pre class="screen">$ sudo touch /.autorelabel</pre><p class="simpara">
							After a reboot, SELinux detects this file and automatically relabels the file system.
						</p></li><li class="listitem"><p class="simpara">
							Reboot the undercloud:
						</p><pre class="screen">$ sudo reboot</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/3664871">"Data required by the Leapp utility for an in-place upgrade from RHEL 7 to RHEL 8"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/solutions/4067471">"How to perform an in-place upgrade to RHEL 8 when using kernel NIC names on RHEL 7"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/upgrading_to_rhel_8/">"Upgrading to RHEL 8"</a>
						</li></ul></div></section></section><section class="chapter" id="upgrading-director"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Upgrading director</h2></div></div></div><p>
				After you complete the undercloud operating system upgrade, upgrade director. The database from the previous Red Hat OpenStack Platform 13 undercloud remains on host after the operating system upgrade. Install the new Red Hat OpenStack Platform 16.1 packages and configure the new source for Red Hat OpenStack Platform 16.1 container images before you run the <code class="literal">openstack undercloud upgrade</code> command.
			</p><section class="section" id="locking-the-environment-to-a-red-hat-enterprise-linux-release"><div class="titlepage"><div><div><h2 class="title">6.1. Locking the environment to a Red Hat Enterprise Linux release</h2></div></div></div><p>
					Red Hat OpenStack Platform 16.1 is supported on Red Hat Enterprise Linux 8.2. Before you perform the update, you must lock the undercloud repositories to the Red Hat Enterprise Linux 8.2 release to avoid upgrading the operating system to a newer minor release.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Lock the undercloud to a specific verison with the <code class="literal">subscription-manager release</code> command:
						</p><pre class="screen">$ sudo subscription-manager release --set=8.2</pre></li></ol></div></section><section class="section" id="enabling-repositories-for-the-undercloud"><div class="titlepage"><div><div><h2 class="title">6.2. Enabling repositories for the undercloud</h2></div></div></div><p>
					Enable the repositories that are required for the undercloud, and update the system packages to the latest versions.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to your undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Disable all default repositories, and enable the required Red Hat Enterprise Linux repositories:
						</p><pre class="screen">[stack@director ~]$ sudo subscription-manager repos --disable=*
[stack@director ~]$ sudo subscription-manager repos --enable=rhel-8-for-x86_64-baseos-eus-rpms --enable=rhel-8-for-x86_64-appstream-eus-rpms --enable=rhel-8-for-x86_64-highavailability-eus-rpms --enable=ansible-2.9-for-rhel-8-x86_64-rpms --enable=openstack-16.1-for-rhel-8-x86_64-rpms --enable=fast-datapath-for-rhel-8-x86_64-rpms --enable=advanced-virt-for-rhel-8-x86_64-rpms</pre><p class="simpara">
							These repositories contain packages that the director installation requires.
						</p></li><li class="listitem"><p class="simpara">
							Set the <code class="literal">container-tools</code> repository module to version <code class="literal">2.0</code>:
						</p><pre class="screen">[stack@director ~]$ sudo dnf module disable -y container-tools:rhel8
[stack@director ~]$ sudo dnf module enable -y container-tools:2.0</pre></li><li class="listitem"><p class="simpara">
							Set the <code class="literal">virt</code> repository module to version <code class="literal">8.2</code>:
						</p><pre class="screen">[stack@director ~]$ sudo dnf module disable -y virt:rhel
[stack@director ~]$ sudo dnf module enable -y virt:8.2</pre></li><li class="listitem"><p class="simpara">
							Synchronize the operating system to ensure that your system packages match the operating system version:
						</p><pre class="screen">[stack@director ~]$ sudo dnf distro-sync -y
[stack@director ~]$ sudo reboot</pre></li></ol></div></section><section class="section" id="installing_director_packages"><div class="titlepage"><div><div><h2 class="title">6.3. Installing director packages</h2></div></div></div><p>
					Install packages relevant to Red Hat OpenStack Platform director.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the command line tools for director installation and configuration:
						</p><pre class="screen">[stack@director ~]$ sudo dnf install -y python3-tripleoclient</pre></li></ol></div></section><section class="section" id="preparing-container-images"><div class="titlepage"><div><div><h2 class="title">6.4. Preparing container images</h2></div></div></div><p>
					The undercloud installation requires an environment file to determine where to obtain container images and how to store them. Generate and customize this environment file that you can use to prepare your container images.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to your undercloud host as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Generate the default container image preparation file:
						</p><pre class="screen">$ openstack tripleo container image prepare default \
  --local-push-destination \
  --output-env-file containers-prepare-parameter.yaml</pre><p class="simpara">
							This command includes the following additional options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">--local-push-destination</code> sets the registry on the undercloud as the location for container images. With this option, director pulls the necessary images from the Red Hat Container Catalog and pushes the images to the registry on the undercloud. Director uses the undercloud registry as the container image source. To pull container images directly from the Red Hat Container Catalog, omit this option.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">--output-env-file</code> specifies an environment file that includes include the parameters for preparing your container images. In this example, the name of the file is <code class="literal">containers-prepare-parameter.yaml</code>.
								</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
										You can use the same <code class="literal">containers-prepare-parameter.yaml</code> file to define a container image source for both the undercloud and the overcloud.
									</p></div></div></li></ul></div></li><li class="listitem">
							Modify the <code class="literal">containers-prepare-parameter.yaml</code> to suit your requirements.
						</li></ol></div></section><section class="section" id="container-image-preparation-parameters"><div class="titlepage"><div><div><h2 class="title">6.5. Container image preparation parameters</h2></div></div></div><p>
					The default file for preparing your containers (<code class="literal">containers-prepare-parameter.yaml</code>) contains the <code class="literal">ContainerImagePrepare</code> heat parameter. This parameter defines a list of strategies for preparing a set of images:
				</p><pre class="screen">parameter_defaults:
  ContainerImagePrepare:
  - (strategy one)
  - (strategy two)
  - (strategy three)
  ...</pre><p>
					Each strategy accepts a set of sub-parameters that defines which images to use and what to do with the images. The following table contains information about the sub-parameters you can use with each <code class="literal">ContainerImagePrepare</code> strategy:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983837950832" scope="col">Parameter</th><th align="left" valign="top" id="idm139983837949744" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">excludes</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									List of image name substrings to exclude from a strategy.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">includes</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									List of image name substrings to include in a strategy. At least one image name must match an existing image. All <code class="literal">excludes</code> are ignored if <code class="literal">includes</code> is specified.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">modify_append_tag</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									String to append to the tag for the destination image. For example, if you pull an image with the tag <code class="literal">14.0-89</code> and set the <code class="literal">modify_append_tag</code> to <code class="literal">-hotfix</code>, the director tags the final image as <code class="literal">14.0-89-hotfix</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">modify_only_with_labels</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									A dictionary of image labels that filter the images that you want to modify. If an image matches the labels defined, the director includes the image in the modification process.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">modify_role</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									String of ansible role names to run during upload but before pushing the image to the destination registry.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">modify_vars</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									Dictionary of variables to pass to <code class="literal">modify_role</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">push_destination</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									Defines the namespace of the registry that you want to push images to during the upload process.
								</p>
								 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											If set to <code class="literal">true</code>, the <code class="literal">push_destination</code> is set to the undercloud registry namespace using the hostname, which is the recommended method.
										</li><li class="listitem">
											If set to <code class="literal">false</code>, the push to a local registry does not occur and nodes pull images directly from the source.
										</li><li class="listitem">
											If set to a custom value, director pushes images to an external local registry.
										</li></ul></div>
								 <p>
									If you choose to pull container images directly from the Red Hat Container Catalog, do not set this parameter to <code class="literal">false</code> in production environments or else all overcloud nodes will simultaneously pull the images from the Red Hat Container Catalog over your external connection, which can cause bandwidth issues. If the <code class="literal">push_destination</code> parameter is set to <code class="literal">false</code> or is not defined and the remote registry requires authentication, set the <code class="literal">ContainerImageRegistryLogin</code> parameter to <code class="literal">true</code> and include the credentials with the <code class="literal">ContainerImageRegistryCredentials</code> parameter.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">pull_source</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									The source registry from where to pull the original container images.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">set</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									A dictionary of <code class="literal">key: value</code> definitions that define where to obtain the initial images.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983837950832"> <p>
									<code class="literal">tag_from_label</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983837949744"> <p>
									Defines the label pattern to tag the resulting images. Usually sets to <code class="literal">{version}-{release}</code>.
								</p>
								 </td></tr></tbody></table></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						When you push images to the undercloud, use <code class="literal">push_destination: true</code> instead of <code class="literal">push_destination: UNDERCLOUD_IP:PORT</code>. The <code class="literal">push_destination: true</code> method provides a level of consistency across both IPv4 and IPv6 addresses.
					</p></div></div><p>
					The <code class="literal">set</code> parameter accepts a set of <code class="literal">key: value</code> definitions:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983838297104" scope="col">Key</th><th align="left" valign="top" id="idm139983838296016" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">ceph_image</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The name of the Ceph Storage container image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">ceph_namespace</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The namespace of the Ceph Storage container image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">ceph_tag</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The tag of the Ceph Storage container image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">name_prefix</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									A prefix for each OpenStack service image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">name_suffix</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									A suffix for each OpenStack service image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">namespace</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The namespace for each OpenStack service image.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">neutron_driver</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The driver to use to determine which OpenStack Networking (neutron) container to use. Use a null value to set to the standard <code class="literal">neutron-server</code> container. Set to <code class="literal">ovn</code> to use OVN-based containers.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983838297104"> <p>
									<code class="literal">tag</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983838296016"> <p>
									The tag that the director uses to identify the images to pull from the source registry. You usually keep this key set to the default value, which is the Red Hat OpenStack Platform version number.
								</p>
								 </td></tr></tbody></table></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						The container images use multi-stream tags based on Red Hat OpenStack Platform version. This means there is no longer a <code class="literal">latest</code> tag.
					</p></div></div><p>
					The <code class="literal">ContainerImageRegistryCredentials</code> parameter maps a container registry to a username and password to authenticate to that registry.
				</p><p>
					If a container registry requires a username and password, you can use <code class="literal">ContainerImageRegistryCredentials</code> to include credentials with the following syntax:
				</p><pre class="screen">  ContainerImagePrepare:
  - push_destination: true
    set:
      namespace: registry.redhat.io/...
      ...
  ContainerImageRegistryCredentials:
    registry.redhat.io:
      my_username: my_password</pre><p>
					In the example, replace <code class="literal">my_username</code> and <code class="literal">my_password</code> with your authentication credentials. Instead of using your individual user credentials, Red Hat recommends creating a registry service account and using those credentials to access <code class="literal">registry.redhat.io</code> content. For more information, see <a class="link" href="https://access.redhat.com/RegistryAuthentication">"Red Hat Container Registry Authentication"</a>.
				</p><p>
					The <code class="literal">ContainerImageRegistryLogin</code> parameter is used to control the registry login on the systems being deployed. This must be set to <code class="literal">true</code> if <code class="literal">push_destination</code> is set to false or not used.
				</p><pre class="screen">  ContainerImagePrepare:
  - set:
      namespace: registry.redhat.io/...
      ...
  ContainerImageRegistryCredentials:
    registry.redhat.io:
      my_username: my_password
  ContainerImageRegistryLogin: true</pre><p>
					If you have configured <code class="literal">push_destination</code>, do not set <code class="literal">ContainerImageRegistryLogin</code> to <code class="literal">true</code>. If you set this option to <code class="literal">true</code> and the overcloud nodes do not have network connectivity to the registry hosts defined in <code class="literal">ContainerImageRegistryCredentials</code>, the deployment might fail when trying to perform a login.
				</p></section><section class="section" id="obtaining-container-images-from-private-registries"><div class="titlepage"><div><div><h2 class="title">6.6. Obtaining container images from private registries</h2></div></div></div><p>
					Some container image registries require authentication to access images. In this situation, use the <code class="literal">ContainerImageRegistryCredentials</code> parameter in your <code class="literal">containers-prepare-parameter.yaml</code> environment file.
				</p><pre class="screen">parameter_defaults:
  ContainerImagePrepare:
  - (strategy one)
  - (strategy two)
  - (strategy three)
  ContainerImageRegistryCredentials:
    registry.example.com:
      username: "p@55w0rd!"</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Private registries require <code class="literal">push_destination</code> set to <code class="literal">true</code> for their respective strategy in the <code class="literal">ContainerImagePrepare</code>.
					</p></div></div><p>
					The <code class="literal">ContainerImageRegistryCredentials</code> parameter uses a set of keys based on the private registry URL. Each private registry URL uses its own key and value pair to define the username (key) and password (value). This provides a method to specify credentials for multiple private registries.
				</p><pre class="screen">parameter_defaults:
  ...
  ContainerImageRegistryCredentials:
    registry.redhat.io:
      myuser: 'p@55w0rd!'
    registry.internalsite.com:
      myuser2: '0th3rp@55w0rd!'
    '192.0.2.1:8787':
      myuser3: '@n0th3rp@55w0rd!'</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The default <code class="literal">ContainerImagePrepare</code> parameter pulls container images from <code class="literal">registry.redhat.io</code>, which requires authentication.
					</p></div></div><p>
					The <code class="literal">ContainerImageRegistryLogin</code> parameter is used to control whether the system needs to log in to the remote registry to fetch the containers.
				</p><pre class="screen">parameter_defaults:
  ...
  ContainerImageRegistryLogin: true</pre><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You must set <code class="literal">ContainerImageRegistryLogin</code> to <code class="literal">true</code> if <code class="literal">push_destination</code> is not configured for a given strategy. If <code class="literal">push_destination</code> is configured in a <code class="literal">ContainerImagePrepare</code> strategy and the <code class="literal">ContainerImageRegistryCredentials</code> parameter is configured, the system logs in to fetch the containers and pushes them to the remote system. If the overcloud nodes do not have network connectivity to the registry hosts defined in the <code class="literal">ContainerImageRegistryCredentials</code>, set <code class="literal">push_destination</code> to <code class="literal">true</code> and <code class="literal">ContainerImageRegistryLogin</code> to <code class="literal">false</code> .
					</p></div></div></section><section class="section" id="obtaining-transitional-containers-for-upgrades-undercloud"><div class="titlepage"><div><div><h2 class="title">6.7. Obtaining transitional containers for upgrades</h2></div></div></div><p>
					The upgrade requires containers from previous versions of Red Hat OpenStack Platform and Red Hat Ceph Storage. These containers help transition to Red Hat OpenStack Platform 16.1.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to your undercloud host as the <code class="literal">stack</code> user.
						</li><li class="listitem">
							Edit the <code class="literal">containers-prepare-parameter.yaml</code> file.
						</li><li class="listitem"><p class="simpara">
							Add the following parameters to the <code class="literal">set</code> in the <code class="literal">ContainerImagePrepare</code> parameter:
						</p><pre class="screen">parameter_defaults:
  ContainerImagePrepare:
  - push_destination: true
    set:
      ...
      name_prefix_stein: openstack-
      name_suffix_stein: ''
      namespace_stein: registry.redhat.io/rhosp15-rhel8
      tag_stein: 15.0
      ceph3_namespace: registry.redhat.io/rhceph
      ceph3_tag: latest
      ceph3_image: rhceph-3-rhel7
      ...</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">*_stein</code> parameters define the container images for Red Hat OpenStack Platform 15, which the upgrade process uses for database migration.
								</li><li class="listitem">
									The <code class="literal">ceph3_*</code> parameters define the current Red Hat Ceph Storage container images that the overcloud uses. The overcloud requires these containers until the transition from Red Hat Ceph Storage 3 to 4.
								</li><li class="listitem">
									If you use Red Hat Satellite for container image storage, set the namespaces to the image locations on the Red Hat Satellite server.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Change the <code class="literal">neutron_driver</code> parameter to <code class="literal">openvswitch</code>:
						</p><pre class="screen">parameter_defaults:
  ContainerImagePrepare:
  - push_destination: true
    set:
      ...
      neutron_driver: openvswitch
      ...</pre><p class="simpara">
							The upgrade retains Open vSwitch compatibility throughout the process. After you complete the upgrade to Red Hat OpenStack Platform 16.1, you migrate the overcloud from Open vSwitch to Open Virtual Network (OVN).
						</p></li><li class="listitem">
							Save the <code class="literal">containers-prepare-parameter.yaml</code> file.
						</li></ol></div></section><section class="section" id="updating-the-undercloud-conf-file-undercloud"><div class="titlepage"><div><div><h2 class="title">6.8. Updating the undercloud.conf file</h2></div></div></div><p>
					You can continue using the original <code class="literal">undercloud.conf</code> file from your Red Hat OpenStack Platform 13 environment, but you must modify the file to retain compatibility with Red Hat OpenStack Platform 16.1.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to your undercloud host as the <code class="literal">stack</code> user.
						</li><li class="listitem">
							Edit the <code class="literal">undercloud.conf</code> file.
						</li><li class="listitem"><p class="simpara">
							Add the following parameter to the <code class="literal">DEFAULT</code> section in the file:
						</p><pre class="screen">container_images_file = /home/stack/containers-prepare-parameter.yaml</pre><p class="simpara">
							This parameter defines the location of the <code class="literal">containers-prepare-parameter.yaml</code> environment file so that director pulls container images for the undercloud from the correct location.
						</p></li><li class="listitem">
							Check the <code class="literal">generate_service_certificate</code> parameter. The default for this parameter changes from <code class="literal">false</code> to <code class="literal">true</code>, which enables SSL/TLS on your undercloud, during the upgrade.
						</li><li class="listitem">
							Check the <code class="literal">local_interface</code> parameter if you have migrated to a predictable NIC naming convention.
						</li><li class="listitem">
							If you set the <code class="literal">masquerade_network</code> parameter in Red Hat OpenStack Platform 13, remove this parameter and set <code class="literal">masquerade = true</code> for each subnet.
						</li><li class="listitem">
							Check all other parameters in the file for any changes.
						</li><li class="listitem">
							Save the file.
						</li></ol></div></section><section class="section" id="director-configuration-parameters"><div class="titlepage"><div><div><h2 class="title">6.9. Director configuration parameters</h2></div></div></div><p>
					The following list contains information about parameters for configuring the <code class="literal">undercloud.conf</code> file. Keep all parameters within their relevant sections to avoid errors.
				</p><div class="formalpara"><p class="title"><strong>Defaults</strong></p><p>
						The following parameters are defined in the <code class="literal">[DEFAULT]</code> section of the <code class="literal">undercloud.conf</code> file:
					</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">additional_architectures</span></dt><dd><p class="simpara">
								A list of additional (kernel) architectures that an overcloud supports. Currently the overcloud supports <code class="literal">ppc64le</code> architecture.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									When you enable support for ppc64le, you must also set <code class="literal">ipxe_enabled</code> to <code class="literal">False</code>
								</p></div></div></dd><dt><span class="term">certificate_generation_ca</span></dt><dd>
								The <code class="literal">certmonger</code> nickname of the CA that signs the requested certificate. Use this option only if you have set the <code class="literal">generate_service_certificate</code> parameter. If you select the <code class="literal">local</code> CA, certmonger extracts the local CA certificate to <code class="literal">/etc/pki/ca-trust/source/anchors/cm-local-ca.pem</code> and adds the certificate to the trust chain.
							</dd><dt><span class="term">clean_nodes</span></dt><dd>
								Defines whether to wipe the hard drive between deployments and after introspection.
							</dd><dt><span class="term">cleanup</span></dt><dd>
								Cleanup temporary files. Set this to <code class="literal">False</code> to leave the temporary files used during deployment in place after you run the deployment command. This is useful for debugging the generated files or if errors occur.
							</dd><dt><span class="term">container_cli</span></dt><dd>
								The CLI tool for container management. Leave this parameter set to <code class="literal">podman</code>. Red Hat Enterprise Linux 8.2 only supports <code class="literal">podman</code>.
							</dd><dt><span class="term">container_healthcheck_disabled</span></dt><dd>
								Disables containerized service health checks. Red Hat recommends that you enable health checks and leave this option set to <code class="literal">false</code>.
							</dd><dt><span class="term">container_images_file</span></dt><dd><p class="simpara">
								Heat environment file with container image information. This file can contain the following entries:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Parameters for all required container images
									</li><li class="listitem">
										The <code class="literal">ContainerImagePrepare</code> parameter to drive the required image preparation. Usually the file that contains this parameter is named <code class="literal">containers-prepare-parameter.yaml</code>.
									</li></ul></div></dd><dt><span class="term">container_insecure_registries</span></dt><dd>
								A list of insecure registries for <code class="literal">podman</code> to use. Use this parameter if you want to pull images from another source, such as a private container registry. In most cases, <code class="literal">podman</code> has the certificates to pull container images from either the Red Hat Container Catalog or from your Satellite server if the undercloud is registered to Satellite.
							</dd><dt><span class="term">container_registry_mirror</span></dt><dd>
								An optional <code class="literal">registry-mirror</code> configured that <code class="literal">podman</code> uses.
							</dd><dt><span class="term">custom_env_files</span></dt><dd>
								Additional environment files that you want to add to the undercloud installation.
							</dd><dt><span class="term">deployment_user</span></dt><dd>
								The user who installs the undercloud. Leave this parameter unset to use the current default user <code class="literal">stack</code>.
							</dd><dt><span class="term">discovery_default_driver</span></dt><dd>
								Sets the default driver for automatically enrolled nodes. Requires the <code class="literal">enable_node_discovery</code> parameter to be enabled and you must include the driver in the <code class="literal">enabled_hardware_types</code> list.
							</dd><dt><span class="term">enable_ironic; enable_ironic_inspector; enable_mistral; enable_nova; enable_tempest; enable_validations; enable_zaqar</span></dt><dd>
								Defines the core services that you want to enable for director. Leave these parameters set to <code class="literal">true</code>.
							</dd><dt><span class="term">enable_node_discovery</span></dt><dd>
								Automatically enroll any unknown node that PXE-boots the introspection ramdisk. New nodes use the <code class="literal">fake_pxe</code> driver as a default but you can set <code class="literal">discovery_default_driver</code> to override. You can also use introspection rules to specify driver information for newly enrolled nodes.
							</dd><dt><span class="term">enable_novajoin</span></dt><dd>
								Defines whether to install the <code class="literal">novajoin</code> metadata service in the undercloud.
							</dd><dt><span class="term">enable_routed_networks</span></dt><dd>
								Defines whether to enable support for routed control plane networks.
							</dd><dt><span class="term">enable_swift_encryption</span></dt><dd>
								Defines whether to enable Swift encryption at-rest.
							</dd><dt><span class="term">enable_telemetry</span></dt><dd>
								Defines whether to install OpenStack Telemetry services (gnocchi, aodh, panko) in the undercloud. Set the <code class="literal">enable_telemetry</code> parameter to <code class="literal">true</code> if you want to install and configure telemetry services automatically. The default value is <code class="literal">false</code>, which disables telemetry on the undercloud. This parameter is required if you use other products that consume metrics data, such as Red Hat CloudForms.
							</dd><dt><span class="term">enabled_hardware_types</span></dt><dd>
								A list of hardware types that you want to enable for the undercloud.
							</dd><dt><span class="term">generate_service_certificate</span></dt><dd>
								Defines whether to generate an SSL/TLS certificate during the undercloud installation, which is used for the <code class="literal">undercloud_service_certificate</code> parameter. The undercloud installation saves the resulting certificate <code class="literal">/etc/pki/tls/certs/undercloud-[undercloud_public_vip].pem</code>. The CA defined in the <code class="literal">certificate_generation_ca</code> parameter signs this certificate.
							</dd><dt><span class="term">heat_container_image</span></dt><dd>
								URL for the heat container image to use. Leave unset.
							</dd><dt><span class="term">heat_native</span></dt><dd>
								Run host-based undercloud configuration using <code class="literal">heat-all</code>. Leave as <code class="literal">true</code>.
							</dd><dt><span class="term">hieradata_override</span></dt><dd>
								Path to <code class="literal">hieradata</code> override file that configures Puppet hieradata on the director, providing custom configuration to services beyond the <code class="literal">undercloud.conf</code> parameters. If set, the undercloud installation copies this file to the <code class="literal">/etc/puppet/hieradata</code> directory and sets it as the first file in the hierarchy. For more information about using this feature, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html-single/director_installation_and_usage/index#configuring-hieradata-on-the-undercloud">Configuring hieradata on the undercloud</a>.
							</dd><dt><span class="term">inspection_extras</span></dt><dd>
								Defines whether to enable extra hardware collection during the inspection process. This parameter requires the <code class="literal">python-hardware</code> or <code class="literal">python-hardware-detect</code> packages on the introspection image.
							</dd><dt><span class="term">inspection_interface</span></dt><dd>
								The bridge that director uses for node introspection. This is a custom bridge that the director configuration creates. The <code class="literal">LOCAL_INTERFACE</code> attaches to this bridge. Leave this as the default <code class="literal">br-ctlplane</code>.
							</dd><dt><span class="term">inspection_runbench</span></dt><dd>
								Runs a set of benchmarks during node introspection. Set this parameter to <code class="literal">true</code> to enable the benchmarks. This option is necessary if you intend to perform benchmark analysis when inspecting the hardware of registered nodes.
							</dd><dt><span class="term">ipa_otp</span></dt><dd>
								Defines the one-time password to register the undercloud node to an IPA server. This is required when <code class="literal">enable_novajoin</code> is enabled.
							</dd><dt><span class="term">ipv6_address_mode</span></dt><dd><p class="simpara">
								IPv6 address configuration mode for the undercloud provisioning network. The following list contains the possible values for this parameter:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										dhcpv6-stateless - Address configuration using router advertisement (RA) and optional information using DHCPv6.
									</li><li class="listitem">
										dhcpv6-stateful - Address configuration and optional information using DHCPv6.
									</li></ul></div></dd><dt><span class="term">ipxe_enabled</span></dt><dd>
								Defines whether to use iPXE or standard PXE. The default is <code class="literal">true</code>, which enables iPXE. Set this parameter to <code class="literal">false</code> to use standard PXE.
							</dd><dt><span class="term">local_interface</span></dt><dd><p class="simpara">
								The chosen interface for the director Provisioning NIC. This is also the device that director uses for DHCP and PXE boot services. Change this value to your chosen device. To see which device is connected, use the <code class="literal">ip addr</code> command. For example, this is the result of an <code class="literal">ip addr</code> command:
							</p><pre class="screen">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    link/ether 52:54:00:75:24:09 brd ff:ff:ff:ff:ff:ff
    inet 192.168.122.178/24 brd 192.168.122.255 scope global dynamic eth0
       valid_lft 3462sec preferred_lft 3462sec
    inet6 fe80::5054:ff:fe75:2409/64 scope link
       valid_lft forever preferred_lft forever
3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noop state DOWN
    link/ether 42:0b:c2:a5:c1:26 brd ff:ff:ff:ff:ff:ff</pre><p class="simpara">
								In this example, the External NIC uses <code class="literal">eth0</code> and the Provisioning NIC uses <code class="literal">eth1</code>, which is currently not configured. In this case, set the <code class="literal">local_interface</code> to <code class="literal">eth1</code>. The configuration script attaches this interface to a custom bridge defined with the <code class="literal">inspection_interface</code> parameter.
							</p></dd><dt><span class="term">local_ip</span></dt><dd>
								The IP address defined for the director Provisioning NIC. This is also the IP address that director uses for DHCP and PXE boot services. Leave this value as the default <code class="literal">192.168.24.1/24</code> unless you use a different subnet for the Provisioning network, for example, if this IP address conflicts with an existing IP address or subnet in your environment.
							</dd><dt><span class="term">local_mtu</span></dt><dd>
								The maximum transmission unit (MTU) that you want to use for the <code class="literal">local_interface</code>. Do not exceed 1500 for the undercloud.
							</dd><dt><span class="term">local_subnet</span></dt><dd>
								The local subnet that you want to use for PXE boot and DHCP interfaces. The <code class="literal">local_ip</code> address should reside in this subnet. The default is <code class="literal">ctlplane-subnet</code>.
							</dd><dt><span class="term">net_config_override</span></dt><dd>
								Path to network configuration override template. If you set this parameter, the undercloud uses a JSON format template to configure the networking with <code class="literal">os-net-config</code> and ignores the network parameters set in <code class="literal">undercloud.conf</code>. Use this parameter when you want to configure bonding or add an option to the interface. See <code class="literal">/usr/share/instack-undercloud/templates/net-config.json.template</code> for an example.
							</dd><dt><span class="term">networks_file</span></dt><dd>
								Networks file to override for <code class="literal">heat</code>.
							</dd><dt><span class="term">output_dir</span></dt><dd>
								Directory to output state, processed heat templates, and Ansible deployment files.
							</dd><dt><span class="term">overcloud_domain_name</span></dt><dd><p class="simpara">
								The DNS domain name that you want to use when you deploy the overcloud.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									When you configure the overcloud, you must set the <code class="literal">CloudDomain</code> parameter to a matching value. Set this parameter in an environment file when you configure your overcloud.
								</p></div></div></dd><dt><span class="term">roles_file</span></dt><dd>
								The roles file that you want to use to override the default roles file for undercloud installation. It is highly recommended to leave this parameter unset so that the director installation uses the default roles file.
							</dd><dt><span class="term">scheduler_max_attempts</span></dt><dd>
								The maximum number of times that the scheduler attempts to deploy an instance. This value must be greater or equal to the number of bare metal nodes that you expect to deploy at once to avoid potential race conditions when scheduling.
							</dd><dt><span class="term">service_principal</span></dt><dd>
								The Kerberos principal for the service using the certificate. Use this parameter only if your CA requires a Kerberos principal, such as in FreeIPA.
							</dd><dt><span class="term">subnets</span></dt><dd>
								List of routed network subnets for provisioning and introspection. The default value includes only the <code class="literal">ctlplane-subnet</code> subnet. For more information, see <a class="xref" href="index.html#director-configuration-parameters_subnets" title="Subnets">Subnets</a>.
							</dd><dt><span class="term">templates</span></dt><dd>
								Heat templates file to override.
							</dd><dt><span class="term">undercloud_admin_host</span></dt><dd>
								The IP address or hostname defined for director Admin API endpoints over SSL/TLS. The director configuration attaches the IP address to the director software bridge as a routed IP address, which uses the <code class="literal">/32</code> netmask.
							</dd><dt><span class="term">undercloud_debug</span></dt><dd>
								Sets the log level of undercloud services to <code class="literal">DEBUG</code>. Set this value to <code class="literal">true</code> to enable <code class="literal">DEBUG</code> log level.
							</dd><dt><span class="term">undercloud_enable_selinux</span></dt><dd>
								Enable or disable SELinux during the deployment. It is highly recommended to leave this value set to <code class="literal">true</code> unless you are debugging an issue.
							</dd><dt><span class="term">undercloud_hostname</span></dt><dd>
								Defines the fully qualified host name for the undercloud. If set, the undercloud installation configures all system host name settings. If left unset, the undercloud uses the current host name, but you must configure all system host name settings appropriately.
							</dd><dt><span class="term">undercloud_log_file</span></dt><dd>
								The path to a log file to store the undercloud install and upgrade logs. By default, the log file is <code class="literal">install-undercloud.log</code> in the home directory. For example, <code class="literal">/home/stack/install-undercloud.log</code>.
							</dd><dt><span class="term">undercloud_nameservers</span></dt><dd>
								A list of DNS nameservers to use for the undercloud hostname resolution.
							</dd><dt><span class="term">undercloud_ntp_servers</span></dt><dd>
								A list of network time protocol servers to help synchronize the undercloud date and time.
							</dd><dt><span class="term">undercloud_public_host</span></dt><dd>
								The IP address or hostname defined for director Public API endpoints over SSL/TLS. The director configuration attaches the IP address to the director software bridge as a routed IP address, which uses the <code class="literal">/32</code> netmask.
							</dd><dt><span class="term">undercloud_service_certificate</span></dt><dd>
								The location and filename of the certificate for OpenStack SSL/TLS communication. Ideally, you obtain this certificate from a trusted certificate authority. Otherwise, generate your own self-signed certificate.
							</dd><dt><span class="term">undercloud_timezone</span></dt><dd>
								Host timezone for the undercloud. If you do not specify a timezone, director uses the existing timezone configuration.
							</dd><dt><span class="term">undercloud_update_packages</span></dt><dd>
								Defines whether to update packages during the undercloud installation.
							</dd></dl></div><div id="director-configuration-parameters_subnets" class="formalpara"><p class="title"><strong>Subnets</strong></p><p>
						Each provisioning subnet is a named section in the <code class="literal">undercloud.conf</code> file. For example, to create a subnet called <code class="literal">ctlplane-subnet</code>, use the following sample in your <code class="literal">undercloud.conf</code> file:
					</p></div><pre class="screen">[ctlplane-subnet]
cidr = 192.168.24.0/24
dhcp_start = 192.168.24.5
dhcp_end = 192.168.24.24
inspection_iprange = 192.168.24.100,192.168.24.120
gateway = 192.168.24.1
masquerade = true</pre><p>
					You can specify as many provisioning networks as necessary to suit your environment.
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">cidr</span></dt><dd>
								The network that director uses to manage overcloud instances. This is the Provisioning network, which the undercloud <code class="literal">neutron</code> service manages. Leave this as the default <code class="literal">192.168.24.0/24</code> unless you use a different subnet for the Provisioning network.
							</dd><dt><span class="term">masquerade</span></dt><dd><p class="simpara">
								Defines whether to masquerade the network defined in the <code class="literal">cidr</code> for external access. This provides the Provisioning network with a degree of network address translation (NAT) so that the Provisioning network has external access through director.
							</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
									The director configuration also enables IP forwarding automatically using the relevant <code class="literal">sysctl</code> kernel parameter.
								</p></div></div></dd><dt><span class="term">dhcp_start; dhcp_end</span></dt><dd>
								The start and end of the DHCP allocation range for overcloud nodes. Ensure that this range contains enough IP addresses to allocate your nodes.
							</dd><dt><span class="term">dhcp_exclude</span></dt><dd>
								IP addresses to exclude in the DHCP allocation range.
							</dd><dt><span class="term">dns_nameservers</span></dt><dd>
								DNS nameservers specific to the subnet. If no nameservers are defined for the subnet, the subnet uses nameservers defined in the <code class="literal">undercloud_nameservers</code> parameter.
							</dd><dt><span class="term">gateway</span></dt><dd>
								The gateway for the overcloud instances. This is the undercloud host, which forwards traffic to the External network. Leave this as the default <code class="literal">192.168.24.1</code> unless you use a different IP address for director or want to use an external gateway directly.
							</dd><dt><span class="term">host_routes</span></dt><dd>
								Host routes for the Neutron-managed subnet for the overcloud instances on this network. This also configures the host routes for the <code class="literal">local_subnet</code> on the undercloud.
							</dd><dt><span class="term">inspection_iprange</span></dt><dd>
								Temporary IP range for nodes on this network to use during the inspection process. This range must not overlap with the range defined by <code class="literal">dhcp_start</code> and <code class="literal">dhcp_end</code> but must be in the same IP subnet.
							</dd></dl></div></section><section class="section" id="running-the-director-upgrade"><div class="titlepage"><div><div><h2 class="title">6.10. Running the director upgrade</h2></div></div></div><p>
					Complete the following steps to upgrade the director.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Run the following command to upgrade the director on the undercloud:
						</p><pre class="screen">$ openstack undercloud upgrade</pre><p class="simpara">
							This command launches the director configuration script. The director upgrades its packages and configures its services to suit the settings in the <code class="literal">undercloud.conf</code>. This script takes several minutes to complete.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								The director configuration script prompts for confirmation before proceeding. Bypass this confirmation using the <code class="literal">-y</code> option:
							</p><pre class="screen">$ openstack undercloud upgrade -y</pre></div></div></li><li class="listitem"><p class="simpara">
							The script also starts all OpenStack Platform service containers on the undercloud automatically. You manage each service through a <code class="literal">systemd</code> resource. Check the <code class="literal">systemd</code> resources:
						</p><pre class="screen">$ sudo systemctl list-units "tripleo_*"</pre><p class="simpara">
							Each <code class="literal">systemd</code> service controls a container. Check the enabled containers using the following command:
						</p><pre class="screen">$ sudo podman ps</pre></li><li class="listitem"><p class="simpara">
							The script adds the <code class="literal">stack</code> user to the <code class="literal">docker</code> group to ensure that the <code class="literal">stack</code> user has access to container management commands. Refresh the <code class="literal">stack</code> user permissions with the following command:
						</p><pre class="screen">$ exec su -l stack</pre><p class="simpara">
							The command prompts you to log in again. Enter the stack user password.
						</p></li><li class="listitem"><p class="simpara">
							To initialize the <code class="literal">stack</code> user to use the command line tools, run the following command:
						</p><pre class="screen">$ source ~/stackrc</pre><p class="simpara">
							The prompt now indicates OpenStack commands authenticate and execute against the undercloud;
						</p><pre class="screen">(undercloud) $</pre></li></ol></div><p>
					The director upgrade is complete.
				</p></section></section></div><div class="part" id="preparing_for_overcloud_upgrade"><div class="titlepage"><div><div><h1 class="title">Part II. Preparing for overcloud upgrade</h1></div></div></div><section class="chapter" id="initial-steps-for-overcloud-preparation"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Initial steps for overcloud preparation</h2></div></div></div><p>
				You must complete some initial steps to prepare for the overcloud upgrade.
			</p><section class="section" id="preparing_for_overcloud_service_downtime"><div class="titlepage"><div><div><h2 class="title">7.1. Preparing for overcloud service downtime</h2></div></div></div><p>
					The overcloud upgrade process disables the main services at key points. This means you cannot use any overcloud services to create new resources during the upgrade duration. Workloads running in the overcloud remain active during this period, which means instances continue to run through the upgrade duration.
				</p><p>
					It is important to plan a maintenance window to ensure no users can access the overcloud services during the upgrade duration.
				</p><div class="itemizedlist"><p class="title"><strong>Affected by overcloud upgrade</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							OpenStack Platform services
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Unaffected by overcloud upgrade</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							Instances running during the upgrade
						</li><li class="listitem">
							Ceph Storage OSDs (backend storage for instances)
						</li><li class="listitem">
							Linux networking
						</li><li class="listitem">
							Open vSwitch networking
						</li><li class="listitem">
							Undercloud
						</li></ul></div></section><section class="section" id="selecting_compute_nodes_for_upgrade_testing"><div class="titlepage"><div><div><h2 class="title">7.2. Selecting Compute nodes for upgrade testing</h2></div></div></div><p>
					The overcloud upgrade process allows you to either:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Upgrade all nodes in a role
						</li><li class="listitem">
							Individual nodes separately
						</li></ul></div><p>
					To ensure a smooth overcloud upgrade process, it is useful to test the upgrade on a few individual Compute nodes in your environment before upgrading all Compute nodes. This ensures no major issues occur during the upgrade while maintaining minimal downtime to your workloads.
				</p><p>
					Use the following recommendations to help choose test nodes for the upgrade:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Select two or three Compute nodes for upgrade testing
						</li><li class="listitem">
							Select nodes without any critical instances running
						</li><li class="listitem">
							If necessary, migrate critical instances from the selected test Compute nodes to other Compute nodes
						</li></ul></div></section><section class="section" id="validating-the-pre-upgrade-requirements"><div class="titlepage"><div><div><h2 class="title">7.3. Validating the pre-upgrade requirements</h2></div></div></div><p>
					Run the <span class="literal literal">pre-upgrade</span> validation group to check the pre-upgrade requirements.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">openstack tripleo validator run</code> command with the <span class="literal literal">--group pre-upgrade</span> option:
						</p><pre class="screen">$ openstack tripleo validator run --group pre-upgrade</pre></li><li class="listitem"><p class="simpara">
							Review the results of the validation report. To view detailed output from a specific validation, run the <code class="literal">openstack tripleo validator show run</code> command against the UUID of the specific validation from the report:
						</p><pre class="screen">$ openstack tripleo validator show run &lt;UUID&gt;</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						A <code class="literal">FAILED</code> validation does not prevent you from deploying or running Red Hat OpenStack Platform. However, a <code class="literal">FAILED</code> validation can indicate a potential issue with a production environment.
					</p></div></div></section><section class="section" id="disabling-fencing-in-the-overcloud-initial-steps"><div class="titlepage"><div><div><h2 class="title">7.4. Disabling fencing in the overcloud</h2></div></div></div><p>
					When you upgrade the overcloud, you upgrade each Controller node individually to retain high availability functionality. During this period, the overcloud might detect certain nodes as disabled and attempt fencing operations, which can cause unintended behaviour.
				</p><p>
					If you have enabled fencing in the overcloud, you must temporarily disable fencing for the duration of the upgrade to avoid any unintended behaviour.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you use an environment file to enable fencing in your overcloud, the director re-enables fencing during the re-creation of the Controller node cluster.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Log in to a Controller node and run the Pacemaker command to disable fencing:
						</p><pre class="screen">$ ssh heat-admin@<span class="emphasis"><em>CONTROLLER_IP</em></span> "sudo pcs property set stonith-enabled=false"</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional Resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/high_availability_deployment_and_usage/assembly_fencing">"Fencing Controller nodes with STONITH"</a>
						</li></ul></div></section><section class="section" id="creating-an-overcloud-inventory-file-initial-steps"><div class="titlepage"><div><div><h2 class="title">7.5. Creating an overcloud inventory file</h2></div></div></div><p>
					Generate an Ansible inventory file of all nodes in your environment with the <code class="literal">tripleo-ansible-inventory</code> command.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Create a static inventory file of all nodes:
						</p><pre class="screen">$ tripleo-ansible-inventory --static-yaml-inventory ~/inventory.yaml --stack <span class="emphasis"><em>STACK_NAME</em></span></pre><p class="simpara">
							If you are not using the default <code class="literal">overcloud</code> stack name, set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
						</p></li><li class="listitem"><p class="simpara">
							To execute Ansible playbooks on your environment, run the <code class="literal">ansible-playbook</code> command and include the full path of the dynamic inventory tool using the <code class="literal">-i</code> option. For example:
						</p><pre class="screen">(undercloud) $ ansible-playbook -i ~/inventory.yaml <span class="emphasis"><em>PLAYBOOK</em></span></pre></li></ol></div></section></section><section class="chapter" id="configuring-the-overcloud-for-a-leapp-upgrade"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Configuring the overcloud for a Leapp upgrade</h2></div></div></div><p>
				You must complete some Leapp configuration to prepare for the overcloud upgrade.
			</p><section class="section" id="creating-an-upgrades-environment-file-overcloud-leapp"><div class="titlepage"><div><div><h2 class="title">8.1. Creating an upgrades environment file</h2></div></div></div><p>
					The upgrade process uses an environment file to enable the upgrade process and configure specific upgrade parameters.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Create an environment file called <code class="literal">upgrades-environment.yaml</code> in your <code class="literal">templates</code> directory:
						</p><pre class="screen">$ touch templates/upgrades-environment.yaml</pre></li><li class="listitem"><p class="simpara">
							Edit the file and add the following mandatory content:
						</p><pre class="screen">parameter_defaults:
  UpgradeInitCommand: |
    sudo dnf module disable -y container-tools:rhel8
    sudo dnf module enable -y container-tools:2.0
    sudo dnf module disable -y virt:rhel
    sudo dnf module enable -y virt:8.2
  UpgradeLeappCommandOptions: "--enablerepo rhel-8-for-x86_64-baseos-eus-rpms --enablerepo rhel-8-for-x86_64-appstream-eus-rpms --enablerepo fast-datapath-for-rhel-8-x86_64-rpms"</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">UpgradeInitCommand</code> sets a series of bash commands to run that director runs before starting the upgrade on a node. In this context, set this parameter to use the <code class="literal">dnf</code> commands to switch from the default <code class="literal">container-tools:rhel8</code> module to <code class="literal">container-tools:2.0</code>.
								</li><li class="listitem">
									<code class="literal">UpgradeLeappCommandOptions</code> sets additional options to pass to the Leapp tool. In this context, set this parameter to enable Red Hat OpenStack Platform repositories to help with the Leapp transition.
								</li></ul></div></li><li class="listitem">
							Save the <code class="literal">upgrades-environment.yaml</code> file.
						</li></ol></div></section><section class="section" id="upgrade-parameters"><div class="titlepage"><div><div><h2 class="title">8.2. Upgrade parameters</h2></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983827865424" scope="col">Parameter</th><th align="left" valign="top" id="idm139983827864336" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeInitCommand</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Command or script snippet to run on all overcloud nodes to initialize the upgrade process. For example, a repository switch.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeInitCommonCommand</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Common commands required by the upgrades process. This should not normally be modified by the operator and is set and unset in the major-upgrade-composable-steps.yaml and major-upgrade-converge.yaml environment files.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappCommandOptions</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Additional command line options to append to the Leapp command.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappDebug</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Print debugging output when running Leapp. The default value is <code class="literal">True</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappDevelSkip</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Skip Leapp checks by setting env variables when running Leapp in development/testing. For example, LEAPP_DEVEL_SKIP_RHSM=1.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappEnabled</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Use Leapp for operating system upgrade. The default value is <code class="literal">False</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappRebootTimeout</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									Timeout (seconds) for the OS upgrade phase via Leapp. The default value is <code class="literal">3600</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappToInstall</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									List of packages to install after Leapp upgrade.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983827865424"> <p>
									<code class="literal">UpgradeLeappToRemove</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983827864336"> <p>
									List of packages to remove during Leapp upgrade.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="copying-the-leapp-data-to-the-overcloud-nodes"><div class="titlepage"><div><div><h2 class="title">8.3. Copying the Leapp data to the overcloud nodes</h2></div></div></div><p>
					Each overcloud node requires the Leapp data files. The director automatically copies the data files in the <code class="literal">/etc/leapp/files</code> directory on the undercloud to the same location on each overcloud. Check that the <code class="literal">pes-events.json</code> and <code class="literal">repomap.csv</code> files still exist in the <code class="literal">/etc/leapp/files</code> directory of the undercloud:
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Check the <code class="literal">/etc/leapp/files</code> directory on the undercloud:
						</p><pre class="screen">$ sudo ls /etc/leapp/files/</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						If these files were removed, download these files attached to the Knowledge Base article <a class="link" href="https://access.redhat.com/articles/3664871">"Data required by the Leapp utility for an in-place upgrade from RHEL 7 to RHEL 8"</a> and place these files in the <code class="literal">/etc/leapp/files/</code> directory on the undercloud.
					</p></div></div></section><section class="section" id="using-predictable-nic-names-overcloud-leapp"><div class="titlepage"><div><div><h2 class="title">8.4. Using predictable NIC names for overcloud nodes</h2></div></div></div><p>
					Before you run the Leapp upgrade on overcloud nodes, you must check for kernel-based NIC names, which usually contain a <code class="literal">eth</code> prefix. These NIC names are usually unpredictable in terms of NIC assignments. The Leapp upgrade fails if any NICs on the node use the <code class="literal">eth</code> prefix.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The <code class="literal">playbook-nics.yaml</code> playbook created during the undercloud preparation process. The <code class="literal">playbook-nics.yaml</code> playbook accommodates most overcloud networking scenarios that use Ethernet devices, bridges, and Linux bonds. If your environment requires additional configuration beyond these device types, follow these recommendations before proceeding:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Test the playbook on a separate system with a similar networking configuration to your overcloud nodes
								</li><li class="listitem">
									Modify the playbook to accommodate renaming the <code class="literal">eth</code> prefix within the configuration of other device types
								</li><li class="listitem">
									Check the networking configuration of your overcloud nodes after you complete this procedure
								</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Run the <code class="literal">playbook-nics.yaml</code> playbook on all overcloud nodes:
						</p><pre class="screen">$ ansible-playbook -i ~/inventory.yaml playbook-nics.yaml</pre><p class="simpara">
							The playbook sets the new NIC prefix to <code class="literal">em</code>. To set a different NIC prefix, set the <code class="literal">prefix</code> variable when running the playbook:
						</p><pre class="screen">$ ansible-playbook -i ~/inventory.yaml -e prefix="mynic" playbook-nics.yaml</pre></li><li class="listitem">
							Reboot overcloud nodes using the standard reboot procedures. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/director_installation_and_usage/sect-rebooting_the_overcloud">"Rebooting nodes"</a>.
						</li></ol></div><div class="itemizedlist"><p class="title"><strong>Resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/solutions/4067471">"How to perform an in-place upgrade to RHEL 8 when using kernel NIC names on RHEL 7"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/ch-consistent_network_device_naming#sec-Naming_Schemes_Hierarchy">"Consistent Network Device Naming"</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/sec-understanding_the_predictable_network_interface_device_names">"Understanding the Predictable Network Interface Device Names"</a>
						</li></ul></div></section><section class="section" id="setting-the-ssh-root-permission-parameter-on-the-overcloud-overcloud-leapp"><div class="titlepage"><div><div><h2 class="title">8.5. Setting the SSH root permission parameter on the overcloud</h2></div></div></div><p>
					The Leapp upgrade checks whether the <code class="literal">PermitRootLogin</code> parameter exists in the <code class="literal">/etc/ssh/sshd_config</code> file on each node. You must explicitly set this parameter to either <code class="literal">yes</code> or <code class="literal">no</code>.
				</p><p>
					For security purposes, set this parameter to <code class="literal">no</code> to disable SSH access to the root user on overcloud nodes.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							An Ansible inventory file for your overcloud nodes.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Create a file called <code class="literal">playbook-ssh.yaml</code> and paste the following content in the file:
						</p><pre class="screen">---
- name: Configure SSH PermitRootLogin parameter
  hosts: overcloud
  become: yes
  tasks:
    - name: Set the PermitRootLogin parameter to no
      lineinfile:
        path: /etc/ssh/sshd_config
        state: present
        line: "PermitRootLogin no"</pre></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="screen">$ ansible-playbook -i ~/inventory.yaml playbook-ssh.yaml</pre></li></ol></div></section></section><section class="chapter" id="updating-composable-services-and-parameters"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Updating composable services and parameters</h2></div></div></div><p>
				You must complete some composable service configuration to prepare for the overcloud upgrade.
			</p><section class="section" id="updating-composable-services-in-custom-roles_data-files-composable-services"><div class="titlepage"><div><div><h2 class="title">9.1. Updating composable services in custom roles_data files</h2></div></div></div><p>
					This section contains information about new and deprecated composable services.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							If you use the default <code class="literal">roles_data</code> file, these services are included automatically.
						</li><li class="listitem">
							If you use a custom <code class="literal">roles_data</code> file, add the new services and remove the deprecated services for each relevant role.
						</li></ul></div><div class="formalpara"><p class="title"><strong>Controller Nodes</strong></p><p>
						The following services have been deprecated for Controller nodes. Remove them from your Controller role.
					</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983830471088" scope="col">Service</th><th align="left" valign="top" id="idm139983831474384" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::AodhApi</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::AodhEvaluator</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::AodhListener</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::AodhNotifier</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::CeilometerApi</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::CeilometerCollector</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::CeilometerExpirer</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::MongoDb</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::PankoApi</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									OpenStack Platform no longer includes OpenStack Telemetry services and now uses Service Telemetry Framework (STF) for metrics and monitoring.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::Congress</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									Congress is no longer supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::GlanceRegistry</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									This service is no longer supported due to OpenStack Platform Image Service (glance) API v2.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::NeutronCorePluginPlumgrid</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::NeutronCorePluginMidonet</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									Deprecated plug-ins for OpenStack Networking (neutron).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::NeutronLbaasv2Agent</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::NeutronLbaasv2Api</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									OpenStack Networking (neutron) Load Balancing as a Service deprecated in favour of Octavia.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::NovaConsoleauth</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									This service is now deprecated.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::NovaPlacement</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									Deprecated in favor of <code class="literal">OS::TripleO::Services::PlacementApi</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::OpenDaylightApi</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::OpenDaylightOvs</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									OpenDaylight is no longer supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::RabbitMQ</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									This service has been substituted for two new services:
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::OsloMessagingRpc</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::OsloMessagingNotify</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::SkydiveAgent</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::SkydiveAnalyzer</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									Skydive is no longer supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830471088"> <p>
									<code class="literal">OS::TripleO::Services::Tacker</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831474384"> <p>
									Tacker is no longer supported.
								</p>
								 </td></tr></tbody></table></div><p>
					The following services are new for Controller nodes. Add them to your Controller role.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983828352224" scope="col">Service</th><th align="left" valign="top" id="idm139983828351136" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::CephGrafana</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Tasks to enable Ceph Dashboard service.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::CinderBackendDellEMCPowermax</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::CinderBackendDellEMCSc</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::CinderBackendNVMeOF</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									New backends for Block Storage (cinder).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::ContainerImagePrepare</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Run the commands to automatically pull and prepare container images relevant to the services in your overcloud.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::DesignateApi</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::DesignateCentral</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::DesignateProducer</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::DesignateWorker</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::DesignateMDNS</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::DesignateSink</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Services for DNS-as-a-Service (designate).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::IronicInspector</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Service for Bare Metal Introspection for the overcloud.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::IronicNeutronAgent</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									The networking agent for OpenStack Bare Metal (ironic).
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::NeutronAgentsIBConfig</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Service for OpenStack Networking (neutron) agent for Mellanox InfiniBand.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::OpenStackClients</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Service for installing the Red Hat OpenStack Platform command line tools.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::OsloMessagingRpc</code>
								</p>
								 <p>
									<code class="literal">OS::TripleO::Services::OsloMessagingNotify</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Replacement services for the <code class="literal">OS::TripleO::Services::RabbitMQ</code> service.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828352224"> <p>
									<code class="literal">OS::TripleO::Services::PlacementApi</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828351136"> <p>
									Service for the Placement API.
								</p>
								 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>Compute Nodes</strong></p><p>
						The following services have been deprecated for Compute nodes. Remove them from your Compute role.
					</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983833360912" scope="col">Service</th><th align="left" valign="top" id="idm139983833359824" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983833360912"> <p>
									<code class="literal">OS::TripleO::Services::OpenDaylightOvs</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983833359824"> <p>
									OpenDaylight is no longer supported.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983833360912"> <p>
									<code class="literal">OS::TripleO::Services::SkydiveAgent</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983833359824"> <p>
									Skydive is no longer supported.
								</p>
								 </td></tr></tbody></table></div><p>
					The following services are new for Compute nodes. Add them to your Compute role.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983857946016" scope="col">Service</th><th align="left" valign="top" id="idm139983857944928" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983857946016"> <p>
									<code class="literal">OS::TripleO::Services::NovaAZConfig</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983857944928"> <p>
									Service to configure host aggregate and availability zone in OpenStack Compute (nova).
								</p>
								 </td></tr></tbody></table></div><div class="formalpara"><p class="title"><strong>All Nodes</strong></p><p>
						The following services have been deprecated for all nodes. Remove them from all roles.
					</p></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983831937312" scope="col">Service</th><th align="left" valign="top" id="idm139983831936224" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983831937312"> <p>
									<code class="literal">OS::TripleO::Services::Docker</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831936224"> <p>
									Replaced with Podman.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831937312"> <p>
									<code class="literal">OS::TripleO::Services::Fluentd</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831936224"> <p>
									Deprecated in favour of <code class="literal">OS::TripleO::Services::Rsyslog</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831937312"> <p>
									<code class="literal">OS::TripleO::Services::Ntp</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831936224"> <p>
									Deprecated in favour of <code class="literal">OS::TripleO::Services::Timesync</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831937312"> <p>
									<code class="literal">OS::TripleO::Services::SensuClient</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831936224"> <p>
									Deprecated service.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831937312"> <p>
									<code class="literal">OS::TripleO::Services::Ptp</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831936224"> <p>
									Deprecated in favour of <code class="literal">OS::TripleO::Services::Timesync</code>.
								</p>
								 </td></tr></tbody></table></div><p>
					The following services are new for all nodes. Add them to all roles.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983832063536" scope="col">Service</th><th align="left" valign="top" id="idm139983832062448" scope="col">Reason</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::BootParams</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to set Kernel arguments, Tuned profiles, and CPU isolation.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Collectd</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to configure Collectd.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Multipathd</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Provides a Multipathd service, which is disabled by default
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Podman</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to install and enable Podman.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Rear</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to install and enable Relax-and-Recover (ReaR) backup and restore tools.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Rsyslog</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to configure centralized log collection.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832063536"> <p>
									<code class="literal">OS::TripleO::Services::Timesync</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832062448"> <p>
									Service to enable time synchronization method, which is Chronyd by default.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="updating-composable-services-in-custom-environment-files-composable-services"><div class="titlepage"><div><div><h2 class="title">9.2. Updating composable services in custom environment files</h2></div></div></div><p>
					If you have any custom environment files with <code class="literal">resource_registry</code> sections, check the <code class="literal">resource_registry</code> sections for changes in composable service template mappings. The composable service files for Red Hat OpenStack Platform 16.1 reside in a new location within <code class="literal">/usr/share/openstack-tripleo-heat-templates/</code>:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983828555072" scope="col">Red Hat OpenStack Platform 13</th><th align="left" valign="top" id="idm139983828553968" scope="col">Red Hat OpenStack Platform 16.1</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983828555072"> <p>
									<code class="literal">docker/services/</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828553968"> <p>
									<code class="literal">deployment</code>
								</p>
								 </td></tr></tbody></table></div><p>
					The <code class="literal">deployment</code> directory contains a set of sub-directories to group composable services. For example, the <code class="literal">keystone</code> sub-directory contains composable service templates for OpenStack Identity (keystone).
				</p><p>
					To remap composable services in custom environment files, check the template location for the current service mapping and edit the mapping to the new location. This procedure uses <code class="literal">ceph-mgr.yaml</code> as an example.
				</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						This procedure acts as guidance only for remapping composable services. If you are unsure of any mapping, contact <a class="link" href="https://access.redhat.com/support">Red Hat</a> and request advice on the correct mapping.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Search for custom environment files that use composable services. You usually store custom environment files in the <code class="literal">/home/stack/templates</code> directory:
						</p><pre class="screen">$ cd ~/templates/
$ grep "OS::TripleO::Services" *</pre><p class="simpara">
							In this scenario, one of the files shows an outdated mapping:
						</p><pre class="screen">  OS::TripleO::Services::CephMgr: /usr/share/openstack-tripleo-heat-templates/docker/services/ceph-ansible/ceph-mgr.yaml</pre></li><li class="listitem"><p class="simpara">
							Identify the new <code class="literal">ceph-mgr.yaml</code> location in <code class="literal">/usr/share/openstack-tripleo-heat-templates/</code>. This file is now located in the `deployment/ceph-ansible' directory:
						</p><pre class="screen">$ find /usr/share/openstack-tripleo-heat-templates/ -name ceph-mgr.yaml
/usr/share/openstack-tripleo-heat-templates/deployment/ceph-ansible/ceph-mgr.yaml</pre></li><li class="listitem"><p class="simpara">
							Edit the service in the custom environment file:
						</p><pre class="screen">resource_registry:
  OS::TripleO::Services::CephMgr: /usr/share/openstack-tripleo-heat-templates/deployment/ceph-ansible/ceph-mgr.yaml</pre><p class="simpara">
							Save the file.
						</p></li></ol></div></section><section class="section" id="configuring-access-to-the-undercloud-registry-composable-services"><div class="titlepage"><div><div><h2 class="title">9.3. Configuring access to the undercloud registry</h2></div></div></div><p>
					Add the control plane host name of the undercloud to the <code class="literal">DockerInsecureRegistryAddress</code> parameter. Place this parameter in the <code class="literal">containers-prepare-parameter.yaml</code> file to ensure that the parameter is included in future overcloud deployments.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Obtain the control plane host name on the undercloud:
						</p><pre class="screen">$ sudo hiera container_image_prepare_node_names
["undercloud.ctlplane.localdomain"]</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">containers-prepare-parameter.yaml</code> file and add the <code class="literal">DockerInsecureRegistryAddress</code> parameter with a YAML list that contains the undercloud control plane host name:
						</p><pre class="screen">parameter_defaults:
  DockerInsecureRegistryAddress:
  - undercloud.ctlplane.localdomain:8787
  ...</pre><p class="simpara">
							You must also append the port number of the overcloud registry to the host name value. The port number is <code class="literal">8787</code>.
						</p></li></ol></div></section><section class="section" id="deprecated-and-removed-filters-for-the-novaschedulerdefaultfilters-parameter-composable-services"><div class="titlepage"><div><div><h2 class="title">9.4. Deprecated and removed filters for the NovaSchedulerDefaultFilters parameter</h2></div></div></div><p>
					If your environment uses a custom <code class="literal">NovaSchedulerDefaultFilters</code> parameter, edit the parameter to remove the following deprecated and removed filters:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983836572208" scope="col">Filter</th><th align="left" valign="top" id="idm139983836571120" scope="col">Status</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">AggregateCoreFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Deprecated
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">AggregateRamFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Deprecated
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">AggregateDiskFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Deprecated
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">ExactCoreFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">ExactRamFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">ExactDiskFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">CoreFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">RamFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">DiskFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Removed
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983836572208"> <p>
									<code class="literal">RetryFilter</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983836571120"> <p>
									Deprecated
								</p>
								 </td></tr></tbody></table></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						Avoid using filters marked <span class="strong strong"><strong>Deprecated</strong></span>. Red Hat OpenStack Platform 16.1 still includes deprecated filters but future versions of Red Hat OpenStack Platform will not include these filters.
					</p></div></div></section><section class="section" id="setting-the-compute-name-format-composable-services"><div class="titlepage"><div><div><h2 class="title">9.5. Setting the Compute name format</h2></div></div></div><p>
					Red Hat OpenStack Platform 13 uses <code class="literal">%stackname%-compute-%index%</code> as the default naming format for Compute nodes. Red Hat OpenStack Platform 16.1 uses <code class="literal">%stackname%-novacompute-%index%</code> as the default naming format for Compute nodes. Change the default naming format to retain the original Red Hat OpenStack Platform 13 naming format. If you do not use the original naming format, director configures new OpenStack Compute (nova) agents with the new naming format and keeps the existing OpenStack Compute (nova) agents with the old naming format as orphaned services.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Set the Compute naming format:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									If you use a custom <code class="literal">roles_data</code> file, edit the custom <code class="literal">roles_data</code> file and set the <code class="literal">HostnameFormatDefault</code> parameter for the <code class="literal">Compute</code> role:
								</p><pre class="screen">- name: Compute
  …​
  HostnameFormatDefault: <span class="strong strong"><strong>'%stackname%-compute-%index%'</strong></span>
  …​</pre><p class="simpara">
									Save the custom <code class="literal">roles_data</code> file.
								</p></li><li class="listitem"><p class="simpara">
									If you use the default <code class="literal">roles_data</code> file in <code class="literal">openstack-tripleo-heat-templates</code>, set the naming format in an environment file. Edit the environment file with your node counts and flavors, which is usually named <code class="literal">node-info.yaml</code>. Add the <code class="literal">ComputeHostnameFormat</code> parameter to the <code class="literal">parameter_defaults</code> section:
								</p><pre class="screen">parameter_defaults:
  …​
  ComputeHostnameFormat: <span class="strong strong"><strong>'%stackname%-compute-%index%'</strong></span>
  …​</pre><p class="simpara">
									Save the <code class="literal">node-info.yaml</code> file.
								</p></li></ul></div></li></ol></div></section><section class="section" id="updating-your-tls-ssl-configuration"><div class="titlepage"><div><div><h2 class="title">9.6. Updating your SSL/TLS configuration</h2></div></div></div><p>
					Remove the <code class="literal">NodeTLSData</code> resource from the <code class="literal">resource_registry</code> to update your SSL/TLS configuration.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Edit your custom overcloud SSL/TLS public endpoint file, which is usually named <code class="literal">~/templates/enable-tls.yaml</code>.
						</li><li class="listitem"><p class="simpara">
							Remove the <code class="literal">NodeTLSData</code> resource from the `resource_registry:
						</p><pre class="screen">resource_registry:
  <span class="strong strong"><strong>OS::TripleO::NodeTLSData: /usr/share/openstack-tripleo-heat-templates/puppet/extraconfig/tls/tls-cert-inject.yaml</strong></span>
  …​</pre><p class="simpara">
							The overcloud deployment uses a new service in HAProxy to determine if SSL/TLS is enabled.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								If this is the only resource in the <code class="literal">resource_registry</code> section of the <code class="literal">enable-tls.yaml</code> file, remove the complete <code class="literal">resource_registry</code> section.
							</p></div></div></li><li class="listitem">
							Save the SSL/TLS public endpoint file file.
						</li></ol></div></section><section class="section" id="updating-post-configuration-templates-composable-services"><div class="titlepage"><div><div><h2 class="title">9.7. Updating post configuration templates</h2></div></div></div><p>
					If you use the <code class="literal">OS::TripleO::NodeExtraConfigPost</code> resource to register and run a post-configuration template, you must add the <code class="literal">EndpointMap</code> parameter to the template.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Edit the post-configuration template.
						</li><li class="listitem"><p class="simpara">
							Under the <code class="literal">parameters</code> section, add the <code class="literal">EndpointMap</code> parameter and its sub-parameters:
						</p><pre class="screen">parameters:
  servers:
    type: json
  nameserver_ip:
    type: string
  DeployIdentifier:
    type: string
  <span class="strong strong"><strong>EndpointMap:</strong></span>
    <span class="strong strong"><strong>default: {}</strong></span>
    <span class="strong strong"><strong>type: json</strong></span></pre></li><li class="listitem">
							Save the template.
						</li></ol></div></section></section><section class="chapter" id="updating-overcloud-registration-to-the-red-hat-customer-portal-composable-services"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Updating overcloud registration to the Red Hat Customer Portal</h2></div></div></div><p>
				Red Hat OpenStack Platform 16.1 uses Ansible-based methods to register overcloud nodes to the Red Hat Customer Portal.
			</p><section class="section" id="rhsm-composable-service-portal"><div class="titlepage"><div><div><h2 class="title">10.1. Red Hat Subscription Manager (RHSM) composable service</h2></div></div></div><p>
					The <code class="literal">rhsm</code> composable service provides a method to register overcloud nodes through Ansible. Each role in the default <code class="literal">roles_data</code> file contains a <code class="literal">OS::TripleO::Services::Rhsm</code> resource, which is disabled by default. To enable the service, register the resource to the <code class="literal">rhsm</code> composable service file:
				</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml</pre><p>
					The <code class="literal">rhsm</code> composable service accepts a <code class="literal">RhsmVars</code> parameter, which allows you to define multiple sub-parameters relevant to your registration. For example:
				</p><pre class="screen">parameter_defaults:
  RhsmVars:
    rhsm_repos:
      - rhel-8-for-x86_64-baseos-eus-rpms
      - rhel-8-for-x86_64-appstream-eus-rpms
      - rhel-8-for-x86_64-highavailability-eus-rpms
      …​
    rhsm_username: "myusername"
    rhsm_password: "p@55w0rd!"
    rhsm_org_id: "1234567"
    rhsm_release: 8.2</pre><p>
					You can also use the <code class="literal">RhsmVars</code> parameter in combination with role-specific parameters (e.g. <code class="literal">ControllerParameters</code>) to provide flexibility when enabling specific repositories for different nodes types.
				</p></section><section class="section" id="rhsmvars-parameters-portal"><div class="titlepage"><div><div><h2 class="title">10.2. RhsmVars sub-parameters</h2></div></div></div><p>
					See the <a class="link" href="https://github.com/openstack/ansible-role-redhat-subscription/">role documentation</a> to learn about all Ansible parameters.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 29%; " class="col_1"><!--Empty--></col><col style="width: 71%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983832331712" scope="col"><code class="literal">rhsm</code></th><th align="left" valign="top" id="idm139983832330464" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_method</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									Choose the registration method. Either <code class="literal">portal</code>, <code class="literal">satellite</code>, or <code class="literal">disable</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_org_id</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The organization to use for registration. To locate this ID, run <code class="literal">sudo subscription-manager orgs</code> from the undercloud node. Enter your Red Hat credentials when prompted, and use the resulting <code class="literal">Key</code> value. For more information on your organization ID, see <a class="link" href="https://access.redhat.com/articles/3047431">"Understanding the Red Hat Subscription Management Organization ID "</a>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_pool_ids</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The subscription pool ID to use. Use this if not auto-attaching subscriptions. To locate this ID, run <code class="literal">sudo subscription-manager list --available --all --matches="<span class="strong strong"><strong>OpenStack</strong></span>"</code> from the undercloud node, and use the resulting <code class="literal">Pool ID</code> value.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_activation_key</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The activation key to use for registration. Does not work when <code class="literal">rhsm_repos</code> is configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_autosubscribe</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									Automatically attach compatible subscriptions to this system. Set to <code class="literal">true</code> to enable.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_baseurl</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The base URL for obtaining content. The default is the Red Hat Content Delivery Network URL. If using a Satellite server, change this value to the base URL of your Satellite server content repositories.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_server_hostname</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The hostname of the subscription management service for registration. The default is the Red Hat Subscription Management hostname. If using a Satellite server, change this value to your Satellite server hostname.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_repos</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									A list of repositories to enable. Does not work when <code class="literal">rhsm_activation_key</code> is configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_username</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The username for registration. If possible, use activation keys for registration.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The password for registration. If possible, use activation keys for registration.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_release</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									Red Hat Enterprise Linux release for pinning the repositories. This is set to <code class="literal">8.2</code> for Red Hat OpenStack Platform 16.1.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_rhsm_proxy_hostname</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The hostname for the HTTP proxy. For example: <code class="literal">proxy.example.com</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_rhsm_proxy_port</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The port for HTTP proxy communication. For example: <code class="literal">8080</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_rhsm_proxy_user</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The username to access the HTTP proxy.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983832331712"> <p>
									<code class="literal">rhsm_rhsm_proxy_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983832330464"> <p>
									The password to access the HTTP proxy.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="switching-to-the-rhsm-composable-service-portal"><div class="titlepage"><div><div><h2 class="title">10.3. Switching to the rhsm composable service</h2></div></div></div><p>
					The previous <code class="literal">rhel-registration</code> method runs a bash script to handle the overcloud registration. The scripts and environment files for this method are located in the core Heat template collection at <code class="literal">/usr/share/openstack-tripleo-heat-templates/extraconfig/pre_deploy/rhel-registration/</code>.
				</p><p>
					Complete the following steps to switch from the <code class="literal">rhel-registration</code> method to the <code class="literal">rhsm</code> composable service.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Exclude the <code class="literal">rhel-registration</code> environment files from future deployments operations. In most cases, exclude the following files:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">rhel-registration/environment-rhel-registration.yaml</code>
								</li><li class="listitem">
									<code class="literal">rhel-registration/rhel-registration-resource-registry.yaml</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							If you use a custom <code class="literal">roles_data</code> file, ensure that each role in your <code class="literal">roles_data</code> file contains the <code class="literal">OS::TripleO::Services::Rhsm</code> composable service. For example:
						</p><pre class="screen">- name: Controller
  description: |
    Controller role that has all the controller services loaded and handles
    Database, Messaging and Network functions.
  CountDefault: 1
  ...
  ServicesDefault:
    ...
    - OS::TripleO::Services::Rhsm
    ...</pre></li><li class="listitem">
							Add the environment file for <code class="literal">rhsm</code> composable service parameters to future deployment operations.
						</li></ol></div><p>
					This method replaces the <code class="literal">rhel-registration</code> parameters with the <code class="literal">rhsm</code> service parameters and changes the Heat resource that enables the service from:
				</p><pre class="screen">resource_registry:
  OS::TripleO::NodeExtraConfig: rhel-registration.yaml</pre><p>
					To:
				</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml</pre><p>
					You can also include the <code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/rhsm.yaml</code> environment file with your deployment to enable the service.
				</p></section><section class="section" id="rhel-registration-to-rhsm-mappings-portal"><div class="titlepage"><div><div><h2 class="title">10.4. rhel-registration to rhsm mappings</h2></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983830272704" scope="col"><code class="literal">rhel-registration</code></th><th align="left" valign="top" id="idm139983830271456" scope="col"><code class="literal">rhsm</code> / <code class="literal">RhsmVars</code></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_method</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_method</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_org</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_org_id</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_pool_id</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_pool_ids</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_activation_key</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_activation_key</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_auto_attach</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_autosubscribe</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_sat_url</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_satellite_url</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_repos</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_repos</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_user</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_username</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_password</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_release</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_release</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_http_proxy_host</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_rhsm_proxy_hostname</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_http_proxy_port</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_rhsm_proxy_port</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_http_proxy_username</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_rhsm_proxy_user</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830272704"> <p>
									<code class="literal">rhel_reg_http_proxy_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983830271456"> <p>
									<code class="literal">rhsm_rhsm_proxy_password</code>
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="registering-the-overcloud-with-the-rhsm-composable-service-portal"><div class="titlepage"><div><div><h2 class="title">10.5. Registering the overcloud with the rhsm composable service</h2></div></div></div><p>
					Use the following procedure to create an environment file that enables and configures the <code class="literal">rhsm</code> composable service. The director uses this environment file to register and subscribe your nodes.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create an environment file (<code class="literal">templates/rhsm.yaml</code>) to store the configuration.
						</li><li class="listitem"><p class="simpara">
							Include your configuration in the environment file. For example:
						</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml
parameter_defaults:
  RhsmVars:
    rhsm_repos:
      - rhel-8-for-x86_64-baseos-eus-rpms
      - rhel-8-for-x86_64-appstream-eus-rpms
      - rhel-8-for-x86_64-highavailability-eus-rpms
      …​
    rhsm_username: "myusername"
    rhsm_password: "p@55w0rd!"
    rhsm_org_id: "1234567"
    rhsm_pool_ids: "1a85f9223e3d5e43013e3d6e8ff506fd"
    rhsm_method: "portal"
    rhsm_release: 8.2</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The <code class="literal">resource_registry</code> section associates the <code class="literal">rhsm</code> composable service with the <code class="literal">OS::TripleO::Services::Rhsm</code> resource, which is available on each role.
								</li><li class="listitem">
									The <code class="literal">RhsmVars</code> variable passes parameters to Ansible for configuring your Red Hat registration.
								</li></ul></div></li><li class="listitem">
							Save the environment file.
						</li></ol></div></section><section class="section" id="applying-the-rhsm-composable-service-to-different-roles-portal"><div class="titlepage"><div><div><h2 class="title">10.6. Applying the rhsm composable service to different roles</h2></div></div></div><p>
					You can apply the <code class="literal">rhsm</code> composable service on a per-role basis. For example, you can apply different sets of configurations to Controller nodes, Compute nodes, and Ceph Storage nodes.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create an environment file (<code class="literal">templates/rhsm.yaml</code>) to store the configuration.
						</li><li class="listitem"><p class="simpara">
							Include your configuration in the environment file. For example:
						</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml
parameter_defaults:
  ControllerParameters:
    RhsmVars:
      rhsm_repos:
        - rhel-8-for-x86_64-baseos-eus-rpms
        - rhel-8-for-x86_64-appstream-eus-rpms
        - rhel-8-for-x86_64-highavailability-eus-rpms
        - ansible-2.9-for-rhel-8-x86_64-rpms
        - advanced-virt-for-rhel-8-x86_64-rpms
        - openstack-16.1-for-rhel-8-x86_64-rpms
        - rhceph-4-mon-for-rhel-8-x86_64-rpms
        - rhceph-4-tools-for-rhel-8-x86_64-rpms
        - fast-datapath-for-rhel-8-x86_64-rpms
      rhsm_username: "myusername"
      rhsm_password: "p@55w0rd!"
      rhsm_org_id: "1234567"
      rhsm_pool_ids: "55d251f1490556f3e75aa37e89e10ce5"
      rhsm_method: "portal"
      rhsm_release: 8.2
  ComputeParameters:
    RhsmVars:
      rhsm_repos:
        - rhel-8-for-x86_64-baseos-eus-rpms
        - rhel-8-for-x86_64-appstream-eus-rpms
        - rhel-8-for-x86_64-highavailability-eus-rpms
        - ansible-2.9-for-rhel-8-x86_64-rpms
        - advanced-virt-for-rhel-8-x86_64-rpms
        - openstack-16.1-for-rhel-8-x86_64-rpms
        - rhceph-4-tools-for-rhel-8-x86_64-rpms
      rhsm_username: "myusername"
      rhsm_password: "p@55w0rd!"
      rhsm_org_id: "1234567"
      rhsm_pool_ids: "55d251f1490556f3e75aa37e89e10ce5"
      rhsm_method: "portal"
      rhsm_release: 8.2
  CephStorageParameters:
    RhsmVars:
      rhsm_repos:
        - rhel-8-for-x86_64-baseos-rpms
        - rhel-8-for-x86_64-appstream-rpms
        - rhel-8-for-x86_64-highavailability-rpms
        - ansible-2.9-for-rhel-8-x86_64-rpms
        - openstack-16.1-deployment-tools-for-rhel-8-x86_64-rpms
        - rhceph-4-osd-for-rhel-8-x86_64-rpms
        - rhceph-4-tools-for-rhel-8-x86_64-rpms
      rhsm_username: "myusername"
      rhsm_password: "p@55w0rd!"
      rhsm_org_id: "1234567"
      rhsm_pool_ids: "68790a7aa2dc9dc50a9bc39fabc55e0d"
      rhsm_method: "portal"
      rhsm_release: 8.2</pre><p class="simpara">
							The <code class="literal">resource_registry</code> associates the <code class="literal">rhsm</code> composable service with the <code class="literal">OS::TripleO::Services::Rhsm</code> resource, which is available on each role.
						</p><p class="simpara">
							The <code class="literal">ControllerParameters</code>, <code class="literal">ComputeParameters</code>, and <code class="literal">CephStorageParameters</code> use their own <code class="literal">RhsmVars</code> parameter to pass subscription details to their respective roles.
						</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
								Set the <code class="literal">RhsmVars</code> parameter within the <code class="literal">CephStorageParameters</code> parameter to use a Red Hat Ceph Storage subscription and repositories specific to Ceph Storage. Ensure the <code class="literal">rhsm_repos</code> parameter contains the standard Red Hat Enterprise Linux repositories instead of the Extended Update Support (EUS) repositories that Controller and Compute nodes require.
							</p></div></div></li><li class="listitem">
							Save the environment file.
						</li></ol></div></section></section><section class="chapter" id="updating-overcloud-registration-to-red-hat-satellite-portal"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Updating overcloud registration to Red Hat Satellite</h2></div></div></div><p>
				Red Hat OpenStack Platform 16.1 uses Ansible-based methods to register overcloud nodes to a Red Hat Satellite 6 server.
			</p><section class="section" id="rhsm-composable-service-satellite"><div class="titlepage"><div><div><h2 class="title">11.1. Red Hat Subscription Manager (RHSM) composable service</h2></div></div></div><p>
					The <code class="literal">rhsm</code> composable service provides a method to register overcloud nodes through Ansible. Each role in the default <code class="literal">roles_data</code> file contains a <code class="literal">OS::TripleO::Services::Rhsm</code> resource, which is disabled by default. To enable the service, register the resource to the <code class="literal">rhsm</code> composable service file:
				</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml</pre><p>
					The <code class="literal">rhsm</code> composable service accepts a <code class="literal">RhsmVars</code> parameter, which allows you to define multiple sub-parameters relevant to your registration. For example:
				</p><pre class="screen">parameter_defaults:
  RhsmVars:
    rhsm_repos:
      - rhel-8-for-x86_64-baseos-eus-rpms
      - rhel-8-for-x86_64-appstream-eus-rpms
      - rhel-8-for-x86_64-highavailability-eus-rpms
      …​
    rhsm_username: "myusername"
    rhsm_password: "p@55w0rd!"
    rhsm_org_id: "1234567"
    rhsm_release: 8.2</pre><p>
					You can also use the <code class="literal">RhsmVars</code> parameter in combination with role-specific parameters (e.g. <code class="literal">ControllerParameters</code>) to provide flexibility when enabling specific repositories for different nodes types.
				</p></section><section class="section" id="rhsmvars-parameters-satellite"><div class="titlepage"><div><div><h2 class="title">11.2. RhsmVars sub-parameters</h2></div></div></div><p>
					See the <a class="link" href="https://github.com/openstack/ansible-role-redhat-subscription/">role documentation</a> to learn about all Ansible parameters.
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 29%; " class="col_1"><!--Empty--></col><col style="width: 71%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983831396576" scope="col"><code class="literal">rhsm</code></th><th align="left" valign="top" id="idm139983831395328" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_method</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									Choose the registration method. Either <code class="literal">portal</code>, <code class="literal">satellite</code>, or <code class="literal">disable</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_org_id</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The organization to use for registration. To locate this ID, run <code class="literal">sudo subscription-manager orgs</code> from the undercloud node. Enter your Red Hat credentials when prompted, and use the resulting <code class="literal">Key</code> value. For more information on your organization ID, see <a class="link" href="https://access.redhat.com/articles/3047431">"Understanding the Red Hat Subscription Management Organization ID "</a>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_pool_ids</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The subscription pool ID to use. Use this if not auto-attaching subscriptions. To locate this ID, run <code class="literal">sudo subscription-manager list --available --all --matches="<span class="strong strong"><strong>OpenStack</strong></span>"</code> from the undercloud node, and use the resulting <code class="literal">Pool ID</code> value.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_activation_key</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The activation key to use for registration. Does not work when <code class="literal">rhsm_repos</code> is configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_autosubscribe</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									Automatically attach compatible subscriptions to this system. Set to <code class="literal">true</code> to enable.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_baseurl</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The base URL for obtaining content. The default is the Red Hat Content Delivery Network URL. If using a Satellite server, change this value to the base URL of your Satellite server content repositories.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_server_hostname</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The hostname of the subscription management service for registration. The default is the Red Hat Subscription Management hostname. If using a Satellite server, change this value to your Satellite server hostname.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_repos</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									A list of repositories to enable. Does not work when <code class="literal">rhsm_activation_key</code> is configured.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_username</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The username for registration. If possible, use activation keys for registration.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The password for registration. If possible, use activation keys for registration.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_release</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									Red Hat Enterprise Linux release for pinning the repositories. This is set to <code class="literal">8.2</code> for Red Hat OpenStack Platform 16.1.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_rhsm_proxy_hostname</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The hostname for the HTTP proxy. For example: <code class="literal">proxy.example.com</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_rhsm_proxy_port</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The port for HTTP proxy communication. For example: <code class="literal">8080</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_rhsm_proxy_user</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The username to access the HTTP proxy.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983831396576"> <p>
									<code class="literal">rhsm_rhsm_proxy_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983831395328"> <p>
									The password to access the HTTP proxy.
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="switching-to-the-rhsm-composable-service-satellite"><div class="titlepage"><div><div><h2 class="title">11.3. Switching to the rhsm composable service</h2></div></div></div><p>
					The previous <code class="literal">rhel-registration</code> method runs a bash script to handle the overcloud registration. The scripts and environment files for this method are located in the core Heat template collection at <code class="literal">/usr/share/openstack-tripleo-heat-templates/extraconfig/pre_deploy/rhel-registration/</code>.
				</p><p>
					Complete the following steps to switch from the <code class="literal">rhel-registration</code> method to the <code class="literal">rhsm</code> composable service.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Exclude the <code class="literal">rhel-registration</code> environment files from future deployments operations. In most cases, exclude the following files:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">rhel-registration/environment-rhel-registration.yaml</code>
								</li><li class="listitem">
									<code class="literal">rhel-registration/rhel-registration-resource-registry.yaml</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							If you use a custom <code class="literal">roles_data</code> file, ensure that each role in your <code class="literal">roles_data</code> file contains the <code class="literal">OS::TripleO::Services::Rhsm</code> composable service. For example:
						</p><pre class="screen">- name: Controller
  description: |
    Controller role that has all the controller services loaded and handles
    Database, Messaging and Network functions.
  CountDefault: 1
  ...
  ServicesDefault:
    ...
    - OS::TripleO::Services::Rhsm
    ...</pre></li><li class="listitem">
							Add the environment file for <code class="literal">rhsm</code> composable service parameters to future deployment operations.
						</li></ol></div><p>
					This method replaces the <code class="literal">rhel-registration</code> parameters with the <code class="literal">rhsm</code> service parameters and changes the Heat resource that enables the service from:
				</p><pre class="screen">resource_registry:
  OS::TripleO::NodeExtraConfig: rhel-registration.yaml</pre><p>
					To:
				</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml</pre><p>
					You can also include the <code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/rhsm.yaml</code> environment file with your deployment to enable the service.
				</p></section><section class="section" id="rhel-registration-to-rhsm-mappings-satellite"><div class="titlepage"><div><div><h2 class="title">11.4. rhel-registration to rhsm mappings</h2></div></div></div><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983828575360" scope="col"><code class="literal">rhel-registration</code></th><th align="left" valign="top" id="idm139983828574112" scope="col"><code class="literal">rhsm</code> / <code class="literal">RhsmVars</code></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_method</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_method</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_org</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_org_id</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_pool_id</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_pool_ids</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_activation_key</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_activation_key</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_auto_attach</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_autosubscribe</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_sat_url</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_satellite_url</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_repos</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_repos</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_user</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_username</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_password</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_release</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_release</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_http_proxy_host</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_rhsm_proxy_hostname</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_http_proxy_port</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_rhsm_proxy_port</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_http_proxy_username</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_rhsm_proxy_user</code>
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983828575360"> <p>
									<code class="literal">rhel_reg_http_proxy_password</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983828574112"> <p>
									<code class="literal">rhsm_rhsm_proxy_password</code>
								</p>
								 </td></tr></tbody></table></div></section><section class="section" id="registering-the-overcloud-to-red-hat-satellite-satellite"><div class="titlepage"><div><div><h2 class="title">11.5. Registering the overcloud to Red Hat Satellite</h2></div></div></div><p>
					Use the following procedure to create an environment file that enables and configures the <code class="literal">rhsm</code> composable service to register nodes to Red Hat Satellite instead of the Red Hat Customer Portal.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Create an environment file (<code class="literal">templates/rhsm.yaml</code>) to store the configuration.
						</li><li class="listitem"><p class="simpara">
							Include your configuration in the environment file. For example:
						</p><pre class="screen">resource_registry:
  OS::TripleO::Services::Rhsm: /usr/share/openstack-tripleo-heat-templates/deployment/rhsm/rhsm-baremetal-ansible.yaml
parameter_defaults:
  RhsmVars:
    rhsm_activation_key: "myactivationkey"
    rhsm_method: "satellite"
    rhsm_org_id: "ACME"
    rhsm_server_hostname: satellite.example.com"
    rhsm_baseurl: "https://satellite.example.com/pulp/repos"
    rhsm_release: 8.2</pre><p class="simpara">
							The <code class="literal">resource_registry</code> associates the <code class="literal">rhsm</code> composable service with the <code class="literal">OS::TripleO::Services::Rhsm</code> resource, which is available on each role.
						</p><p class="simpara">
							The <code class="literal">RhsmVars</code> variable passes parameters to Ansible for configuring your Red Hat registration.
						</p></li><li class="listitem">
							Save the environment file.
						</li></ol></div></section><section class="section" id="proc_preparing-leapp-to-use-satellite-server-satellite"><div class="titlepage"><div><div><h2 class="title">11.6. Preparing Leapp to use Satellite server</h2></div></div></div><p>
					If you use Satellite 6 to host RPM content, complete these preparation steps to ensure a successful Leapp upgrade with Satellite.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A Satellite server activation key linked to repositories for Red Hat OpenStack Platform 16.1 and Red Hat Enterprise Linux 8.2.
						</li><li class="listitem">
							An Ansible inventory file for your overcloud nodes.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Create a file called <code class="literal">playbook-satellite.yaml</code> and paste the following content in the file:
						</p><pre class="screen">- name: Pre-install leapp
  hosts: overcloud
  become: yes
  tasks:
    - name: Pre-install leapp
      yum:
        name:
          - leapp
          - leapp-repository
        state: installed
    - name: Remove katello-host-tools-fact-plugin
      yum:
        name:
          - katello-host-tools-fact-plugin
        state: removed
    - name: Register system
      import_role:
        name: redhat-subscription
      vars:
        rhsm_activation_key: "osp16-key"
        rhsm_method: "satellite"
        rhsm_org_id: "ACME"
        rhsm_server_hostname: "satellite.example.com"
        rhsm_baseurl: "https://satellite.example.com/pulp/repos"
        rhsm_release: "8.2"
        rhsm_force_register: True</pre><p class="simpara">
							Modify the <code class="literal">rhsm_*</code> variables to suit your Satellite server.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="screen">$ ansible-playbook -i ~/inventory.yaml playbook-satellite.yaml</pre></li></ol></div></section></section><section class="chapter" id="preparing-for-a-ceph-storage-upgrade"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Preparing for a Ceph Storage upgrade</h2></div></div></div><p>
				The upgrade process maintains the use of Red Hat Ceph Storage 3 containerized services through the duration of the upgrade to Red Hat OpenStack Platform 16.1. After you complete the Red Hat OpenStack Platform 16.1 upgrade, you upgrade the Ceph Storage services to Red Hat Ceph Storage 4.
			</p><section class="section" id="understanding-the-ceph-storage-node-upgrade-process-at-a-high-level-preparing-overcloud"><div class="titlepage"><div><div><h2 class="title">12.1. Understanding the Ceph Storage node upgrade process at a high level</h2></div></div></div><p>
					The Ceph Storage nodes continue to use Red Hat Ceph Storage 3 containers during the overcloud upgrade process. To understand how Ceph Storage nodes and services are impacted during the upgrade process, read the following summaries for each aspect of the Ceph Storage upgrade process.
				</p><div class="formalpara"><p class="title"><strong>ceph-ansible</strong></p><p>
						<code class="literal">ceph-ansible</code> is a collection of roles and playbooks that director uses to install, maintain, and upgrade Ceph Storage services. When you upgraded the undercloud, you ran certain commands that ensured <code class="literal">ceph-ansible</code> remained at the latest version 3 collection after the transition to Red Hat Enterprise Linux 8.2. Version 3 of <code class="literal">ceph-ansible</code> keeps the containerized Ceph Storage services on version 3 through the duration of the overcloud upgrade. After you complete the upgrade, you enable the Red Hat Ceph Storage update the <span class="strong strong"><strong>Red Hat Ceph Storage Tools 4 for RHEL 8</strong></span> repository and update <code class="literal">ceph-ansible</code> to version 4.
					</p></div><div class="formalpara"><p class="title"><strong>Migration to Podman</strong></p><p>
						During the overcloud upgrade, you must run the <code class="literal">openstack overcloud external-upgrade run --tags ceph_systemd</code> command to change the <code class="literal">systemd</code> services that control Ceph Storage containerized services to use Podman instead of Docker. You run this command before performing the operating system upgrade on any node that contains Ceph Storage containerized services.
					</p></div><p>
					After you change the <code class="literal">systemd</code> services to use Podman on a node, you perform the operating system upgrade and the OpenStack Platform service upgrade. The Ceph Storage containers on that node will run again after the OpenStack Platform service upgrade.
				</p><div class="formalpara"><p class="title"><strong>Ceph Storage operating system upgrade</strong></p><p>
						You follow the same workflow on Ceph Storage nodes as you do on overcloud nodes in general. When you run the <code class="literal">openstack overcloud upgrade run --tags system_upgrade</code> command against a Ceph Storage node, director runs Leapp on Ceph Storage node and upgrades the operating system to Red Hat Enterprise Linux 8.2. You then run the untagged <code class="literal">openstack overcloud upgrade run</code> command against the Ceph Storage node, which runs the following containers:
					</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat Ceph Storage 3 containerized services
						</li><li class="listitem">
							Red Hat OpenStack Platform 16.1 containerized services
						</li></ul></div><div class="formalpara"><p class="title"><strong>Upgrading to Red Hat Ceph Storage 4</strong></p><p>
						After you complete the Leapp upgrade and Red Hat OpenStack Platform upgrade, the Ceph Storage containerized services will still use version 3 containers. At this point, you must upgrade <code class="literal">ceph-ansible</code> to version 4 and then run the <code class="literal">openstack overcloud external-upgrade run --tags ceph</code> command that performs an upgrade of all Red Hat Ceph Storage services on all nodes to version 4.
					</p></div><div class="formalpara"><p class="title"><strong>Summary of the Ceph Storage workflow</strong></p><p>
						The following list is a high level workflow for the Red Hat Ceph Storage upgrade. This workflow is integrated into the general Red Hat OpenStack Platform workflow and you run upgrade framework commands on the undercloud to perform the operations in this workflow.
					</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
							Upgrade the undercloud but retain version 3 of <code class="literal">ceph-ansible</code>
						</li><li class="listitem">
							Start the overcloud upgrade
						</li><li class="listitem"><p class="simpara">
							Perform the following tasks for each node that hosts Ceph Storage containerized services:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
									Migrate the Ceph Storage containerized services to Podman
								</li><li class="listitem">
									Upgrade the operating system
								</li><li class="listitem">
									Upgrade the OpenStack Platform services, which relaunches Ceph Storage version 3 containerized services
								</li></ol></div></li><li class="listitem">
							Complete the overcloud upgrade
						</li><li class="listitem">
							Upgrade <code class="literal">ceph-ansible</code> to version 4 on the undercloud
						</li><li class="listitem">
							Upgrade to Red Hat Ceph Storage 4 on the overcloud
						</li></ol></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						This list does not capture all steps in the complete Red Hat OpenStack Platform 16.1 upgrade process but focuses only on the aspects relevant to Red Hat Ceph Storage to describe what occurs to Ceph Storage services during the upgrade process.
					</p></div></div></section><section class="section" id="checking-your-ceph-ansible-version"><div class="titlepage"><div><div><h2 class="title">12.2. Checking your ceph-ansible version</h2></div></div></div><p>
					During the undercloud upgrade, you retained the Ceph Storage 3 version of the <code class="literal">ceph-ansible</code> package. This helps maintain the compatibility of the Ceph Storage 3 containers on your Ceph Storage nodes. Verify that this package remains on your undercloud.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Run the <code class="literal">dnf</code> command to check the version of the <code class="literal">ceph-ansible</code> package:
						</p><pre class="screen">$ sudo dnf info ceph-ansible</pre><p class="simpara">
							The command output shows version 3 of the <code class="literal">ceph-ansible</code> package:
						</p><pre class="screen">Installed Packages
Name         : ceph-ansible
Version      : 3.xx.xx.xx
...</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						If the <code class="literal">ceph-ansible</code> package is missing or not a version 3 package, download the latest version 3 package from the <a class="link" href="https://access.redhat.com/downloads/content/ceph-ansible/noarch/package-latest">Red Hat Package Browser</a> and manually install the package on your undercloud. Note that the <code class="literal">ceph-ansible</code> version 3 package is only available from Red Hat Enterprise Linux 7 repositories and is not available in Red Hat Enterprise Linux 8 repositories. <code class="literal">ceph-ansible</code> version 3 is not supported on Red Hat Enterprise Linux 8 outside the context of the Red Hat OpenStack Platform framework for upgrades.
					</p></div></div></section><section class="section" id="setting-the-ceph-ansible-repository-preparing-overcloud"><div class="titlepage"><div><div><h2 class="title">12.3. Setting the ceph-ansible repository</h2></div></div></div><p>
					The Red Hat OpenStack Platform 16.1 validation framework tests that <code class="literal">ceph-ansible</code> is installed correctly before director upgrades the overcloud to Red Hat Ceph Storage 4. The framework uses the <code class="literal">CephAnsibleRepo</code> parameter to check that you installed <code class="literal">ceph-ansible</code> from the correct repository. Director disables the test after you run the <code class="literal">openstack overcloud upgrade prepare</code> command and this test remains disabled through the duration of the Red Hat OpenStack Platform 16.1 overcloud upgrade. Director re-enables this test after running the <code class="literal">openstack overcloud upgrade converge</code> command. However, to prepare for this validation, you must set the <code class="literal">CephAnsibleRepo</code> parameter to the <span class="strong strong"><strong>Red Hat Ceph Storage Tools 4 for RHEL 8</strong></span> repository.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Edit the environment file that contains your overcloud Ceph Storage configuration. This file is usually named <code class="literal">ceph-config.yaml</code> and you can find it in your <code class="literal">templates</code> directory:
						</p><pre class="screen">$ vi /home/stack/templates/ceph-config.yaml</pre></li><li class="listitem"><p class="simpara">
							Add the <code class="literal">CephAnsibleRepo</code> parameter to the <code class="literal">parameter_defaults</code> section:
						</p><pre class="screen">parameter_defaults:
  ...
  CephAnsibleRepo: rhceph-4-tools-for-rhel-8-x86_64-rpms
  ...</pre><p class="simpara">
							<code class="literal">CephAnsibleRepo</code> sets the repository that includes <code class="literal">ceph-ansible</code>. The validation framework uses this parameter to check that you have installed <code class="literal">ceph-ansible</code> on the undercloud.
						</p></li><li class="listitem">
							Save the <code class="literal">ceph-config.yaml</code> file.
						</li></ol></div></section><section class="section" id="proc_checking-ceph-cluster-status-before-an-upgrade-preparing-overcloud"><div class="titlepage"><div><div><h2 class="title">12.4. Checking Ceph cluster status before an upgrade</h2></div></div></div><p>
					Before you can proceed with the overcloud upgrade, you must verify that the Ceph cluster is functioning as expected.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the node that is running the <code class="literal">ceph-mon</code> service. This node is usually a Controller node or a standalone Ceph Monitor node.
						</li><li class="listitem"><p class="simpara">
							Enter the following command to view the status of the Ceph cluster:
						</p><pre class="screen">$ docker exec ceph-mon-$HOSTNAME ceph -s</pre></li><li class="listitem">
							Confirm that the health status of the cluster is <code class="literal">HEALTH_OK</code> and that all of the OSDs are <code class="literal">up</code>.
						</li></ol></div></section></section><section class="chapter" id="updating-network-configuration"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Updating network configuration</h2></div></div></div><p>
				You must complete some network configuration to prepare for the overcloud upgrade.
			</p><section class="section" id="updating-network-interface-templates"><div class="titlepage"><div><div><h2 class="title">13.1. Updating network interface templates</h2></div></div></div><p>
					Red Hat OpenStack Platform includes a script to automatically add the missing parameters to your NIC template files.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							On the undercloud, create a file called <code class="literal">update-nic-templates.sh</code> and include the following content in the file:
						</p><pre class="screen">#!/bin/bash
STACK_NAME="overcloud"
ROLES_DATA="/usr/share/openstack-tripleo-heat-templates/roles_data.yaml"
NETWORK_DATA="/usr/share/openstack-tripleo-heat-templates/network_data.yaml"
NIC_CONFIG_LINES=$(openstack stack environment show $STACK_NAME | grep "::Net::SoftwareConfig" | sed -E 's/ *OS::TripleO::// ; s/::Net::SoftwareConfig:// ; s/ http.*user-files/ /')
echo "$NIC_CONFIG_LINES" | while read LINE; do
    ROLE=$(echo "$LINE" | awk '{print $1;}')
    NIC_CONFIG=$(echo "$LINE" | awk '{print $2;}')

    if [ -f "$NIC_CONFIG" ]; then
        echo "Updating template for $ROLE role."
        python3 /usr/share/openstack-tripleo-heat-templates/tools/merge-new-params-nic-config-script.py \
            --tht-dir /usr/share/openstack-tripleo-heat-templates \
            --roles-data $ROLES_DATA \
            --network-data $NETWORK_DATA \
            --role-name "$ROLE" \
            --discard-comments yes \
            --template "$NIC_CONFIG"
    else
        echo "No NIC template detected for $ROLE role. Skipping $ROLE role."
    fi
done</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									If you use a custom overcloud name, Set the <code class="literal">STACK_NAME</code> variable to the name of your overcloud. The default name for an overcloud stack is <code class="literal">overcloud</code>.
								</li><li class="listitem">
									If you use a custom <code class="literal">roles_data</code> file, set the <code class="literal">ROLES_DATA</code> variable to the location of the custom file. If you use the default <code class="literal">roles_data</code> file, leave the variable as <code class="literal">/usr/share/openstack-tripleo-heat-templates/roles_data.yaml</code>
								</li><li class="listitem">
									If you use a custom <code class="literal">network_data</code> file, set the <code class="literal">NETWORK_DATA</code> variable to the location of the custom file. If you use the default <code class="literal">network_data</code> file, leave the variable as <code class="literal">/usr/share/openstack-tripleo-heat-templates/network_data.yaml</code>
								</li><li class="listitem">
									Run <code class="literal">/usr/share/openstack-tripleo-heat-templates/tools/merge-new-params-nic-config-script.py -h</code> to see a list of options to add to the script.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Add executable permissions to the script:
						</p><pre class="screen">$ chmod +x update-nic-templates.sh</pre></li><li class="listitem"><p class="simpara">
							Run the script:
						</p><pre class="screen">$ ./update-nic-templates.sh</pre><p class="simpara">
							The script saves a copy of each custom NIC template and updates each template with the missing parameters. The script also skips any roles that do not have a custom template:
						</p><pre class="screen">No NIC template detected for BlockStorage role. Skipping BlockStorage role.
Updating template for CephStorage role.
The original template was saved as: /home/stack/templates/custom-nics/ceph-storage.yaml.20200903144835
The update template was saved as: /home/stack/templates/custom-nics/ceph-storage.yaml
Updating template for Compute role.
The original template was saved as: /home/stack/templates/custom-nics/compute.yaml.20200903144838
The update template was saved as: /home/stack/templates/custom-nics/compute.yaml
Updating template for Controller role.
The original template was saved as: /home/stack/templates/custom-nics/controller.yaml.20200903144841
The update template was saved as: /home/stack/templates/custom-nics/controller.yaml
No NIC template detected for ObjectStorage role. Skipping ObjectStorage role.</pre></li></ol></div></section><section class="section" id="maintaining-openvswitch-compatibility-during-the-upgrade"><div class="titlepage"><div><div><h2 class="title">13.2. Maintaining Open vSwitch compatibility during the upgrade</h2></div></div></div><p>
					Red Hat OpenStack Platform 13 uses Open vSwitch (OVS) as the default ML2 back end for OpenStack Networking (neutron). Newer versions of Red Hat OpenStack Platform use Open Virtual Network (OVN), which expands upon OVS capabilities. However, to ensure a stable upgrade, you must maintain OVS functionality during the duration of the upgrade and then migrate to OVN after you complete the upgrade.
				</p><p>
					To maintain OVS compatibility during the upgrade, include the following environment file as part of your environment file collection:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml</code>
						</li></ul></div><p>
					Treat this file as part of your deployment until you have completed the migration to OVN. Include the file with all overcloud upgrade and deployment commands:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">openstack overcloud upgrade prepare</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud upgrade converge</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud deploy</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud update prepare</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud update converge</code>
						</li><li class="listitem">
							Any other command that uses environment files.
						</li></ul></div></section><section class="section" id="maintaining-composable-network-compatibility-during-the-upgrade-preparing-overcloud"><div class="titlepage"><div><div><h2 class="title">13.3. Maintaining composable network compatibility during the upgrade</h2></div></div></div><p>
					The <code class="literal">network_data</code> file format for Red Hat OpenStack Platform 16.1 includes new sections that you can use to define additional subnets and routes within a network. However, if you use a custom <code class="literal">network_data</code> file, you can still use the <code class="literal">network_data</code> file format from Red Hat OpenStack Platform 13.
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							When you upgrade from Red Hat OpenStack Platform 13 to 16.1, use the Red Hat OpenStack Platform 13 <code class="literal">network_data</code> file format during and after the upgrade. For more information about Red Hat OpenStack Platform 13 composable network syntax, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/13/html/advanced_overcloud_customization/custom-composable-networks">"Custom composable networks"</a>.
						</li><li class="listitem">
							When you create new overclouds on Red Hat OpenStack Platform 16.1, use the Red Hat OpenStack Platform 16.1 <code class="literal">network_data</code> file format. For more information about Red Hat OpenStack Platform 16.1 composable network syntax, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/advanced_overcloud_customization/custom-composable-networks">"Custom composable networks"</a>.
						</li></ul></div></section></section><section class="chapter" id="preparing-network-functions-virtualization-nfv"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Preparing network functions virtualization (NFV)</h2></div></div></div><p>
				If you use network functions virtualization (NFV), you must complete some preparation for the overcloud upgrade.
			</p><section class="section" id="network_functions_virtualization_nfv_environment_files"><div class="titlepage"><div><div><h2 class="title">14.1. Network functions virtualization (NFV) environment files</h2></div></div></div><p>
					In a typical NFV-based environment, you can enable services such as the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Single-root input/output virtualization (SR-IOV)
						</li><li class="listitem">
							Data Plane Development Kit (DPDK)
						</li></ul></div><p>
					You do not require any specific reconfiguration to these services to accommodate the upgrade to Red Hat OpenStack Platform 16.1. However, ensure that the environment files that enable your NFV functionality meet the following requirements:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							The default environment files to enable NFV features are located in the <code class="literal">environments/services</code> directory of the Red Hat OpenStack Platform 16.1 <code class="literal">openstack-tripleo-heat-templates</code> collection. If you include the default NFV environment files from <code class="literal">openstack-tripleo-heat-templates</code> with your Red Hat OpenStack Platform 13 deployment, verify the correct environment file location for the respective feature in Red Hat OpenStack Platform 16.1:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Open vSwitch (OVS) networking and SR-IOV: <code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs-sriov.yaml</code>
								</li><li class="listitem">
									Open vSwitch (OVS) networking and DPDK: <code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs-dpdk.yaml</code>
								</li></ul></div></li><li class="listitem">
							To maintain OVS compatibility during the upgrade from Red Hat OpenStack Platform 13 to Red Hat OpenStack Platform 16.1, you must include the <code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml</code> environment file. When running deployment and upgrade commands that involve environment files, you must include any NFV-related environment files after the <code class="literal">neutron-ovs.yaml</code> file. For example, when running <code class="literal">openstack overcloud upgrade prepare</code> with OVS and NFV environment files, include the files in the following order:
						</li><li class="listitem">
							The OVS environment file
						</li><li class="listitem">
							The SR-IOV environment file
						</li><li class="listitem"><p class="simpara">
							The DPDK environment file
						</p><pre class="screen">$ openstack overcloud upgrade prepare \
    ...
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs-sriov.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs-dpdk.yaml \
    ...</pre></li></ul></div></section></section><section class="chapter" id="final-review-before-upgrade"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Final review before upgrade</h2></div></div></div><p>
				Complete a final check of all preparation steps before you begin the upgrade.
			</p><section class="section" id="new-environment-files-to-include-with-your-deployment"><div class="titlepage"><div><div><h2 class="title">15.1. New environment files to include with your deployment</h2></div></div></div><p>
					In addition to your regular overcloud environment files, you must include new environment files to facilitate the upgrade to Red Hat OpenStack Platform 16.1
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--></col><col style="width: 50%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983829685728" scope="col">File</th><th align="left" valign="top" id="idm139983829684640" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983829685728"> <p>
									<code class="literal">/home/stack/templates/upgrades-environment.yaml</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983829684640"> <p>
									This file contains the parameters specific to the upgrade. This file is necessary only for the duration of the upgrade. Discard this file after you run <code class="literal">openstack overcloud upgrade converge</code>.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983829685728"> <p>
									<code class="literal">/home/stack/templates/rhsm.yaml</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983829684640"> <p>
									This file contains registration and subscription information for the overcloud. This file registers your systems either to the Red Hat Customer Portal or a Red Hat Satellite server.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983829685728"> <p>
									<code class="literal">/home/stack/containers-prepare-parameter.yaml</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983829684640"> <p>
									The file that contains the source and preparation steps. This is the same file that you use with the undercloud upgrade.
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983829685728"> <p>
									<code class="literal">/usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml</code>
								</p>
								 </td><td align="left" valign="top" headers="idm139983829684640"> <p>
									OpenStack Platform 16.1 uses Open Virtual Network (OVN) as the default networking backend. However, OpenStack Platform 13 used Open vSwitch (OVS). Include this file to retain OVS compatibility during the upgrade. The OpenStack Platform 16.1 documentation includes instructions on migrating from OVS to OVN after the upgrade.
								</p>
								 </td></tr></tbody></table></div><p>
					Add these files to the end of your environment file listing when you run the following commands:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">openstack overcloud upgrade prepare</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud upgrade converge</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud deploy</code>
						</li></ul></div></section><section class="section" id="environment-files-to-remove-from-your-deployment"><div class="titlepage"><div><div><h2 class="title">15.2. Environment files to remove from your deployment</h2></div></div></div><p>
					Remove any environment files specific to your OpenStack Platform Red Hat OpenStack Platform 13:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Red Hat OpenStack Platform 13 container image list
						</li><li class="listitem">
							Red Hat OpenStack Platform 13 Customer Portal or Satellite <code class="literal">rhel-registration</code> scripts
						</li></ul></div><p>
					Remove these files from the list of environment files you include when you run the following commands:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">openstack overcloud upgrade prepare</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud upgrade converge</code>
						</li><li class="listitem">
							<code class="literal">openstack overcloud deploy</code>
						</li></ul></div></section><section class="section" id="upgrade-checklist"><div class="titlepage"><div><div><h2 class="title">15.3. Upgrade checklist</h2></div></div></div><p>
					Use the following checklist to determine your readiness to upgrade the overcloud:
				</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 80%; " class="col_1"><!--Empty--></col><col style="width: 20%; " class="col_2"><!--Empty--></col></colgroup><thead><tr><th align="left" valign="top" id="idm139983830391920" scope="col">Item</th><th align="left" valign="top" id="idm139983830390832" scope="col">Complete</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Validated a working overcloud.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Performed a Relax-and-Recover (ReaR) backup of the overcloud control plane.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Implemented all preparation for Leapp, including:
								</p>
								 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Leapp environment file
										</li><li class="listitem">
											Leapp data copied to the overcloud nodes
										</li><li class="listitem">
											All overcloud nodes are now using predictable NIC names.
										</li><li class="listitem">
											All overcloud nodes have <code class="literal">PermitRootLogin</code> set
										</li></ul></div>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Updated your registration details to Red Hat OpenStack Platform 16.1 repositories and covnerted your environment file to use the Ansible-based method.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Updated your network configuration templates.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Updated your environment file list with new environment files for Red Hat OpenStack Platform 16.1.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr><tr><td align="left" valign="top" headers="idm139983830391920"> <p>
									Removed old environment files only relevant to Red Hat OpenStack Platform 13, such as old Red Hat registration and container image location files.
								</p>
								 </td><td align="left" valign="top" headers="idm139983830390832"> <p>
									Y / N
								</p>
								 </td></tr></tbody></table></div></section></section></div><div class="part" id="upgrading_the_overcloud"><div class="titlepage"><div><div><h1 class="title">Part III. Upgrading the overcloud</h1></div></div></div><section class="chapter" id="upgrade-command-overview"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Upgrade command overview</h2></div></div></div><p>
				The upgrade process involves different commands that you run at certain stages of process.
			</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
					This section only contains information about each command. You must run these commands in a specific order and provide options specific to your overcloud. Wait until you receive instructions to run these commands at the appropriate step.
				</p></div></div><section class="section" id="openstack-overcloud-upgrade-prepare"><div class="titlepage"><div><div><h2 class="title">16.1. openstack overcloud upgrade prepare</h2></div></div></div><p>
					This command performs the initial preparation steps for the overcloud upgrade, which includes replacing the current overcloud plan on the undercloud with the new OpenStack Platform 16.1 overcloud plan and your updated environment files. This command functions similar to the <code class="literal">openstack overcloud deploy</code> command and uses many of the same options.
				</p></section><section class="section" id="openstack-overcloud-upgrade-run"><div class="titlepage"><div><div><h2 class="title">16.2. openstack overcloud upgrade run</h2></div></div></div><p>
					This command performs the upgrade process. Director creates a set of Ansible playbooks based on the new OpenStack Platform 16.1 overcloud plan and runs the fast forward tasks on the entire overcloud. This includes running the upgrade process through each OpenStack Platform version from 13 to 16.1.
				</p><p>
					In addition to the standard upgrade process, this command can perform a Leapp upgrade of the operating system on overcloud nodes. Run these tasks using the <code class="literal">--tags</code> option.
				</p><div class="variablelist"><p class="title"><strong>Upgrade task tags for Leapp</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">system_upgrade</code></span></dt><dd>
								Task that combines tasks from <code class="literal">system_upgrade_prepare</code>, <code class="literal">system_upgrade_run</code>, and <code class="literal">system_upgrade_reboot</code>.
							</dd><dt><span class="term"><code class="literal">system_upgrade_prepare</code></span></dt><dd>
								Tasks to prepare for the operating system upgrade with Leapp.
							</dd><dt><span class="term"><code class="literal">system_upgrade_run</code></span></dt><dd>
								Tasks to run Leapp and upgrade the operating system.
							</dd><dt><span class="term"><code class="literal">system_upgrade_reboot</code></span></dt><dd>
								Tasks to reboot a system and complete the operating system upgrade.
							</dd></dl></div><div class="variablelist"><p class="title"><strong>Upgrade task tags for workload migration</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">nova_hybrid_state</code></span></dt><dd>
								Task that sets up temporary OpenStack Platform 16.1 containers on Compute nodes to facilitate workload migration during the upgrade.
							</dd></dl></div></section><section class="section" id="openstack-overcloud-external-upgrade-run"><div class="titlepage"><div><div><h2 class="title">16.3. openstack overcloud external-upgrade run</h2></div></div></div><p>
					This command performs upgrade tasks outside the standard upgrade process. Director creates a set of Ansible playbooks based on the new OpenStack Platform 16.1 overcloud plan and you run specific tasks using the <code class="literal">--tags</code> option.
				</p><div class="variablelist"><p class="title"><strong>External task tags for container management</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">container_image_prepare</code></span></dt><dd>
								Tasks for pulling container images to the undercloud registry and preparing the images for the overcloud to use.
							</dd></dl></div><div class="variablelist"><p class="title"><strong>External task tags for Ceph Storage upgrades</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">ceph</code></span></dt><dd>
								Tasks to install Red Hat Ceph Storage using <code class="literal">ceph-ansible</code> playbooks.
							</dd><dt><span class="term"><code class="literal">ceph_systemd</code></span></dt><dd>
								Tasks to convert Red Hat Ceph Storage systemd unit files to use <code class="literal">podman</code> management.
							</dd></dl></div><div class="variablelist"><p class="title"><strong>External task tags for database transfer</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">system_upgrade_cleanup</code></span></dt><dd>
								Tasks to clean storage directories related to <code class="literal">system_upgrade_transfer_data</code> tasks.
							</dd><dt><span class="term"><code class="literal">system_upgrade_stop_services</code></span></dt><dd>
								Tasks to shut down all services.
							</dd><dt><span class="term"><code class="literal">system_upgrade_transfer_data</code></span></dt><dd>
								Tasks to shut down all services and perform a database transfer to the bootstrap node.
							</dd></dl></div></section><section class="section" id="openstack-overcloud-upgrade-converge"><div class="titlepage"><div><div><h2 class="title">16.4. openstack overcloud upgrade converge</h2></div></div></div><p>
					This command performs the final step in the overcloud upgrade. This final step synchronizes the overcloud heat stack with the OpenStack Platform 16.1 overcloud plan and your updated environment files. This process ensures that the resulting overcloud matches the configuration of a new OpenStack Platform 16.1 overcloud. This command is similar to the <code class="literal">openstack overcloud deploy</code> command and uses many of the same options.
				</p></section><section class="section" id="overcloud-node-upgrade-workflow-upgrading-overcloud"><div class="titlepage"><div><div><h2 class="title">16.5. Overcloud node upgrade workflow</h2></div></div></div><p>
					When you perform an upgrade on each overcloud node, you must consider the following aspects to determine the correct commands to run at the relevant stage in the upgrade:
				</p><div class="itemizedlist"><p class="title"><strong>Controller Services</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<span class="strong strong"><strong>Does the node contain Pacemaker services?</strong></span> You must first upgrade the bootstrap node, which includes a database transfer and launching temporary containers to facilitate migration during the transition from Red Hat OpenStack 13 to 16.1. After upgrading the bootstrap node, upgrade each additional node with pacemaker services and ensure the each node joins the new Pacemaker cluster started with the bootstrap node. The process for upgrading split-service Controller nodes without Pacamaker does not require these additional steps.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Compute Services</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Is the node a Compute node?</strong></span> If the node does contain Compute services, you must migrate virtual machines from the node to ensure maximum availability. A Compute node in this situation includes any node designed to host virtual machines. This definition includes the follow Compute nodes types:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Regular Compute nodes
								</li><li class="listitem">
									Compute nodes with Hyper-Converged Infrastructure (HCI)
								</li><li class="listitem">
									Compute nodes with Network Function Virtualization technologies such as Data Plane Development Kit (DPDK) or Single Root Input/Output Virtualization (SR-IOV)
								</li><li class="listitem">
									Real Time Compute nodes
								</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Ceph Storage Services</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							<span class="strong strong"><strong>Does the node contain any Ceph Storage services?</strong></span> You must convert the <code class="literal">systemd</code> unit files for any containerized Ceph Storage services on the node to use <code class="literal">podman</code> instead of <code class="literal">docker</code>. This applies to the following node types:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									Ceph Storage OSD nodes
								</li><li class="listitem">
									Controller nodes with Ceph MON services
								</li><li class="listitem">
									Split-Controller Ceph MON nodes
								</li><li class="listitem">
									Compute nodes with Hyper-Converged Infrastructure (HCI)
								</li></ul></div></li></ul></div><div class="formalpara"><p class="title"><strong>Workflow</strong></p><p>
						Use the following workflow diagram to identify the correct update path for specific nodes:
					</p></div><p>
					<span class="inlinemediaobject"><object type="image/svg+xml" class="svg-img" data="106_OpenStack_Overcloud_Upgrade_Workflow_0720.svg"><embed type="image/svg+xml" src="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html-single/framework_for_upgrades_13_to_16.1/images/common/images/upgrades/106_OpenStack_Overcloud_Upgrade_Workflow_0720.svg"><!--Empty--></embed></object></span>

				</p></section></section><section class="chapter" id="upgrading-a-standard-overcloud"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Upgrading a standard overcloud</h2></div></div></div><p>
				This scenario contains an example upgrade process for a standard overcloud environment, which includes the following node types:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Three Controller nodes
					</li><li class="listitem">
						Three Ceph Storage nodes
					</li><li class="listitem">
						Multiple Compute nodes
					</li></ul></div><section class="section" id="running-the-overcloud-upgrade-preparation-upgrading-overcloud-standard"><div class="titlepage"><div><div><h2 class="title">17.1. Running the overcloud upgrade preparation</h2></div></div></div><p>
					The upgrade requires running <code class="literal">openstack overcloud upgrade prepare</code> command, which performs the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Updates the overcloud plan to OpenStack Platform 16.1
						</li><li class="listitem">
							Prepares the nodes for the upgrade
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the upgrade preparation command:
						</p><pre class="screen">$ openstack overcloud upgrade prepare \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the upgrade preparation completes.
						</li><li class="listitem"><p class="simpara">
							Download the container images:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags container_image_prepare</pre></li></ol></div></section><section class="section" id="upgrading-controller-nodes-upgrading-overcloud-standard"><div class="titlepage"><div><div><h2 class="title">17.2. Upgrading Controller nodes</h2></div></div></div><p>
					Upgrade all the Controller nodes to OpenStack Platform 16.1. This process involves upgrading each Controller node starting with the bootstrap Controller node.
				</p><p>
					In this example, the controller nodes are named using the default <code class="literal">overcloud-controller-<span class="emphasis"><em>NODEID</em></span></code> convention. This includes the following three controller nodes:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">overcloud-controller-0</code>
						</li><li class="listitem">
							<code class="literal">overcloud-controller-1</code>
						</li><li class="listitem">
							<code class="literal">overcloud-controller-2</code>
						</li></ul></div><p>
					Substitute these values for your own node names where applicable.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the <code class="literal">overcloud</code> default stack name, set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Identify the bootstrap Controller node by running the following command on a Controller node:
						</p><pre class="screen">$ sudo hiera -c /etc/puppet/hiera.yaml pacemaker_short_bootstrap_node_name</pre><p class="simpara">
							To run this command from the undercloud, run the following SSH command and substitute <code class="literal">CONTROLLER_IP</code> with the IP address of any Controller node in your environment:
						</p><pre class="screen">$ ssh heat-admin@<span class="emphasis"><em>CONTROLLER_IP</em></span> "sudo hiera -c /etc/puppet/hiera.yaml pacemaker_short_bootstrap_node_name"</pre><p class="simpara">
							This example uses <code class="literal">overcloud-controller-0</code> as the value of the bootstrap node. Substitute this value for your own bootstrap node.
						</p></li><li class="listitem"><p class="simpara">
							Upgrade the bootstrap Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem"><p class="simpara">
											Performs a reboot as a part of the Leapp upgrade.
										</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
												The next command causes an outage on the control plane. You cannot perform any standard operations on the overcloud during the next few steps.
											</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">system_upgrade_transfer_data</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade_transfer_data</pre><p class="simpara">
									This command copies the latest version of the database from an existing node to the bootstrap node.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">nova_hybrid_state</code> tag and run only the <code class="literal">upgrade_steps_playbook.yaml</code> playbook:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --playbook upgrade_steps_playbook.yaml --tags nova_hybrid_state --limit all</pre><p class="simpara">
									This command launches temporary 16.1 containers on Compute nodes to help facilitate workload migration when you upgrade Compute nodes at a later step.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade.
								</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										The control plane becomes active when this command finishes. You can perform standard operations on the overcloud again.
									</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Upgrade the next Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-1</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag on the next Controller node:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-1</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0,overcloud-controller-1</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade. In addition to this node, include the previously upgraded bootstrap node in the <code class="literal">--limit</code> option.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Upgrade the final Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-2</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-2</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0,overcloud-controller-1,overcloud-controller-2</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade. Include all Controller nodes in the <code class="literal">--limit</code> option.
								</p></li></ol></div></li></ol></div></section><section class="section" id="upgrading-the-operating-system-for-ceph-storage-nodes-upgrading-overcloud-standard"><div class="titlepage"><div><div><h2 class="title">17.3. Upgrading the operating system for Ceph Storage nodes</h2></div></div></div><p>
					Upgrade the operating system for each Ceph Storage nodes.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Log in to a node with Ceph MON services:
						</li><li class="listitem"><p class="simpara">
							Disable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo podman ps | grep ceph-mon
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set noout
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container running Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li><li class="listitem"><p class="simpara">
							Select a Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-0</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the next Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-1</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-1</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-1</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the final Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-2</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-2</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-2</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem">
							After you upgrade all HCI nodes, log into a node that hosts Ceph MON services.
						</li><li class="listitem"><p class="simpara">
							Enable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo podman ps | grep ceph-mon
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset noout
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container running Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li></ol></div></section><section class="section" id="upgrading-compute-nodes-upgrading-overcloud-standard"><div class="titlepage"><div><div><h2 class="title">17.4. Upgrading Compute nodes</h2></div></div></div><p>
					Upgrade all the Compute nodes to OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Migrate your instances. For more information on migration strategies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/instances_and_images_guide/migrating-virtual-machines-between-compute-nodes">"Migrating virtual machines between Compute nodes"</a>
						</li><li class="listitem"><p class="simpara">
							Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-compute-0</pre><p class="simpara">
							This command performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Performs a Leapp upgrade of the operating system.
								</li><li class="listitem">
									Performs a reboot as a part of the Leapp upgrade.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade command with no tags:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-compute-0</pre><p class="simpara">
							This command performs the Red Hat OpenStack Platform upgrade.
						</p></li><li class="listitem"><p class="simpara">
							To upgrade multiple Compute nodes in parallel, set the <code class="literal">--limit</code> option to a comma-separated list of nodes that you want to upgrade. First perform the <code class="literal">system_upgrade</code> task:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-compute-0,overcloud-compute-1,overcloud-compute-2</pre><p class="simpara">
							Then perform the standard OpenStack service upgrade:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span>  --limit overcloud-compute-0,overcloud-compute-1,overcloud-compute-2</pre></li></ol></div></section><section class="section" id="performing_the_upgrade-upgrading-overcloud-standard"><div class="titlepage"><div><div><h2 class="title">17.5. Synchronizing the overcloud stack</h2></div></div></div><p>
					The upgrade requires an update the overcloud stack to ensure that the stack resource structure and parameters align with a fresh deployment of OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">containers-prepare-parameter.yaml</code> file and remove the following parameters and their values:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">ceph3_namespace</code>
								</li><li class="listitem">
									<code class="literal">ceph3_tag</code>
								</li><li class="listitem">
									<code class="literal">ceph3_image</code>
								</li><li class="listitem">
									<code class="literal">name_prefix_stein</code>
								</li><li class="listitem">
									<code class="literal">name_suffix_stein</code>
								</li><li class="listitem">
									<code class="literal">namespace_stein</code>
								</li><li class="listitem">
									<code class="literal">tag_stein</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade finalization command:
						</p><pre class="screen">$ openstack overcloud upgrade converge \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the stack synchronization completes.
						</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You do not need the <code class="literal">upgrades-environment.yaml</code> file for any further deployment operations.
					</p></div></div></section></section><section class="chapter" id="upgrading-a-split-controller-overcloud"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Upgrading a split Controller overcloud</h2></div></div></div><p>
				This scenario contains an example upgrade process for an overcloud with Controller node services split on to multiple nodes. This includes the following node types:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Multiple split high availability services using Pacemaker
					</li><li class="listitem">
						Multiple split Controller services
					</li><li class="listitem">
						Three Ceph MON nodes
					</li><li class="listitem">
						Three Ceph Storage nodes
					</li><li class="listitem">
						Multiple Compute nodes
					</li></ul></div><section class="section" id="running-the-overcloud-upgrade-preparation-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.1. Running the overcloud upgrade preparation</h2></div></div></div><p>
					The upgrade requires running <code class="literal">openstack overcloud upgrade prepare</code> command, which performs the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Updates the overcloud plan to OpenStack Platform 16.1
						</li><li class="listitem">
							Prepares the nodes for the upgrade
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the upgrade preparation command:
						</p><pre class="screen">$ openstack overcloud upgrade prepare \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the upgrade preparation completes.
						</li><li class="listitem"><p class="simpara">
							Download the container images:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags container_image_prepare</pre></li></ol></div></section><section class="section" id="upgrading-pacemaker-based-nodes-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.2. Upgrading Pacemaker-based nodes</h2></div></div></div><p>
					Upgrade all nodes that host Pacemaker services to OpenStack Platform 16.1. The following roles include Pacemaker-based services:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Controller
						</li><li class="listitem">
							Database (MySQL, Galera)
						</li><li class="listitem">
							Messaging (RabbitMQ)
						</li><li class="listitem">
							Load Balancing (HAProxy)
						</li><li class="listitem"><p class="simpara">
							Any other role that contains the following services:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
									<code class="literal">OS::TripleO::Services::Pacemaker</code>
								</li><li class="listitem">
									<code class="literal">OS::TripleO::Services::PacemakerRemote</code>
								</li></ul></div></li></ul></div><p>
					This process involves upgrading each node starting with the bootstrap node.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Identify the bootstrap node by running the following command on a Controller-based node:
						</p><pre class="screen">$ ssh heat-admin@<span class="emphasis"><em>CONTROLLER_IP</em></span> "sudo hiera -c /etc/puppet/hiera.yaml pacemaker_short_bootstrap_node_name"</pre></li><li class="listitem"><p class="simpara">
							Upgrade the bootstrap node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If the node any contains Ceph Storage containers, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">system_upgrade_transfer_data</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade_transfer_data</pre><p class="simpara">
									This command copies the latest version of the database from an existing node to the bootstrap node.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">nova_hybrid_state</code> tag and run only the <code class="literal">upgrade_steps_playbook.yaml</code> playbook:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --playbook upgrade_steps_playbook.yaml --tags nova_hybrid_state --limit all</pre><p class="simpara">
									This command launches temporary 16.1 containers on Compute nodes to help facilitate workload migration when you upgrade Compute nodes at a later step.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Upgrade each Pacemaker-based node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If the node any contains Ceph Storage containers, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-database-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag on the next node:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-database-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0,overcloud-database-0</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade. In addition to this node, include any previously upgraded node in the <code class="literal">--limit</code> option.
								</p></li></ol></div></li><li class="listitem">
							Repeat the upgrade process on each Pacemaker-based node until you have upgraded all Pacemaker-based node.
						</li></ol></div></section><section class="section" id="upgrading-standalone-service-nodes-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.3. Upgrading non-Pacemaker Controller nodes</h2></div></div></div><p>
					Upgrade all nodes without Pacemaker-based services to OpenStack Platform 16.1. These nodes usually contain a specific OpenStack service. Examples of roles without Pacemaker-based services include the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Networker
						</li><li class="listitem">
							Ironic Conductor
						</li><li class="listitem">
							Object Storage
						</li><li class="listitem">
							Any custom roles with services split or scaled from standard Controller nodes
						</li></ul></div><p>
					Do not include the following nodes in this grouping:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Any Compute nodes
						</li><li class="listitem">
							Any Ceph Storage nodes
						</li></ul></div><p>
					This process involves upgrading each node.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-networker-0</pre><p class="simpara">
							This command performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Performs a Leapp upgrade of the operating system.
								</li><li class="listitem">
									Performs a reboot as a part of the Leapp upgrade.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade command with no tags:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-networker-0</pre><p class="simpara">
							This command performs the Red Hat OpenStack Platform upgrade.
						</p></li><li class="listitem">
							Repeat the upgrade process on each node until you have upgraded all Controller-based node.
						</li></ol></div></section><section class="section" id="upgrading-the-operating-system-for-ceph-mon-nodes-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.4. Upgrading the operating system for Ceph MON nodes</h2></div></div></div><p>
					Upgrade the operating system for each Ceph MON node. It is recommended to upgrade each Ceph MON node individually to maintain a quorum among the nodes.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Select a Ceph MON node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephmon-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephmon-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephmon-0</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph MON node. This step does not upgrade the Ceph MON nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the next Ceph MON node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephmon-1</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephmon-1</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephmon-1</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph MON node. This step does not upgrade the Ceph MON nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the final Ceph MON node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephmon-2</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephmon-2</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephmon-2</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph MON node. This step does not upgrade the Ceph MON nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li></ol></div></section><section class="section" id="upgrading-the-operating-system-for-ceph-storage-nodes-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.5. Upgrading the operating system for Ceph Storage nodes</h2></div></div></div><p>
					Upgrade the operating system for each Ceph Storage nodes.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Log in to a node with Ceph MON services:
						</li><li class="listitem"><p class="simpara">
							Disable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo podman ps | grep ceph-mon
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set noout
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container running Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li><li class="listitem"><p class="simpara">
							Select a Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-0</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the next Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-1</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-1</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-1</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Select the final Ceph Storage node and upgrade the operating system:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-cephstorage-2</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-cephstorage-2</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-cephstorage-2</pre><p class="simpara">
									This command runs the <code class="literal">config-download</code> playbooks and configures the composable services on the Ceph Storage node. This step does not upgrade the Ceph Storage nodes to Red Hat Ceph Storage 4. The Red Hat Ceph Storage 4 upgrade occurs in a later procedure.
								</p></li></ol></div></li><li class="listitem">
							After you upgrade all HCI nodes, log into a node that hosts Ceph MON services.
						</li><li class="listitem"><p class="simpara">
							Enable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo podman ps | grep ceph-mon
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset noout
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container running Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li></ol></div></section><section class="section" id="upgrading-compute-nodes-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.6. Upgrading Compute nodes</h2></div></div></div><p>
					Upgrade all the Compute nodes to OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Migrate your instances. For more information on migration strategies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/instances_and_images_guide/migrating-virtual-machines-between-compute-nodes">"Migrating virtual machines between Compute nodes"</a>
						</li><li class="listitem"><p class="simpara">
							Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-compute-0</pre><p class="simpara">
							This command performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Performs a Leapp upgrade of the operating system.
								</li><li class="listitem">
									Performs a reboot as a part of the Leapp upgrade.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade command with no tags:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-compute-0</pre><p class="simpara">
							This command performs the Red Hat OpenStack Platform upgrade.
						</p></li><li class="listitem"><p class="simpara">
							To upgrade multiple Compute nodes in parallel, set the <code class="literal">--limit</code> option to a comma-separated list of nodes that you want to upgrade. First perform the <code class="literal">system_upgrade</code> task:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-compute-0,overcloud-compute-1,overcloud-compute-2</pre><p class="simpara">
							Then perform the standard OpenStack service upgrade:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span>  --limit overcloud-compute-0,overcloud-compute-1,overcloud-compute-2</pre></li></ol></div></section><section class="section" id="performing_the_upgrade-upgrading-overcloud-split"><div class="titlepage"><div><div><h2 class="title">18.7. Synchronizing the overcloud stack</h2></div></div></div><p>
					The upgrade requires an update the overcloud stack to ensure that the stack resource structure and parameters align with a fresh deployment of OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">containers-prepare-parameter.yaml</code> file and remove the following parameters and their values:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">ceph3_namespace</code>
								</li><li class="listitem">
									<code class="literal">ceph3_tag</code>
								</li><li class="listitem">
									<code class="literal">ceph3_image</code>
								</li><li class="listitem">
									<code class="literal">name_prefix_stein</code>
								</li><li class="listitem">
									<code class="literal">name_suffix_stein</code>
								</li><li class="listitem">
									<code class="literal">namespace_stein</code>
								</li><li class="listitem">
									<code class="literal">tag_stein</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade finalization command:
						</p><pre class="screen">$ openstack overcloud upgrade converge \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the stack synchronization completes.
						</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You do not need the <code class="literal">upgrades-environment.yaml</code> file for any further deployment operations.
					</p></div></div></section></section><section class="chapter" id="upgrading-an-overcloud-with-hyper-converged-infrastructure"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Upgrading an overcloud with hyper-converged infrastructure</h2></div></div></div><p>
				This scenario contains an example upgrade process for an overcloud with hyper-converged infrastructure (HCI), which includes the following node types:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Three Controller nodes
					</li><li class="listitem">
						Multiple HCI Compute nodes, which contain combined Compute and Ceph OSD services
					</li></ul></div><section class="section" id="running-the-overcloud-upgrade-preparation-upgrading-overcloud-hci"><div class="titlepage"><div><div><h2 class="title">19.1. Running the overcloud upgrade preparation</h2></div></div></div><p>
					The upgrade requires running <code class="literal">openstack overcloud upgrade prepare</code> command, which performs the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Updates the overcloud plan to OpenStack Platform 16.1
						</li><li class="listitem">
							Prepares the nodes for the upgrade
						</li></ul></div><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the upgrade preparation command:
						</p><pre class="screen">$ openstack overcloud upgrade prepare \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the upgrade preparation completes.
						</li><li class="listitem"><p class="simpara">
							Download the container images:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags container_image_prepare</pre></li></ol></div></section><section class="section" id="upgrading-controller-nodes-upgrading-overcloud-hci"><div class="titlepage"><div><div><h2 class="title">19.2. Upgrading Controller nodes</h2></div></div></div><p>
					Upgrade all the Controller nodes to OpenStack Platform 16.1. This process involves upgrading each Controller node starting with the bootstrap Controller node.
				</p><p>
					In this example, the controller nodes are named using the default <code class="literal">overcloud-controller-<span class="emphasis"><em>NODEID</em></span></code> convention. This includes the following three controller nodes:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">overcloud-controller-0</code>
						</li><li class="listitem">
							<code class="literal">overcloud-controller-1</code>
						</li><li class="listitem">
							<code class="literal">overcloud-controller-2</code>
						</li></ul></div><p>
					Substitute these values for your own node names where applicable.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the <code class="literal">overcloud</code> default stack name, set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Identify the bootstrap Controller node by running the following command on a Controller node:
						</p><pre class="screen">$ sudo hiera -c /etc/puppet/hiera.yaml pacemaker_short_bootstrap_node_name</pre><p class="simpara">
							To run this command from the undercloud, run the following SSH command and substitute <code class="literal">CONTROLLER_IP</code> with the IP address of any Controller node in your environment:
						</p><pre class="screen">$ ssh heat-admin@<span class="emphasis"><em>CONTROLLER_IP</em></span> "sudo hiera -c /etc/puppet/hiera.yaml pacemaker_short_bootstrap_node_name"</pre><p class="simpara">
							This example uses <code class="literal">overcloud-controller-0</code> as the value of the bootstrap node. Substitute this value for your own bootstrap node.
						</p></li><li class="listitem"><p class="simpara">
							Upgrade the bootstrap Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-0</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem"><p class="simpara">
											Performs a reboot as a part of the Leapp upgrade.
										</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
												The next command causes an outage on the control plane. You cannot perform any standard operations on the overcloud during the next few steps.
											</p></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
									Run the external upgrade command with the <code class="literal">system_upgrade_transfer_data</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade_transfer_data</pre><p class="simpara">
									This command copies the latest version of the database from an existing node to the bootstrap node.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">nova_hybrid_state</code> tag and run only the <code class="literal">upgrade_steps_playbook.yaml</code> playbook:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --playbook upgrade_steps_playbook.yaml --tags nova_hybrid_state --limit all</pre><p class="simpara">
									This command launches temporary 16.1 containers on Compute nodes to help facilitate workload migration when you upgrade Compute nodes at a later step.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade.
								</p><div class="admonition important"><div class="admonition_header">Important</div><div><p>
										The control plane becomes active when this command finishes. You can perform standard operations on the overcloud again.
									</p></div></div></li></ol></div></li><li class="listitem"><p class="simpara">
							Upgrade the next Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-1</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag on the next Controller node:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-1</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0,overcloud-controller-1</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade. In addition to this node, include the previously upgraded bootstrap node in the <code class="literal">--limit</code> option.
								</p></li></ol></div></li><li class="listitem"><p class="simpara">
							Upgrade the final Controller node:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									If your overcloud includes a director-deployed Ceph Storage cluster, run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
								</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-controller-2</pre><p class="simpara">
									This command performs the following functions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Changes the systemd units that control the Ceph Storage containers to use Podman management.
										</li><li class="listitem">
											Limits actions to the selected Controller node using the <code class="literal">ceph_ansible_limit</code> variable.
										</li></ul></div><p class="simpara">
									This step is a preliminary measure to prepare the Ceph Storage services for The <code class="literal">leapp</code> upgrade.
								</p></li><li class="listitem"><p class="simpara">
									Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-controller-2</pre><p class="simpara">
									This command performs the following actions:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											Performs a Leapp upgrade of the operating system.
										</li><li class="listitem">
											Performs a reboot as a part of the Leapp upgrade.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									Run the upgrade command with no tags:
								</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-controller-0,overcloud-controller-1,overcloud-controller-2</pre><p class="simpara">
									This command performs the Red Hat OpenStack Platform upgrade. Include all Controller nodes in the <code class="literal">--limit</code> option.
								</p></li></ol></div></li></ol></div></section><section class="section" id="upgrading-compute-nodes-with-hyper-converged-infrastructure-upgrading-overcloud-hci"><div class="titlepage"><div><div><h2 class="title">19.3. Upgrading Compute nodes with hyper-converged infrastructure (HCI)</h2></div></div></div><p>
					Upgrade HCI Compute nodes to OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem">
							Migrate your instances. For more information on migration strategies, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/instances_and_images_guide/migrating-virtual-machines-between-compute-nodes">"Migrating virtual machines between Compute nodes"</a>
						</li><li class="listitem">
							Log in to a node with Ceph MON services:
						</li><li class="listitem"><p class="simpara">
							Disable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo docker ps | grep ceph-mon
$ sudo docker exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set noout
$ sudo docker exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd set norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container that runs Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li><li class="listitem"><p class="simpara">
							Run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-computehci-0</pre><p class="simpara">
							This command performs the following functions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Changes the systemd units that control the Ceph Storage containers to use Podman management.
								</li><li class="listitem">
									Limits actions to the selected Ceph Storage node using the <code class="literal">ceph_ansible_limit</code> variable.
								</li></ul></div><p class="simpara">
							This step is a preliminary measure to prepare the Ceph Storage services for the <code class="literal">leapp</code> upgrade.
						</p></li><li class="listitem"><p class="simpara">
							Run the upgrade command with the <code class="literal">system_upgrade</code> tag:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-computehci-0</pre><p class="simpara">
							This command performs the following actions:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Performs a Leapp upgrade of the operating system.
								</li><li class="listitem">
									Performs a reboot as a part of the Leapp upgrade.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade command with no tags:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --limit overcloud-computehci-0</pre><p class="simpara">
							This command performs the Red Hat OpenStack Platform upgrade.
						</p></li><li class="listitem"><p class="simpara">
							To upgrade multiple Compute nodes in parallel, set the <code class="literal">--limit</code> option to a comma-separated list of nodes that you want to upgrade. First run the external upgrade command with the <code class="literal">ceph_systemd</code> tag:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph_systemd -e ceph_ansible_limit=overcloud-computehci-0</pre><p class="simpara">
							Then perform the <code class="literal">system_upgrade</code> task:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags system_upgrade --limit overcloud-computehci-0,overcloud-computehci-1,overcloud-computehci-2</pre><p class="simpara">
							Then perform the standard OpenStack service upgrade:
						</p><pre class="screen">$ openstack overcloud upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span>  --limit overcloud-compute-0,overcloud-computehci-1,overcloud-computehci-2</pre></li><li class="listitem">
							After you have upgraded all HCI nodes, log in to a node with Ceph MON services.
						</li><li class="listitem"><p class="simpara">
							Enable OSD exclusion and rebalancing:
						</p><pre class="screen">$ sudo podman ps | grep ceph-mon
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset noout
$ sudo podman exec -it <span class="emphasis"><em>CONTAINER</em></span> ceph osd unset norebalance</pre><p class="simpara">
							Replace <span class="emphasis"><em>CONTAINER</em></span> with the name of the container that runs Ceph MON.
						</p></li><li class="listitem">
							Log out of the node with Ceph MON services and return to the undercloud.
						</li></ol></div></section><section class="section" id="performing_the_upgrade-upgrading-overcloud-hci"><div class="titlepage"><div><div><h2 class="title">19.4. Synchronizing the overcloud stack</h2></div></div></div><p>
					The upgrade requires an update the overcloud stack to ensure that the stack resource structure and parameters align with a fresh deployment of OpenStack Platform 16.1.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Edit the <code class="literal">containers-prepare-parameter.yaml</code> file and remove the following parameters and their values:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">ceph3_namespace</code>
								</li><li class="listitem">
									<code class="literal">ceph3_tag</code>
								</li><li class="listitem">
									<code class="literal">ceph3_image</code>
								</li><li class="listitem">
									<code class="literal">name_prefix_stein</code>
								</li><li class="listitem">
									<code class="literal">name_suffix_stein</code>
								</li><li class="listitem">
									<code class="literal">namespace_stein</code>
								</li><li class="listitem">
									<code class="literal">tag_stein</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Run the upgrade finalization command:
						</p><pre class="screen">$ openstack overcloud upgrade converge \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    -e /home/stack/templates/upgrades-environment.yaml \
    -e /home/stack/templates/rhsm.yaml \
    -e /home/stack/containers-prepare-parameter.yaml \
    -e /usr/share/openstack-tripleo-heat-templates/environments/services/neutron-ovs.yaml \
    …​</pre><p class="simpara">
							Include the following options relevant to your environment:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The environment file (<code class="literal">upgrades-environment.yaml</code>) with the upgrade-specific parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">rhsm.yaml</code>) with the registration and subscription parameters (<code class="literal">-e</code>).
								</li><li class="listitem">
									The environment file (<code class="literal">containers-prepare-parameter.yaml</code>) with your new container image locations (<code class="literal">-e</code>). In most cases, this is the same environment file that the undercloud uses.
								</li><li class="listitem">
									The environment file (<code class="literal">neutron-ovs.yaml</code>) to maintain OVS compatibility.
								</li><li class="listitem">
									Any custom configuration environment files (<code class="literal">-e</code>) relevant to your deployment.
								</li><li class="listitem">
									If applicable, your custom roles (<code class="literal">roles_data</code>) file using <code class="literal">--roles-file</code>.
								</li><li class="listitem">
									If applicable, your composable network (<code class="literal">network_data</code>) file using <code class="literal">--networks-file</code>.
								</li><li class="listitem">
									If you use a custom stack name, pass the name with the <code class="literal">--stack</code> option.
								</li></ul></div></li><li class="listitem">
							Wait until the stack synchronization completes.
						</li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						You do not need the <code class="literal">upgrades-environment.yaml</code> file for any further deployment operations.
					</p></div></div></section></section></div><div class="part" id="concluding_the_overcloud_upgrade"><div class="titlepage"><div><div><h1 class="title">Part IV. Concluding the overcloud upgrade</h1></div></div></div><section class="chapter" id="upgrading-to-red-hat-ceph-storage-4"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Upgrading to Red Hat Ceph Storage 4</h2></div></div></div><p>
				After you upgrade the overcloud, upgrade your Red Hat Ceph Storage cluster to version 4.
			</p><section class="section" id="installing-ceph-ansible"><div class="titlepage"><div><div><h2 class="title">20.1. Installing ceph-ansible</h2></div></div></div><p>
					The <code class="literal">ceph-ansible</code> package is required when you use Ceph Storage with Red Hat OpenStack Platform.
				</p><p>
					If you use Red Hat Ceph Storage, or if your deployment uses an external Ceph Storage cluster, install the <code class="literal">ceph-ansible</code> package. For more information about integrating with an existing Ceph Storage cluster, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/integrating_an_overcloud_with_an_existing_red_hat_ceph_cluster/index">Integrating an Overcloud with an Existing Red Hat Ceph Cluster</a>.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Enable the Ceph Tools repository:
						</p><pre class="screen">[stack@director ~]$ sudo subscription-manager repos --enable=rhceph-4-tools-for-rhel-8-x86_64-rpms</pre></li><li class="listitem"><p class="simpara">
							Install the <code class="literal">ceph-ansible</code> package:
						</p><pre class="screen">[stack@director ~]$ sudo dnf install -y ceph-ansible</pre></li></ol></div></section><section class="section" id="upgrading-to-ceph-storage-4-ceph-4"><div class="titlepage"><div><div><h2 class="title">20.2. Upgrading to Ceph Storage 4</h2></div></div></div><p>
					Upgrade the Ceph Storage nodes from version 3 to version 4.
				</p><div class="admonition note"><div class="admonition_header">Note</div><div><p>
						If you are not using the default stack name (<code class="literal">overcloud</code>), set your stack name with the <code class="literal">--stack <span class="emphasis"><em>STACK NAME</em></span></code> option replacing <code class="literal"><span class="emphasis"><em>STACK NAME</em></span></code> with the name of your stack.
					</p></div></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file:
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the Ceph Storage external upgrade process with the <code class="literal">ceph</code> tag:
						</p><pre class="screen">$ openstack overcloud external-upgrade run --stack <span class="emphasis"><em>STACK NAME</em></span> --tags ceph</pre></li><li class="listitem">
							Wait until the Ceph Storage upgrade completes.
						</li></ol></div></section></section><section class="chapter" id="performing-post-upgrade-actions"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Performing post-upgrade actions</h2></div></div></div><p>
				After you have completed the overcloud upgrade, you must perform some post-upgrade configuration to ensure that your environment is fully supported and ready for future operations.
			</p><section class="section" id="removing-unnecessary-packages-from-the-undercloud-ceph-4"><div class="titlepage"><div><div><h2 class="title">21.1. Removing unnecessary packages from the undercloud</h2></div></div></div><p>
					After the Leapp upgrade, some unnecessary packages remain on the undercloud. Remove these packages.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Remove the unnecessary packages
						</p><pre class="screen">$ sudo dnf -y remove python2*</pre></li></ol></div></section><section class="section" id="validating-the-post-upgrade-functionality"><div class="titlepage"><div><div><h2 class="title">21.2. Validating the post-upgrade functionality</h2></div></div></div><p>
					Run the <span class="literal literal">post-upgrade</span> validation group to check the post-upgrade functionality.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Run the <code class="literal">openstack tripleo validator run</code> command with the <span class="literal literal">--group post-upgrade</span> option:
						</p><pre class="screen">$ openstack tripleo validator run --group post-upgrade</pre></li><li class="listitem"><p class="simpara">
							Review the results of the validation report. To view detailed output from a specific validation, run the <code class="literal">openstack tripleo validator show run</code> command against the UUID of the specific validation from the report:
						</p><pre class="screen">$ openstack tripleo validator show run &lt;UUID&gt;</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						A <code class="literal">FAILED</code> validation does not prevent you from deploying or running Red Hat OpenStack Platform. However, a <code class="literal">FAILED</code> validation can indicate a potential issue with a production environment.
					</p></div></div></section><section class="section" id="upgrading_the_overcloud_images"><div class="titlepage"><div><div><h2 class="title">21.3. Upgrading the overcloud images</h2></div></div></div><p>
					You must replace your current overcloud images with new versions. The new images ensure that the director can introspect and provision your nodes using the latest version of OpenStack Platform software.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have upgraded the undercloud to the latest version.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Log in to the undercloud as the <code class="literal">stack</code> user.
						</li><li class="listitem"><p class="simpara">
							Source the <code class="literal">stackrc</code> file.
						</p><pre class="screen">$ source ~/stackrc</pre></li><li class="listitem"><p class="simpara">
							Install the packages containing the overcloud QCOW2 archives:
						</p><pre class="screen">$ sudo dnf install rhosp-director-images rhosp-director-images-ipa</pre></li><li class="listitem"><p class="simpara">
							Remove any existing images from the <code class="literal">images</code> directory on the <code class="literal">stack</code> user’s home (<code class="literal">/home/stack/images</code>):
						</p><pre class="screen">$ rm -rf ~/images/*</pre></li><li class="listitem"><p class="simpara">
							Extract the archives:
						</p><pre class="screen">$ cd ~/images
$ for i in /usr/share/rhosp-director-images/overcloud-full-latest-16.1.tar /usr/share/rhosp-director-images/ironic-python-agent-latest-16.1.tar; do tar -xvf $i; done
$ cd ~</pre></li><li class="listitem"><p class="simpara">
							Import the latest images into the director:
						</p><pre class="screen">$ openstack overcloud image upload --update-existing --image-path /home/stack/images/</pre></li><li class="listitem"><p class="simpara">
							Configure your nodes to use the new images:
						</p><pre class="screen">$ openstack overcloud node configure $(openstack baremetal node list -c UUID -f value)</pre></li></ol></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						When you deploy overcloud nodes, ensure that the overcloud image version corresponds to the respective heat template version. For example, use the OpenStack Platform 16.1 images only with the OpenStack Platform 16.1 heat templates.
					</p></div></div><div class="admonition important"><div class="admonition_header">Important</div><div><p>
						The new <code class="literal">overcloud-full</code> image replaces the old <code class="literal">overcloud-full</code> image. If you made changes to the old image, you must repeat the changes in the new image, especially if you want to deploy new nodes in the future.
					</p></div></div></section><section class="section" id="migrating-to-open-virtual-network-ovn"><div class="titlepage"><div><div><h2 class="title">21.4. Migrating to Open Virtual Network (OVN)</h2></div></div></div><p>
					Open Virtual Network (OVN) is an Open vSwitch-based software-defined networking (SDN) solution for supplying network services to instances. OVN provides platform-neutral support for the full OpenStack Networking API. You can use OVN to connect groups of guest instances programatically into private L2 and L3 networks. OVN uses a standard approach to virtual networking that can extend to other Red Hat platforms and solutions.
				</p><p>
					After you upgrade to Red Hat Enterprise Linux 16.1, migrate the OpenStack Networking (neutron) service on your overcloud from the ML2/OVS driver to the ML2/OVN driver. For more information on migrating to ML2/OVN, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/16.1/html/networking_with_open_virtual_network/migrating-ml2ovs-to-ovn">"Migrating from ML2/OVS to ML2/OVN"</a>.
				</p></section></section></div><div class="part" id="troubleshooting"><div class="titlepage"><div><div><h1 class="title">Part V. Troubleshooting</h1></div></div></div><section class="chapter" id="troubleshooting-upgrade-issues"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Troubleshooting upgrade issues</h2></div></div></div><p>
				If you experience any issues with during the upgrade process, refer to the advice in this section.
			</p><section class="section" id="correcting-environment-files-ceph-4"><div class="titlepage"><div><div><h2 class="title">22.1. Correcting environment files</h2></div></div></div><p>
					If you have made a mistake with any parameters in any custom environment files, you can correct the environment file and run the <code class="literal">openstack overcloud upgrade prepare</code> command at any time during the upgrade. This command uploads a new version of your overcloud plan to director, which will generate a new set of <code class="literal">config-download</code> playbooks.
				</p><p>
					This example contains a repository name mistake in the <code class="literal">upgrades-environment.yaml</code> file:
				</p><pre class="screen">parameter_defaults:
  UpgradeLeappEnabled: true
  UpgradeLeappCommandOptions: "--enablerepo <span class="strong strong"><strong>rhel-7-for-x86_64-baseos-eus-rpms</strong></span> --enablerepo rhel-8-for-x86_64-appstream-eus-rpms --enablerepo fast-datapath-for-rhel-8-x86_64-rpms"
  CephAnsibleRepo: rhceph-4-tools-for-rhel-8-x86_64-rpms</pre><p>
					This mistake causes an issue during the Leapp upgrade for the Controller node. To rectify this issue, correct the mistake and run the <code class="literal">openstack overcloud upgrade prepare</code> command.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Correct the mistake in the file:
						</p><pre class="screen">parameter_defaults:
  UpgradeLeappEnabled: true
  UpgradeLeappCommandOptions: "--enablerepo rhel-8-for-x86_64-baseos-eus-rpms --enablerepo rhel-8-for-x86_64-appstream-eus-rpms --enablerepo fast-datapath-for-rhel-8-x86_64-rpms"
  CephAnsibleRepo: rhceph-4-tools-for-rhel-8-x86_64-rpms</pre></li><li class="listitem"><p class="simpara">
							Run the upgrade preparation command with the corrected file:
						</p><pre class="screen">$ openstack overcloud upgrade prepare \
    --stack <span class="emphasis"><em>STACK NAME</em></span> \
    --templates \
    -e <span class="emphasis"><em>ENVIRONMENT FILE</em></span>
    …​
    <span class="strong strong"><strong>-e /home/stack/templates/upgrades-environment.yaml</strong></span> \
    …​</pre><p class="simpara">
							Wait until the overcloud stack update completes.
						</p></li><li class="listitem">
							Continue with the upgrade operation step that failed.
						</li></ol></div></section></section></div><div><!--Empty--></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">

    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto" href="index.html#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="footer-top">
            <div class="container">

              <div class="brand">
                <a href="https://redhat.com">
                  <svg class="rh-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145">
                    <defs>
                      <style>
                        .rh-logo-hat {
                          fill: #e00;
                        }
                        .rh-logo-type {
                          fill: #fff;
                        }
                      </style>
                    </defs>
                    <title>Red Hat</title>
                    <path
                      class="rh-logo-hat"
                      d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/>
                      <path class="rh-logo-band"
                      d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/>
                      <path
                      class="rh-logo-type"
                      d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/>
                  </svg>
                </a>
              </div>

            <div role="navigation">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://www.redhat.com/en/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">redhat.com</a></li>
                    <li><a href="https://www.openshift.com" class="openshift-com">openshift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">developers.redhat.com</a></li>
                    <li><a href="https://connect.redhat.com/" class="partner-connect">connect.redhat.com</a></li>
                </ul>
            </div>

            <div role="navigation">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="status-legal">
                    <a hidden href="https://status.redhat.com" class="status-page-widget">
                          <span class="status-description"></span>
                          <span class="status-dot shape-circle"></span>
                    </a>
                    <div class="legal-copyright">
                        <div class="copyright">Copyright © 2020 Red Hat, Inc.</div>

                        <div role="navigation" class="legal">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Statement</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                                <li><a id="teconsent"></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="social">
                    <a href="http://www.redhat.com/summit/" class="summit">
                      <img src="rh-summit-red-a.svg" alt="Red Hat Summit" />
                    </a>

                    <div class="social-media">
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- TrustArc -->
    <div id="consent_blackbar"></div> 
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div></body>
</html>
